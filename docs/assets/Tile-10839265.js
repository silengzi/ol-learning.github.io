import{U as G,aq as I,ar as d,o as T,as as R,N as b,T as C,R as L,at as x,au as _,f as S,X as U,L as w,K,av as k,G as g,C as z}from"./TileLayer-114b24fd.js";class D extends G{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:X,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:I,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const r=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==r?t:{});for(const l in this.tileCacheForProjection){const n=this.tileCacheForProjection[l];n.expireCache(n==r?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!d(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!d(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||d(t,e)))return this.tileGrid;const r=T(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=R(e)),this.tileGridForProjection[r]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||d(t,e))return this.tileCache;const r=T(e);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new b(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]}createTile_(e,t,r,l,n,i){const a=[e,t,r],c=this.getTileCoordForTileUrlFunction(a,n),s=c?this.tileUrlFunction(c,l,n):void 0,o=new this.tileClass(a,s!==void 0?C.IDLE:C.EMPTY,s!==void 0?s:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return o.key=i,o.addEventListener(L.CHANGE,this.handleTileChange.bind(this)),o}getTile(e,t,r,l,n){const i=this.getProjection();if(!i||!n||d(i,n))return this.getTileInternal(e,t,r,l,i||n);const a=this.getTileCacheForProjection(n),c=[e,t,r];let s;const o=x(c);a.containsKey(o)&&(s=a.get(o));const f=this.getKey();if(s&&s.key==f)return s;const P=this.getTileGridForProjection(i),j=this.getTileGridForProjection(n),F=this.getTileCoordForTileUrlFunction(c,n),u=new _(i,P,n,j,c,F,this.getTilePixelRatio(l),this.getGutter(),(m,E,O,y)=>this.getTileInternal(m,E,O,y,i),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return u.key=f,s?(u.interimTile=s,u.refreshInterimChain(),a.replace(o,u)):a.set(o,u),u}getTileInternal(e,t,r,l,n){let i=null;const a=U(e,t,r),c=this.getKey();if(!this.tileCache.containsKey(a))i=this.createTile_(e,t,r,l,n,c),this.tileCache.set(a,i);else if(i=this.tileCache.get(a),i.key!=c){const s=i;i=this.createTile_(e,t,r,l,n,c),s.getState()==C.IDLE?i.interimTile=s.interimTile:i.interimTile=s,i.refreshInterimChain(),this.tileCache.replace(a,i)}return i}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const r=S(e);if(r){const l=T(r);l in this.tileGridForProjection||(this.tileGridForProjection[l]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function X(h,e){h.getImage().src=e}const q=D;class Z extends q{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:w({extent:K(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const M=Z,N='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class v extends M{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[N];const r=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",l=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:r,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,opaque:e.opaque!==void 0?e.opaque:!0,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:l,wrapX:e.wrapX,zDirection:e.zDirection})}}const p=v;class Y extends k{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getPreload(){return this.get(g.PRELOAD)}setPreload(e){this.set(g.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(g.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(g.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}const $=Y;class A extends ${constructor(e){super(e)}createRenderer(){return new z(this)}}const H=A;export{p as O,H as T};
