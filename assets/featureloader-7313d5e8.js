import{b4 as $e,aj as Gi,b5 as V,a1 as Ft,W as we,b6 as zi,b7 as Vi,aA as ge,m as ye,aQ as Ui,a0 as Ee,af as te,a4 as $i,a8 as qi,b8 as Hi,b9 as Ji,ba as Jt,bb as qe,bc as He,bd as ji,be as tt,bf as li,bg as hi,bh as gt,bi as _t,bj as ci,bk as ui,bl as fi,aP as di,bm as Ki,a_ as gi,bn as Zi,bo as et,j as Me,bp as ft,bq as Ie,br as be,bs as Qi,bt as tn,bu as en,aO as ke,bv as nn,ac as _i,a7 as Tt,aD as Je,bw as sn,aX as pi,bx as rn,by as je,a5 as mi,at as on,i as an,O as Ke,bz as ln}from"./Layer-763025a3.js";import{I as hn,F as xi,a as Qt,S as cn,R as un,C as fn,t as dn,b as gn,V as _n,d as ee,e as pn}from"./vector-31d95deb.js";function mn(r,t,e,i){let s=r[t],n=r[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=r[a],h=r[a+1];o+=Math.sqrt((l-s)*(l-s)+(h-n)*(h-n)),s=l,n=h}return o}function xn(r,t,e,i,s){Si(r,t,e||0,i||r.length-1,s||Sn)}function Si(r,t,e,i,s){for(;i>e;){if(i-e>600){var n=i-e+1,o=t-e+1,a=Math.log(n),l=.5*Math.exp(2*a/3),h=.5*Math.sqrt(a*l*(n-l)/n)*(o-n/2<0?-1:1),c=Math.max(e,Math.floor(t-o*l/n+h)),f=Math.min(i,Math.floor(t+(n-o)*l/n+h));Si(r,t,c,f,s)}var u=r[t],d=e,g=i;for(Lt(r,e,t),s(r[i],u)>0&&Lt(r,e,i);d<g;){for(Lt(r,d,g),d++,g--;s(r[d],u)<0;)d++;for(;s(r[g],u)>0;)g--}s(r[e],u)===0?Lt(r,e,g):(g++,Lt(r,g,i)),g<=t&&(e=g+1),t<=g&&(i=g-1)}}function Lt(r,t,e){var i=r[t];r[t]=r[e],r[e]=i}function Sn(r,t){return r<t?-1:r>t?1:0}let wn=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!Kt(t,e))return i;const s=this.toBBox,n=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?s(a):a;Kt(t,l)&&(e.leaf?i.push(a):pe(t,l)?this._all(a,i):n.push(a))}e=n.pop()}return i}collides(t){let e=this.data;if(!Kt(t,e))return!1;const i=[];for(;e;){for(let s=0;s<e.children.length;s++){const n=e.children[s],o=e.leaf?this.toBBox(n):n;if(Kt(t,o)){if(e.leaf||pe(t,o))return!0;i.push(n)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=yt([]),this}remove(t,e){if(!t)return this;let i=this.data;const s=this.toBBox(t),n=[],o=[];let a,l,h;for(;i||n.length;){if(i||(i=n.pop(),l=n[n.length-1],a=o.pop(),h=!0),i.leaf){const c=yn(t,i.children,e);if(c!==-1)return i.children.splice(c,1),n.push(i),this._condense(n),this}!h&&!i.leaf&&pe(i,s)?(n.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],h=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,s){const n=i-e+1;let o=this._maxEntries,a;if(n<=o)return a=yt(t.slice(e,i+1)),St(a,this.toBBox),a;s||(s=Math.ceil(Math.log(n)/Math.log(o)),o=Math.ceil(n/Math.pow(o,s-1))),a=yt([]),a.leaf=!1,a.height=s;const l=Math.ceil(n/o),h=l*Math.ceil(Math.sqrt(o));Ze(t,e,i,h,this.compareMinX);for(let c=e;c<=i;c+=h){const f=Math.min(c+h-1,i);Ze(t,c,f,l,this.compareMinY);for(let u=c;u<=f;u+=l){const d=Math.min(u+l-1,f);a.children.push(this._build(t,u,d,s-1))}}return St(a,this.toBBox),a}_chooseSubtree(t,e,i,s){for(;s.push(e),!(e.leaf||s.length-1===i);){let n=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const h=e.children[l],c=_e(h),f=bn(t,h)-c;f<o?(o=f,n=c<n?c:n,a=h):f===o&&c<n&&(n=c,a=h)}e=a||e.children[0]}return e}_insert(t,e,i){const s=i?t:this.toBBox(t),n=[],o=this._chooseSubtree(s,this.data,e,n);for(o.children.push(t),Dt(o,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)}_split(t,e){const i=t[e],s=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);const o=this._chooseSplitIndex(i,n,s),a=yt(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,St(i,this.toBBox),St(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=yt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,St(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let s,n=1/0,o=1/0;for(let a=e;a<=i-e;a++){const l=Rt(t,0,a,this.toBBox),h=Rt(t,a,i,this.toBBox),c=kn(l,h),f=_e(l)+_e(h);c<n?(n=c,s=a,o=f<o?f:o):c===n&&f<o&&(o=f,s=a)}return s||i-e}_chooseSplitAxis(t,e,i){const s=t.leaf?this.compareMinX:En,n=t.leaf?this.compareMinY:In,o=this._allDistMargin(t,e,i,s),a=this._allDistMargin(t,e,i,n);o<a&&t.children.sort(s)}_allDistMargin(t,e,i,s){t.children.sort(s);const n=this.toBBox,o=Rt(t,0,e,n),a=Rt(t,i-e,i,n);let l=jt(o)+jt(a);for(let h=e;h<i-e;h++){const c=t.children[h];Dt(o,t.leaf?n(c):c),l+=jt(o)}for(let h=i-e-1;h>=e;h--){const c=t.children[h];Dt(a,t.leaf?n(c):c),l+=jt(a)}return l}_adjustParentBBoxes(t,e,i){for(let s=i;s>=0;s--)Dt(e[s],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():St(t[e],this.toBBox)}};function yn(r,t,e){if(!e)return t.indexOf(r);for(let i=0;i<t.length;i++)if(e(r,t[i]))return i;return-1}function St(r,t){Rt(r,0,r.children.length,t,r)}function Rt(r,t,e,i,s){s||(s=yt(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let n=t;n<e;n++){const o=r.children[n];Dt(s,r.leaf?i(o):o)}return s}function Dt(r,t){return r.minX=Math.min(r.minX,t.minX),r.minY=Math.min(r.minY,t.minY),r.maxX=Math.max(r.maxX,t.maxX),r.maxY=Math.max(r.maxY,t.maxY),r}function En(r,t){return r.minX-t.minX}function In(r,t){return r.minY-t.minY}function _e(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function jt(r){return r.maxX-r.minX+(r.maxY-r.minY)}function bn(r,t){return(Math.max(t.maxX,r.maxX)-Math.min(t.minX,r.minX))*(Math.max(t.maxY,r.maxY)-Math.min(t.minY,r.minY))}function kn(r,t){const e=Math.max(r.minX,t.minX),i=Math.max(r.minY,t.minY),s=Math.min(r.maxX,t.maxX),n=Math.min(r.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,n-i)}function pe(r,t){return r.minX<=t.minX&&r.minY<=t.minY&&t.maxX<=r.maxX&&t.maxY<=r.maxY}function Kt(r,t){return t.minX<=r.maxX&&t.minY<=r.maxY&&t.maxX>=r.minX&&t.maxY>=r.minY}function yt(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ze(r,t,e,i,s){const n=[t,e];for(;n.length;){if(e=n.pop(),t=n.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;xn(r,o,t,e,s),n.push(t,o,o,e)}}let At=null;class Cn extends Gi{constructor(t,e,i,s,n){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=n,this.imageState_=s===void 0?V.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===V.LOADED){At||(At=Ft(1,1,void 0,{willReadFrequently:!0})),At.drawImage(this.image_,0,0);try{At.getImageData(0,0,1,1),this.tainted_=!1}catch{At=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(we.CHANGE)}handleImageError_(){this.imageState_=V.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=V.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Ft(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===V.IDLE){this.image_||this.initializeImage_(),this.imageState_=V.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&zi(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==V.LOADED)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const s=i.getContext("2d");s.scale(t,t),s.drawImage(e,0,0),s.globalCompositeOperation="multiply",s.fillStyle=Vi(this.color_),s.fillRect(0,0,i.width/t,i.height/t),s.globalCompositeOperation="destination-in",s.drawImage(e,0,0),this.canvas_[t]=i}}function Mn(r,t,e,i,s){let n=t===void 0?void 0:$e.get(t,e,s);return n||(n=new Cn(r,r instanceof HTMLImageElement?r.src||void 0:t,e,i,s),$e.set(t,e,s,n)),n}function Qe(r,t,e,i){return e!==void 0&&i!==void 0?[e/r,i/t]:e!==void 0?e/r:i!==void 0?i/t:1}class Oe extends hn{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,n=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:n,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;ge(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||ye(o)),ge(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),ge(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=V.IDLE:o!==void 0&&(o instanceof HTMLImageElement?o.complete?l=o.src?V.LOADED:V.IDLE:l=V.LOADING:l=V.LOADED),this.color_=t.color!==void 0?Ui(t.color):null,this.iconImage_=Mn(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let h,c;if(t.size)[h,c]=t.size;else{const f=this.getImage(1);if(f.width&&f.height)h=f.width,c=f.height;else if(f instanceof HTMLImageElement){this.initialOptions_=t;const u=()=>{if(this.unlistenImageChange(u),!this.initialOptions_)return;const d=this.iconImage_.getSize();this.setScale(Qe(d[0],d[1],t.width,t.height))};this.listenImageChange(u);return}}h!==void 0&&this.setScale(Qe(h,c,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Oe({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==V.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==V.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(we.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(we.CHANGE,t)}}const wi=Oe,On="#333";class ve{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Ee(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new xi({color:On}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}clone(){const t=this.getScale();return new ve({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ee(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const vn=ve;let bt=0;const G=1<<bt++,O=1<<bt++,It=1<<bt++,Te=1<<bt++,Xt=1<<bt++,K=Math.pow(2,bt)-1,yi={[G]:"boolean",[O]:"number",[It]:"string",[Te]:"color",[Xt]:"number[]"},Tn=Object.keys(yi).map(Number).sort(te);function ie(r){const t=[];for(const e of Tn)Ln(r,e)&&t.push(yi[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Ln(r,t){return(r&t)===t}function Ei(r,t){return!!(r&t)}class ht{constructor(t,e){this.type=t,this.value=e}}class An{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Ii(){return{variables:new Set,properties:new Set}}function re(r,t){switch(typeof r){case"boolean":return new ht(G,r);case"number":return new ht(O,r);case"string":return new ht(It,r)}if(!Array.isArray(r))throw new Error("Expression must be an array or a primitive value");if(r.length===0)throw new Error("Empty expression");if(typeof r[0]=="string")return Wn(r,t);for(const i of r)if(typeof i!="number")throw new Error("Expected an array of numbers");let e=Xt;return(r.length===3||r.length===4)&&(e|=Te),new ht(e,r)}const _={Number:"number",String:"string",Get:"get",Var:"var",Any:"any",All:"all",Not:"!",Resolution:"resolution",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match"},Rn={[_.Number]:T(B(1,1/0,K),O),[_.String]:T(B(1,1/0,K),It),[_.Get]:T(Dn,K),[_.Var]:T(Bn,K),[_.Resolution]:T(Fn,O),[_.Any]:T(B(2,1/0,G),G),[_.All]:T(B(2,1/0,G),G),[_.Not]:T(B(1,1,G),G),[_.Equal]:T(B(2,2,K),G),[_.NotEqual]:T(B(2,2,K),G),[_.GreaterThan]:T(B(2,2,K),G),[_.GreaterThanOrEqualTo]:T(B(2,2,K),G),[_.LessThan]:T(B(2,2,K),G),[_.LessThanOrEqualTo]:T(B(2,2,K),G),[_.Multiply]:T(B(2,1/0,O),O),[_.Divide]:T(B(2,2,O),O),[_.Add]:T(B(2,1/0,O),O),[_.Subtract]:T(B(2,2,O),O),[_.Clamp]:T(B(3,3,O),O),[_.Mod]:T(B(2,2,O),O),[_.Pow]:T(B(2,2,O),O),[_.Abs]:T(B(1,1,O),O),[_.Floor]:T(B(1,1,O),O),[_.Ceil]:T(B(1,1,O),O),[_.Round]:T(B(1,1,O),O),[_.Sin]:T(B(1,1,O),O),[_.Cos]:T(B(1,1,O),O),[_.Atan]:T(B(1,2,O),O),[_.Sqrt]:T(B(1,1,O),O),[_.Match]:T(B(4,1/0,It|O),K)};function Dn(r,t){if(r.length!==2)throw new Error("Expected 1 argument for get operation");const e=re(r[1],t);if(!(e instanceof ht))throw new Error("Expected a literal argument for get operation");if(typeof e.value!="string")throw new Error("Expected a string argument for get operation");return t.properties.add(e.value),[e]}function Bn(r,t){if(r.length!==2)throw new Error("Expected 1 argument for var operation");const e=re(r[1],t);if(!(e instanceof ht))throw new Error("Expected a literal argument for var operation");if(typeof e.value!="string")throw new Error("Expected a string argument for get operation");return t.variables.add(e.value),[e]}function Fn(r,t){const e=r[0];if(r.length!==1)throw new Error(`Expected no arguments for ${e} operation`);return[]}function B(r,t,e){return function(i,s){const n=i[0],o=i.length-1;if(r===t){if(o!==r){const l=r===1?"":"s";throw new Error(`Expected ${r} argument${l} for operation ${n}, got ${o}`)}}else if(o<r||o>t)throw new Error(`Expected ${r} to ${t} arguments for operation ${n}, got ${o}`);const a=new Array(o);for(let l=0;l<o;++l){const h=re(i[l+1],s);if(!Ei(e,h.type)){const c=ie(e),f=ie(h.type);throw new Error(`Unexpected type for argument ${l} of ${n} operation : got ${c} but expected ${f}`)}a[l]=h}return a}}function T(r,t){return function(e,i){const s=e[0],n=r(e,i);return new An(t,s,...n)}}function Wn(r,t){const e=r[0],i=Rn[e];if(!i)throw new Error(`Unknown operator: ${e}`);return i(r,t)}function bi(){return{variables:{},properties:{},resolution:NaN}}function ut(r,t,e){const i=re(r,e);if(!Ei(t,i.type)){const s=ie(t),n=ie(i.type);throw new Error(`Expected expression to be of type ${s}, got ${n}`)}return pt(i)}function pt(r,t){if(r instanceof ht)return function(){return r.value};const e=r.operator;switch(e){case _.Number:case _.String:return Yn(r);case _.Get:case _.Var:return Pn(r);case _.Resolution:return i=>i.resolution;case _.Any:case _.All:case _.Not:return Nn(r);case _.Equal:case _.NotEqual:case _.LessThan:case _.LessThanOrEqualTo:case _.GreaterThan:case _.GreaterThanOrEqualTo:return Xn(r);case _.Multiply:case _.Divide:case _.Add:case _.Subtract:case _.Clamp:case _.Mod:case _.Pow:case _.Abs:case _.Floor:case _.Ceil:case _.Round:case _.Sin:case _.Cos:case _.Atan:case _.Sqrt:return Gn(r);case _.Match:return zn(r);default:throw new Error(`Unsupported operator ${e}`)}}function Yn(r,t){const e=r.operator,i=r.args.length,s=new Array(i);for(let n=0;n<i;++n)s[n]=pt(r.args[n]);switch(e){case _.Number:case _.String:return n=>{for(let o=0;o<i;++o){const a=s[o](n);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Pn(r,t){const e=r.args[0];if(!(e instanceof ht))throw new Error("Expected literal name");const i=e.value;if(typeof i!="string")throw new Error("Expected string name");switch(r.operator){case _.Get:return s=>s.properties[i];case _.Var:return s=>s.variables[i];default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}function Xn(r,t){const e=r.operator,i=pt(r.args[0]),s=pt(r.args[1]);switch(e){case _.Equal:return n=>i(n)===s(n);case _.NotEqual:return n=>i(n)!==s(n);case _.LessThan:return n=>i(n)<s(n);case _.LessThanOrEqualTo:return n=>i(n)<=s(n);case _.GreaterThan:return n=>i(n)>s(n);case _.GreaterThanOrEqualTo:return n=>i(n)>=s(n);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Nn(r,t){const e=r.operator,i=r.args.length,s=new Array(i);for(let n=0;n<i;++n)s[n]=pt(r.args[n]);switch(e){case _.Any:return n=>{for(let o=0;o<i;++o)if(s[o](n))return!0;return!1};case _.All:return n=>{for(let o=0;o<i;++o)if(!s[o](n))return!1;return!0};case _.Not:return n=>!s[0](n);default:throw new Error(`Unsupported logical operator ${e}`)}}function Gn(r,t){const e=r.operator,i=r.args.length,s=new Array(i);for(let n=0;n<i;++n)s[n]=pt(r.args[n]);switch(e){case _.Multiply:return n=>{let o=1;for(let a=0;a<i;++a)o*=s[a](n);return o};case _.Divide:return n=>s[0](n)/s[1](n);case _.Add:return n=>{let o=0;for(let a=0;a<i;++a)o+=s[a](n);return o};case _.Subtract:return n=>s[0](n)-s[1](n);case _.Clamp:return n=>{const o=s[0](n),a=s[1](n);if(o<a)return a;const l=s[2](n);return o>l?l:o};case _.Mod:return n=>s[0](n)%s[1](n);case _.Pow:return n=>Math.pow(s[0](n),s[1](n));case _.Abs:return n=>Math.abs(s[0](n));case _.Floor:return n=>Math.floor(s[0](n));case _.Ceil:return n=>Math.ceil(s[0](n));case _.Round:return n=>Math.round(s[0](n));case _.Sin:return n=>Math.sin(s[0](n));case _.Cos:return n=>Math.cos(s[0](n));case _.Atan:return i===2?n=>Math.atan2(s[0](n),s[1](n)):n=>Math.atan(s[0](n));case _.Sqrt:return n=>Math.sqrt(s[0](n));default:throw new Error(`Unsupported numeric operator ${e}`)}}function zn(r,t){const e=r.args.length,i=new Array(e);for(let s=0;s<e;++s)i[s]=pt(r.args[s]);return s=>{const n=i[0](s);for(let o=1;o<e;o+=2)if(n===i[o](s))return i[o+1](s);return i[e-1](s)}}function Vn(r){return!0}function Un(r){const t=Ii(),e=$n(r,t),i=bi();return function(s,n){return i.properties=s.getPropertiesInternal(),i.resolution=n,e(i)}}function ti(r){const t=Ii(),e=r.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=Ce(r[o],t);const s=bi(),n=new Array(e);return function(o,a){s.properties=o.getPropertiesInternal(),s.resolution=a;for(let l=0;l<e;++l)n[l]=i[l](s);return n}}function $n(r,t){const e=r.length,i=new Array(e);for(let s=0;s<e;++s){const n=r[s],o="filter"in n?ut(n.filter,G,t):Vn;let a;if(Array.isArray(n.style)){const l=n.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=Ce(n.style[h],t)}else a=[Ce(n.style,t)];i[s]={filter:o,styles:a}}return function(s){const n=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(s)&&!(r[a].else&&o)){o=!0;for(const h of i[a].styles){const c=h(s);c&&n.push(c)}}}return n}}function Ce(r,t){const e=Wt(r,"",t),i=Yt(r,"",t),s=qn(r,t),n=Hn(r,t),o=U(r,"z-index",t),a=new Qt;return function(l){let h=!0;if(e){const c=e(l);c&&(h=!1),a.setFill(c)}if(i){const c=i(l);c&&(h=!1),a.setStroke(c)}if(s){const c=s(l);c&&(h=!1),a.setText(c)}if(n){const c=n(l);c&&(h=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),h?null:a}}function Wt(r,t,e){const i=ki(r,t+"fill-color",e);if(!i)return null;const s=new xi;return function(n){const o=i(n);return o==="none"?null:(s.setColor(o),s)}}function Yt(r,t,e){const i=U(r,t+"stroke-width",e),s=ki(r,t+"stroke-color",e);if(!i&&!s)return null;const n=lt(r,t+"stroke-line-cap",e),o=lt(r,t+"stroke-line-join",e),a=Ci(r,t+"stroke-line-dash",e),l=U(r,t+"stroke-line-dash-offset",e),h=U(r,t+"stroke-miter-limit",e),c=new cn;return function(f){if(s){const u=s(f);if(u==="none")return null;c.setColor(u)}if(i&&c.setWidth(i(f)),n){const u=n(f);if(u!=="butt"&&u!=="round"&&u!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(u)}if(o){const u=o(f);if(u!=="bevel"&&u!=="round"&&u!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(u)}return a&&c.setLineDash(a(f)),l&&c.setLineDashOffset(l(f)),h&&c.setMiterLimit(h(f)),c}}function qn(r,t){const e="text-",i=lt(r,e+"value",t);if(!i)return null;const s=Wt(r,e,t),n=Wt(r,e+"background-",t),o=Yt(r,e,t),a=Yt(r,e+"background-",t),l=lt(r,e+"font",t),h=U(r,e+"max-angle",t),c=U(r,e+"offset-x",t),f=U(r,e+"offset-y",t),u=Pt(r,e+"overflow",t),d=lt(r,e+"placement",t),g=U(r,e+"repeat",t),S=oe(r,e+"scale",t),p=Pt(r,e+"rotate-with-view",t),m=U(r,e+"rotation",t),b=lt(r,e+"align",t),E=lt(r,e+"justify",t),C=lt(r,e+"baseline",t),k=Ci(r,e+"padding",t),y=new vn({});return function(I){if(y.setText(i(I)),s&&y.setFill(s(I)),n&&y.setBackgroundFill(n(I)),o&&y.setStroke(o(I)),a&&y.setBackgroundStroke(a(I)),l&&y.setFont(l(I)),h&&y.setMaxAngle(h(I)),c&&y.setOffsetX(c(I)),f&&y.setOffsetY(f(I)),u&&y.setOverflow(u(I)),d){const w=d(I);if(w!=="point"&&w!=="line")throw new Error("Expected point or line for text-placement");y.setPlacement(w)}if(g&&y.setRepeat(g(I)),S&&y.setScale(S(I)),p&&y.setRotateWithView(p(I)),m&&y.setRotation(m(I)),b){const w=b(I);if(w!=="left"&&w!=="center"&&w!=="right"&&w!=="end"&&w!=="start")throw new Error("Expected left, right, center, start, or end for text-align");y.setTextAlign(w)}if(E){const w=E(I);if(w!=="left"&&w!=="right"&&w!=="center")throw new Error("Expected left, right, or center for text-justify");y.setJustify(w)}if(C){const w=C(I);if(w!=="bottom"&&w!=="top"&&w!=="middle"&&w!=="alphabetic"&&w!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");y.setTextBaseline(w)}return k&&y.setPadding(k(I)),y}}function Hn(r,t){return"icon-src"in r?Jn(r,t):"shape-points"in r?jn(r,t):"circle-radius"in r?Kn(r,t):null}function Jn(r,t){const e="icon-",i=e+"src",s=Mi(r[i],i),n=ne(r,e+"anchor",t),o=oe(r,e+"scale",t),a=U(r,e+"opacity",t),l=ne(r,e+"displacement",t),h=U(r,e+"rotation",t),c=Pt(r,e+"rotate-with-view",t),f=ei(r,e+"anchor-origin"),u=ii(r,e+"anchor-x-units"),d=ii(r,e+"anchor-y-units"),g=es(r,e+"color"),S=Qn(r,e+"cross-origin"),p=ts(r,e+"offset"),m=ei(r,e+"offset-origin"),b=Et(r,e+"width"),E=Et(r,e+"height"),C=Zn(r,e+"size"),k=Le(r,e+"declutter"),y=new wi({src:s,anchorOrigin:f,anchorXUnits:u,anchorYUnits:d,color:g,crossOrigin:S,offset:p,offsetOrigin:m,height:E,width:b,size:C,declutterMode:k});return function(I){return a&&y.setOpacity(a(I)),l&&y.setDisplacement(l(I)),h&&y.setRotation(h(I)),c&&y.setRotateWithView(c(I)),o&&y.setScale(o(I)),n&&y.setAnchor(n(I)),y}}function jn(r,t){const e="shape-",i=e+"points",s=Oi(r[i],i),n=Wt(r,e,t),o=Yt(r,e,t),a=oe(r,e+"scale",t),l=ne(r,e+"displacement",t),h=U(r,e+"rotation",t),c=Pt(r,e+"rotate-with-view",t),f=Et(r,e+"radius"),u=Et(r,e+"radius1"),d=Et(r,e+"radius2"),g=Et(r,e+"angle"),S=Le(r,e+"declutter-mode"),p=new un({points:s,radius:f,radius1:u,radius2:d,angle:g,declutterMode:S});return function(m){return n&&p.setFill(n(m)),o&&p.setStroke(o(m)),l&&p.setDisplacement(l(m)),h&&p.setRotation(h(m)),c&&p.setRotateWithView(c(m)),a&&p.setScale(a(m)),p}}function Kn(r,t){const e="circle-",i=Wt(r,e,t),s=Yt(r,e,t),n=U(r,e+"radius",t),o=oe(r,e+"scale",t),a=ne(r,e+"displacement",t),l=U(r,e+"rotation",t),h=Pt(r,e+"rotate-with-view",t),c=Le(r,e+"declutter-mode"),f=new fn({radius:5,declutterMode:c});return function(u){return n&&f.setRadius(n(u)),i&&f.setFill(i(u)),s&&f.setStroke(s(u)),a&&f.setDisplacement(a(u)),l&&f.setRotation(l(u)),h&&f.setRotateWithView(h(u)),o&&f.setScale(o(u)),f}}function U(r,t,e){if(!(t in r))return;const i=ut(r[t],O,e);return function(s){return Oi(i(s),t)}}function lt(r,t,e){if(!(t in r))return null;const i=ut(r[t],It,e);return function(s){return Mi(i(s),t)}}function Pt(r,t,e){if(!(t in r))return null;const i=ut(r[t],G,e);return function(s){const n=i(s);if(typeof n!="boolean")throw new Error(`Expected a boolean for ${t}`);return n}}function ki(r,t,e){if(!(t in r))return null;const i=ut(r[t],Te|It,e);return function(s){return vi(i(s),t)}}function Ci(r,t,e){if(!(t in r))return null;const i=ut(r[t],Xt,e);return function(s){return Nt(i(s),t)}}function ne(r,t,e){if(!(t in r))return null;const i=ut(r[t],Xt,e);return function(s){const n=Nt(i(s),t);if(n.length!==2)throw new Error(`Expected two numbers for ${t}`);return n}}function oe(r,t,e){if(!(t in r))return null;const i=ut(r[t],Xt|O,e);return function(s){return is(i(s),t)}}function Et(r,t){const e=r[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function Zn(r,t){const e=r[t];if(e!==void 0){if(typeof e=="number")return Ee(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function Qn(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function ei(r,t){const e=r[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function ii(r,t){const e=r[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function ts(r,t){const e=r[t];if(e!==void 0)return Nt(e,t)}function Le(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function es(r,t){const e=r[t];if(e!==void 0)return vi(e,t)}function Nt(r,t){if(!Array.isArray(r))throw new Error(`Expected an array for ${t}`);const e=r.length;for(let i=0;i<e;++i)if(typeof r[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return r}function Mi(r,t){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);return r}function Oi(r,t){if(typeof r!="number")throw new Error(`Expected a number for ${t}`);return r}function vi(r,t){if(typeof r=="string")return r;const e=Nt(r,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function is(r,t){if(typeof r=="number")return r;const e=Nt(r,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}const ni={RENDER_ORDER:"renderOrder"};class ns extends $i{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter!==void 0?t.declutter:!1,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(ni.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new wn(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(ni.RENDER_ORDER,t)}setStyle(t){this.style_=ss(t),this.styleFunction_=t===null?void 0:dn(this.style_),this.changed()}}function ss(r){if(r===void 0)return gn;if(!r)return null;if(typeof r=="function"||r instanceof Qt)return r;if(!Array.isArray(r))return ti([r]);if(r.length===0)return[];const t=r.length,e=r[0];if(e instanceof Qt){const s=new Array(t);for(let n=0;n<t;++n){const o=r[n];if(!(o instanceof Qt))throw new Error("Expected a list of style instances");s[n]=o}return s}if("style"in e){const s=new Array(t);for(let n=0;n<t;++n){const o=r[n];if(!("style"in o))throw new Error("Expected a list of rules with a style property");s[n]=o}return Un(s)}return ti(r)}const Ms=ns,Gt={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Zt=[Gt.FILL],ct=[Gt.STROKE],dt=[Gt.BEGIN_PATH],si=[Gt.CLOSE_PATH],M=Gt;class rs extends _n{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,n=this.coordinates;let o=n.length;for(let a=0,l=t.length;a<l;a+=e)s[0]=t[a],s[1]=t[a+1],qi(i,s)&&(n[o++]=s[0],n[o++]=s[1]);return o}appendFlatLineCoordinates(t,e,i,s,n,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=s);let c=t[e],f=t[e+1];const u=this.tmpCoordinate_;let d=!0,g,S,p;for(g=e+s;g<i;g+=s)u[0]=t[g],u[1]=t[g+1],p=Hi(h,u),p!==S?(d&&(a[l++]=c,a[l++]=f,d=!1),a[l++]=u[0],a[l++]=u[1]):p===Ji.INTERSECTING?(a[l++]=u[0],a[l++]=u[1],d=!1):d=!0,c=u[0],f=u[1],S=p;return(n&&d||g===e+s)&&(a[l++]=c,a[l++]=f),l}drawCustomCoordinates_(t,e,i,s,n){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(t,e,l,s,!1,!1);n.push(h),e=l}return e}drawCustom(t,e,i,s){this.beginGeometry(t,e);const n=t.getType(),o=t.getStride(),a=this.coordinates.length;let l,h,c,f,u;switch(n){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),f=[];const d=t.getEndss();u=0;for(let g=0,S=d.length;g<S;++g){const p=[];u=this.drawCustomCoordinates_(l,u,d[g],o,p),f.push(p)}this.instructions.push([M.CUSTOM,a,f,t,i,He]),this.hitDetectionInstructions.push([M.CUSTOM,a,f,t,s||i,He]);break;case"Polygon":case"MultiLineString":c=[],l=n=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(l,0,t.getEnds(),o,c),this.instructions.push([M.CUSTOM,a,c,t,i,qe]),this.hitDetectionInstructions.push([M.CUSTOM,a,c,t,s||i,qe]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([M.CUSTOM,a,h,t,i,Jt]),this.hitDetectionInstructions.push([M.CUSTOM,a,h,t,s||i,Jt]);break;case"MultiPoint":l=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(l,o),h>a&&(this.instructions.push([M.CUSTOM,a,h,t,i,Jt]),this.hitDetectionInstructions.push([M.CUSTOM,a,h,t,s||i,Jt]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),h=this.coordinates.length,this.instructions.push([M.CUSTOM,a,h,t,i]),this.hitDetectionInstructions.push([M.CUSTOM,a,h,t,s||i]);break}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[M.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[M.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let s,n,o=-1;for(e=0;e<i;++e)s=t[e],n=s[0],n==M.END_GEOMETRY?o=e:n==M.BEGIN_GEOMETRY&&(s[2]=e,ji(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const s=t.getColor();i.fillStyle=ee(s||tt)}else i.fillStyle=void 0;if(e){const s=e.getColor();i.strokeStyle=ee(s||li);const n=e.getLineCap();i.lineCap=n!==void 0?n:hi;const o=e.getLineDash();i.lineDash=o?o.slice():gt;const a=e.getLineDashOffset();i.lineDashOffset=a||_t;const l=e.getLineJoin();i.lineJoin=l!==void 0?l:ci;const h=e.getWidth();i.lineWidth=h!==void 0?h:ui;const c=e.getMiterLimit();i.miterLimit=c!==void 0?c:fi,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[M.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[M.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,s=t.lineCap,n=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||n!=t.currentLineDash&&!di(t.currentLineDash,n)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=n,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[M.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ki(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;gi(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const zt=rs;class os extends zt{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),n=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([M.DRAW_IMAGE,n,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([M.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),n=this.coordinates.length,o=this.appendFlatPointCoordinates(i,s);this.instructions.push([M.DRAW_IMAGE,n,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([M.DRAW_IMAGE,n,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),s=t.getSize(),n=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const as=os;class ls extends zt{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){const n=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),a=[M.MOVE_TO_LINE_TO,n,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e){const i=this.state,s=i.strokeStyle,n=i.lineWidth;if(s===void 0||n===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([M.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,gt,_t],dt);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(ct),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,s=i.strokeStyle,n=i.lineWidth;if(s===void 0||n===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([M.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,gt,_t],dt);const o=t.getEnds(),a=t.getFlatCoordinates(),l=t.getStride();let h=0;for(let c=0,f=o.length;c<f;++c)h=this.drawFlatCoordinates_(a,h,o[c],l);this.hitDetectionInstructions.push(ct),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(ct),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(ct),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(dt)}}const hs=ls;class cs extends zt{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){const n=this.state,o=n.fillStyle!==void 0,a=n.strokeStyle!==void 0,l=i.length;this.instructions.push(dt),this.hitDetectionInstructions.push(dt);for(let h=0;h<l;++h){const c=i[h],f=this.coordinates.length,u=this.appendFlatLineCoordinates(t,e,c,s,!0,!a),d=[M.MOVE_TO_LINE_TO,f,u];this.instructions.push(d),this.hitDetectionInstructions.push(d),a&&(this.instructions.push(si),this.hitDetectionInstructions.push(si)),e=c}return o&&(this.instructions.push(Zt),this.hitDetectionInstructions.push(Zt)),a&&(this.instructions.push(ct),this.hitDetectionInstructions.push(ct)),e}drawCircle(t,e){const i=this.state,s=i.fillStyle,n=i.strokeStyle;if(s===void 0&&n===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_FILL_STYLE,tt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,gt,_t]);const o=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const h=[M.CIRCLE,l];this.instructions.push(dt,h),this.hitDetectionInstructions.push(dt,h),i.fillStyle!==void 0&&(this.instructions.push(Zt),this.hitDetectionInstructions.push(Zt)),i.strokeStyle!==void 0&&(this.instructions.push(ct),this.hitDetectionInstructions.push(ct)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,s=i.fillStyle,n=i.strokeStyle;if(s===void 0&&n===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_FILL_STYLE,tt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,gt,_t]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,s=i.fillStyle,n=i.strokeStyle;if(s===void 0&&n===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_FILL_STYLE,tt]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([M.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,gt,_t]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),l=t.getStride();let h=0;for(let c=0,f=o.length;c<f;++c)h=this.drawFlatCoordinatess_(a,h,o[c],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=Zi(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const ri=cs;function us(r,t,e,i,s){const n=[];let o=e,a=0,l=t.slice(e,2);for(;a<r&&o+s<i;){const[h,c]=l.slice(-2),f=t[o+s],u=t[o+s+1],d=Math.sqrt((f-h)*(f-h)+(u-c)*(u-c));if(a+=d,a>=r){const g=(r-a+d)/d,S=et(h,f,g),p=et(c,u,g);l.push(S,p),n.push(l),l=[S,p],a==r&&(o+=s),a=0}else if(a<r)l.push(t[o+s],t[o+s+1]),o+=s;else{const g=d-a,S=et(h,f,g/d),p=et(c,u,g/d);l.push(S,p),n.push(l),l=[S,p],a=0,o+=s}}return a>0&&n.push(l),n}function fs(r,t,e,i,s){let n=e,o=e,a=0,l=0,h=e,c,f,u,d,g,S,p,m,b,E;for(f=e;f<i;f+=s){const C=t[f],k=t[f+1];g!==void 0&&(b=C-g,E=k-S,d=Math.sqrt(b*b+E*E),p!==void 0&&(l+=u,c=Math.acos((p*b+m*E)/(u*d)),c>r&&(l>a&&(a=l,n=h,o=f),l=0,h=f-s)),u=d,p=b,m=E),g=C,S=k}return l+=d,l>a?[h,f]:[n,o]}const se={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class ds extends zt{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[tt]={fillStyle:tt},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,s=this.textStrokeState_,n=this.textState_;if(this.text_===""||!n||!i&&!s)return;const o=this.coordinates;let a=o.length;const l=t.getType();let h=null,c=t.getStride();if(n.placement==="line"&&(l=="LineString"||l=="MultiLineString"||l=="Polygon"||l=="MultiPolygon")){if(!Me(this.getBufferedMaxExtent(),t.getExtent()))return;let f;if(h=t.getFlatCoordinates(),l=="LineString")f=[h.length];else if(l=="MultiLineString")f=t.getEnds();else if(l=="Polygon")f=t.getEnds().slice(0,1);else if(l=="MultiPolygon"){const S=t.getEndss();f=[];for(let p=0,m=S.length;p<m;++p)f.push(S[p][0])}this.beginGeometry(t,e);const u=n.repeat,d=u?void 0:n.textAlign;let g=0;for(let S=0,p=f.length;S<p;++S){let m;u?m=us(u*this.resolution,h,g,f[S],c):m=[h.slice(g,f[S])];for(let b=0,E=m.length;b<E;++b){const C=m[b];let k=0,y=C.length;if(d==null){const w=fs(n.maxAngle,C,0,C.length,2);k=w[0],y=w[1]}for(let w=k;w<y;w+=c)o.push(C[w],C[w+1]);const I=o.length;g=f[S],this.drawChars_(a,I),a=I}}this.endGeometry(e)}else{let f=n.overflow?null:[];switch(l){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),c=2;break;case"Polygon":h=t.getFlatInteriorPoint(),n.overflow||f.push(h[2]/this.resolution),c=3;break;case"MultiPolygon":const m=t.getFlatInteriorPoints();h=[];for(let b=0,E=m.length;b<E;b+=3)n.overflow||f.push(m[b+2]/this.resolution),h.push(m[b],m[b+1]);if(h.length===0)return;c=2;break}const u=this.appendFlatPointCoordinates(h,c);if(u===a)return;if(f&&(u-a)/2!==h.length/c){let m=a/2;f=f.filter((b,E)=>{const C=o[(m+E)*2]===h[E*c]&&o[(m+E)*2+1]===h[E*c+1];return C||--m,C})}this.saveTextStates_(),(n.backgroundFill||n.backgroundStroke)&&(this.setFillStrokeStyle(n.backgroundFill,n.backgroundStroke),n.backgroundFill&&this.updateFillStyle(this.state,this.createFill),n.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let d=n.padding;if(d!=ft&&(n.scale[0]<0||n.scale[1]<0)){let m=n.padding[0],b=n.padding[1],E=n.padding[2],C=n.padding[3];n.scale[0]<0&&(b=-b,C=-C),n.scale[1]<0&&(m=-m,E=-E),d=[m,b,E,C]}const g=this.pixelRatio;this.instructions.push([M.DRAW_IMAGE,a,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,d==ft?ft:d.map(function(m){return m*g}),!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]);const S=1/g,p=this.state.fillStyle;n.backgroundFill&&(this.state.fillStyle=tt,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([M.DRAW_IMAGE,a,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[S,S],NaN,void 0,this.declutterImageWithText_,d,!!n.backgroundFill,!!n.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?tt:this.fillKey_,this.textOffsetX_,this.textOffsetY_,f]),n.backgroundFill&&(this.state.fillStyle=p,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||Ie,justify:e.justify,textBaseline:e.textBaseline||be,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,s=this.textState_,n=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=se[s.textBaseline],c=this.textOffsetY_*l,f=this.text_,u=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([M.DRAW_CHARS,t,e,h,s.overflow,a,s.maxAngle,l,c,n,u*l,f,o,1]),this.hitDetectionInstructions.push([M.DRAW_CHARS,t,e,h,s.overflow,a&&tt,s.maxAngle,l,c,n,u*l,f,o,1/l])}setTextStyle(t,e){let i,s,n;if(!t)this.text_="";else{const o=t.getFill();o?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=ee(o.getColor()||tt)):(s=null,this.textFillState_=s);const a=t.getStroke();if(!a)n=null,this.textStrokeState_=n;else{n=this.textStrokeState_,n||(n={},this.textStrokeState_=n);const g=a.getLineDash(),S=a.getLineDashOffset(),p=a.getWidth(),m=a.getMiterLimit();n.lineCap=a.getLineCap()||hi,n.lineDash=g?g.slice():gt,n.lineDashOffset=S===void 0?_t:S,n.lineJoin=a.getLineJoin()||ci,n.lineWidth=p===void 0?ui:p,n.miterLimit=m===void 0?fi:m,n.strokeStyle=ee(a.getColor()||li)}i=this.textState_;const l=t.getFont()||Qi;tn(l);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||be,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ft,i.scale=h===void 0?[1,1]:h;const c=t.getOffsetX(),f=t.getOffsetY(),u=t.getRotateWithView(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=f===void 0?0:f,this.textRotateWithView_=u===void 0?!1:u,this.textRotation_=d===void 0?0:d,this.strokeKey_=n?(typeof n.strokeStyle=="string"?n.strokeStyle:ye(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s?typeof s.fillStyle=="string"?s.fillStyle:"|"+ye(s.fillStyle):""}this.declutterImageWithText_=e}}const gs={Circle:ri,Default:zt,Image:as,LineString:hs,Polygon:ri,Text:ds};class _s{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const s in i){const n=i[s].finish();t[e][s]=n}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[i];s===void 0&&(s={},this.buildersByZIndex_[i]=s);let n=s[e];if(n===void 0){const o=gs[e];n=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=n}return n}}const Os=_s;function ps(r,t,e,i,s,n,o,a,l,h,c,f){let u=r[t],d=r[t+1],g=0,S=0,p=0,m=0;function b(){g=u,S=d,t+=i,u=r[t],d=r[t+1],m+=p,p=Math.sqrt((u-g)*(u-g)+(d-S)*(d-S))}do b();while(t<e-i&&m+p<n);let E=p===0?0:(n-m)/p;const C=et(g,u,E),k=et(S,d,E),y=t-i,I=m,w=n+a*l(h,s,c);for(;t<e-i&&m+p<w;)b();E=p===0?0:(w-m)/p;const v=et(g,u,E),L=et(S,d,E);let P;if(f){const R=[C,k,v,L];en(R,0,4,2,f,R,R),P=R[0]>R[2]}else P=C>v;const W=Math.PI,F=[],j=y+i===t;t=y,p=0,m=I,u=r[t],d=r[t+1];let A;if(j){b(),A=Math.atan2(d-S,u-g),P&&(A+=A>0?-W:W);const R=(v+C)/2,Y=(L+k)/2;return F[0]=[R,Y,(w-n)/2,A,s],F}s=s.replace(/\n/g," ");for(let R=0,Y=s.length;R<Y;){b();let D=Math.atan2(d-S,u-g);if(P&&(D+=D>0?-W:W),A!==void 0){let Q=D-A;if(Q+=Q>W?-2*W:Q<-W?2*W:0,Math.abs(Q)>o)return null}A=D;const X=R;let N=0;for(;R<Y;++R){const Q=P?Y-R-1:R,mt=a*l(h,s[Q],c);if(t+i<e&&m+p<n+N+mt/2)break;N+=mt}if(R===X)continue;const Z=P?s.substring(Y-X,Y-R):s.substring(X,R);E=p===0?0:(n+N/2-m)/p;const x=et(g,u,E),Ae=et(S,d,E);F.push([x,Ae,N/2,D,Z]),n+=N}return F}const wt=mi(),ot=[],st=[],rt=[],at=[];function oi(r){return r[3].declutterBox}const ai=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function me(r,t){return t==="start"?t=ai.test(r)?"right":"left":t==="end"&&(t=ai.test(r)?"left":"right"),se[t]}function ms(r,t,e){return e>0&&r.push(`
`,""),r.push(t,""),r}class xs{constructor(t,e,i,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=ke(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,s){const n=t+e+i+s;if(this.labels_[n])return this.labels_[n];const o=s?this.strokeStates[s]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],f=Array.isArray(t),u=l.justify?se[l.justify]:me(Array.isArray(t)?t[0]:t,l.textAlign||Ie),d=s&&o.lineWidth?o.lineWidth:0,g=f?t:t.split(`
`).reduce(ms,[]),{width:S,height:p,widths:m,heights:b,lineWidths:E}=nn(l,g),C=S+d,k=[],y=(C+2)*c[0],I=(p+d)*c[1],w={width:y<0?Math.floor(y):Math.ceil(y),height:I<0?Math.floor(I):Math.ceil(I),contextInstructions:k};(c[0]!=1||c[1]!=1)&&k.push("scale",c),s&&(k.push("strokeStyle",o.strokeStyle),k.push("lineWidth",d),k.push("lineCap",o.lineCap),k.push("lineJoin",o.lineJoin),k.push("miterLimit",o.miterLimit),k.push("setLineDash",[o.lineDash]),k.push("lineDashOffset",o.lineDashOffset)),i&&k.push("fillStyle",a.fillStyle),k.push("textBaseline","middle"),k.push("textAlign","center");const v=.5-u;let L=u*C+v*d;const P=[],W=[];let F=0,j=0,A=0,R=0,Y;for(let D=0,X=g.length;D<X;D+=2){const N=g[D];if(N===`
`){j+=F,F=0,L=u*C+v*d,++R;continue}const Z=g[D+1]||l.font;Z!==Y&&(s&&P.push("font",Z),i&&W.push("font",Z),Y=Z),F=Math.max(F,b[A]);const x=[N,L+v*m[A]+u*(m[A]-E[R]),.5*(d+F)+j];L+=m[A],s&&P.push("strokeText",x),i&&W.push("fillText",x),++A}return Array.prototype.push.apply(k,P),Array.prototype.push.apply(k,W),this.labels_[n]=w,w}replayTextBackground_(t,e,i,s,n,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,n),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,n,o,a,l,h,c,f,u,d,g,S,p){a*=u[0],l*=u[1];let m=i-a,b=s-l;const E=n+h>t?t-h:n,C=o+c>e?e-c:o,k=g[3]+E*u[0]+g[1],y=g[0]+C*u[1]+g[2],I=m-g[3],w=b-g[0];(S||f!==0)&&(ot[0]=I,at[0]=I,ot[1]=w,st[1]=w,st[0]=I+k,rt[0]=st[0],rt[1]=w+y,at[1]=rt[1]);let v;return f!==0?(v=_i(ke(),i,s,1,1,f,-i,-s),Tt(v,ot),Tt(v,st),Tt(v,rt),Tt(v,at),Je(Math.min(ot[0],st[0],rt[0],at[0]),Math.min(ot[1],st[1],rt[1],at[1]),Math.max(ot[0],st[0],rt[0],at[0]),Math.max(ot[1],st[1],rt[1],at[1]),wt)):Je(Math.min(I,I+k),Math.min(w,w+y),Math.max(I,I+k),Math.max(w,w+y),wt),d&&(m=Math.round(m),b=Math.round(b)),{drawImageX:m,drawImageY:b,drawImageW:E,drawImageH:C,originX:h,originY:c,declutterBox:{minX:wt[0],minY:wt[1],maxX:wt[2],maxY:wt[3],value:p},canvasTransform:v,scale:u}}replayImageOrLabel_(t,e,i,s,n,o,a){const l=!!(o||a),h=s.declutterBox,c=t.canvas,f=a?a[2]*s.scale[0]/2:0;return h.minX-f<=c.width/e&&h.maxX+f>=0&&h.minY-f<=c.height/e&&h.maxY+f>=0&&(l&&this.replayTextBackground_(t,ot,st,rt,at,o,a),sn(t,s.canvasTransform,n,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){if(this.alignFill_){const e=Tt(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,s){const n=this.textStates[e],o=this.createLabel(t,e,s,i),a=this.strokeStates[i],l=this.pixelRatio,h=me(Array.isArray(t)?t[0]:t,n.textAlign||Ie),c=se[n.textBaseline||be],f=a&&a.lineWidth?a.lineWidth:0,u=o.width/l-2*n.scale[0],d=h*u+2*(.5-h)*f,g=c*o.height/l+2*(.5-c)*f;return{label:o,anchorX:d,anchorY:g}}execute_(t,e,i,s,n,o,a,l){let h;this.pixelCoordinates_&&di(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=pi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),rn(this.renderedTransform_,i));let c=0;const f=s.length;let u=0,d,g,S,p,m,b,E,C,k,y,I,w,v=0,L=0,P=null,W=null;const F=this.coordinateCache_,j=this.viewRotation_,A=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,R={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:j},Y=this.instructions!=s||this.overlaps?0:200;let D,X,N,Z;for(;c<f;){const x=s[c];switch(x[0]){case M.BEGIN_GEOMETRY:D=x[1],Z=x[3],D.getGeometry()?a!==void 0&&!Me(a,Z.getExtent())?c=x[2]+1:++c:c=x[2];break;case M.BEGIN_PATH:v>Y&&(this.fill_(t),v=0),L>Y&&(t.stroke(),L=0),!v&&!L&&(t.beginPath(),p=NaN,m=NaN),++c;break;case M.CIRCLE:u=x[1];const Q=h[u],mt=h[u+1],Ti=h[u+2],Li=h[u+3],Re=Ti-Q,De=Li-mt,Be=Math.sqrt(Re*Re+De*De);t.moveTo(Q+Be,mt),t.arc(Q,mt,Be,0,2*Math.PI,!0),++c;break;case M.CLOSE_PATH:t.closePath(),++c;break;case M.CUSTOM:u=x[1],d=x[2];const Ai=x[3],Ri=x[4],Fe=x.length==6?x[5]:void 0;R.geometry=Ai,R.feature=D,c in F||(F[c]=[]);const kt=F[c];Fe?Fe(h,u,d,2,kt):(kt[0]=h[u],kt[1]=h[u+1],kt.length=2),Ri(kt,R),++c;break;case M.DRAW_IMAGE:u=x[1],d=x[2],C=x[3],g=x[4],S=x[5];let ae=x[6];const Di=x[7],Bi=x[8],Fi=x[9],We=x[10];let le=x[11];const Wi=x[12];let Vt=x[13];const Ye=x[14],Ct=x[15];if(!C&&x.length>=20){k=x[19],y=x[20],I=x[21],w=x[22];const $=this.drawLabelWithPointPlacement_(k,y,I,w);C=$.label,x[3]=C;const xt=x[23];g=($.anchorX-xt)*this.pixelRatio,x[4]=g;const H=x[24];S=($.anchorY-H)*this.pixelRatio,x[5]=S,ae=C.height,x[6]=ae,Vt=C.width,x[13]=Vt}let he;x.length>25&&(he=x[25]);let ce,Ut,$t;x.length>17?(ce=x[16],Ut=x[17],$t=x[18]):(ce=ft,Ut=!1,$t=!1),We&&A?le+=j:!We&&!A&&(le-=j);let Yi=0;for(;u<d;u+=2){if(he&&he[Yi++]<Vt/this.pixelRatio)continue;const $=this.calculateImageOrLabelDimensions_(C.width,C.height,h[u],h[u+1],Vt,ae,g,S,Bi,Fi,le,Wi,n,ce,Ut||$t,D),xt=[t,e,C,$,Di,Ut?P:null,$t?W:null];if(l){if(Ye==="none")continue;if(Ye==="obstacle"){l.insert($.declutterBox);continue}else{let H,it;if(Ct){const q=d-u;if(!Ct[q]){Ct[q]=xt;continue}if(H=Ct[q],delete Ct[q],it=oi(H),l.collides(it))continue}if(l.collides($.declutterBox))continue;H&&(l.insert(it),this.replayImageOrLabel_.apply(this,H)),l.insert($.declutterBox)}}this.replayImageOrLabel_.apply(this,xt)}++c;break;case M.DRAW_CHARS:const Pe=x[1],Xe=x[2],ue=x[3],Pi=x[4];w=x[5];const Xi=x[6],Ne=x[7],Ge=x[8];I=x[9];const fe=x[10];k=x[11],y=x[12];const ze=[x[13],x[13]],de=this.textStates[y],Mt=de.font,Ot=[de.scale[0]*Ne,de.scale[1]*Ne];let vt;Mt in this.widths_?vt=this.widths_[Mt]:(vt={},this.widths_[Mt]=vt);const Ve=mn(h,Pe,Xe,2),Ue=Math.abs(Ot[0])*je(Mt,k,vt);if(Pi||Ue<=Ve){const $=this.textStates[y].textAlign,xt=(Ve-Ue)*me(k,$),H=ps(h,Pe,Xe,2,k,xt,Xi,Math.abs(Ot[0]),je,Mt,vt,A?0:this.viewRotation_);t:if(H){const it=[];let q,qt,Ht,z,J;if(I)for(q=0,qt=H.length;q<qt;++q){J=H[q],Ht=J[4],z=this.createLabel(Ht,y,"",I),g=J[2]+(Ot[0]<0?-fe:fe),S=ue*z.height+(.5-ue)*2*fe*Ot[1]/Ot[0]-Ge;const nt=this.calculateImageOrLabelDimensions_(z.width,z.height,J[0],J[1],z.width,z.height,g,S,0,0,J[3],ze,!1,ft,!1,D);if(l&&l.collides(nt.declutterBox))break t;it.push([t,e,z,nt,1,null,null])}if(w)for(q=0,qt=H.length;q<qt;++q){J=H[q],Ht=J[4],z=this.createLabel(Ht,y,w,""),g=J[2],S=ue*z.height-Ge;const nt=this.calculateImageOrLabelDimensions_(z.width,z.height,J[0],J[1],z.width,z.height,g,S,0,0,J[3],ze,!1,ft,!1,D);if(l&&l.collides(nt.declutterBox))break t;it.push([t,e,z,nt,1,null,null])}l&&l.load(it.map(oi));for(let nt=0,Ni=it.length;nt<Ni;++nt)this.replayImageOrLabel_.apply(this,it[nt])}}++c;break;case M.END_GEOMETRY:if(o!==void 0){D=x[1];const $=o(D,Z);if($)return $}++c;break;case M.FILL:Y?v++:this.fill_(t),++c;break;case M.MOVE_TO_LINE_TO:for(u=x[1],d=x[2],X=h[u],N=h[u+1],b=X+.5|0,E=N+.5|0,(b!==p||E!==m)&&(t.moveTo(X,N),p=b,m=E),u+=2;u<d;u+=2)X=h[u],N=h[u+1],b=X+.5|0,E=N+.5|0,(u==d-2||b!==p||E!==m)&&(t.lineTo(X,N),p=b,m=E);++c;break;case M.SET_FILL_STYLE:P=x,this.alignFill_=x[2],v&&(this.fill_(t),v=0,L&&(t.stroke(),L=0)),t.fillStyle=x[1],++c;break;case M.SET_STROKE_STYLE:W=x,L&&(t.stroke(),L=0),this.setStrokeStyle_(t,x),++c;break;case M.STROKE:Y?L++:t.stroke(),++c;break;default:++c;break}}v&&this.fill_(t),L&&t.stroke()}execute(t,e,i,s,n,o){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,n,void 0,void 0,o)}executeHitDetection(t,e,i,s,n){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,s,n)}}const Ss=xs,xe=["Polygon","Circle","LineString","Image","Text","Default"];class ws{constructor(t,e,i,s,n,o){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ke(),this.createExecutors_(n)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];i===void 0&&(i={},this.executorsByZIndex_[e]=i);const s=t[e];for(const n in s){const o=s[n];i[n]=new Ss(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let s=0,n=t.length;s<n;++s)if(t[s]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,s,n,o){s=Math.round(s);const a=s*2+1,l=_i(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Ft(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):h||c.clearRect(0,0,a,a);let f;this.renderBuffer_!==void 0&&(f=mi(),on(f,t),gi(f,e*(this.renderBuffer_+s),f));const u=ys(s);let d;function g(k,y){const I=c.getImageData(0,0,a,a).data;for(let w=0,v=u.length;w<v;w++)if(I[u[w]]>0){if(!o||d!=="Image"&&d!=="Text"||o.includes(k)){const L=(u[w]-3)/4,P=s-L%a,W=s-(L/a|0),F=n(k,y,P*P+W*W);if(F)return F}c.clearRect(0,0,a,a);break}}const S=Object.keys(this.executorsByZIndex_).map(Number);S.sort(te);let p,m,b,E,C;for(p=S.length-1;p>=0;--p){const k=S[p].toString();for(b=this.executorsByZIndex_[k],m=xe.length-1;m>=0;--m)if(d=xe[m],E=b[d],E!==void 0&&(C=E.executeHitDetection(c,l,i,g,f),C))return C}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],s=e[1],n=e[2],o=e[3],a=[i,s,i,o,n,o,n,s];return pi(a,0,8,2,t,a),a}isEmpty(){return an(this.executorsByZIndex_)}execute(t,e,i,s,n,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(te),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||xe;let h,c,f,u,d,g;for(a&&l.reverse(),h=0,c=l.length;h<c;++h){const S=l[h].toString();for(d=this.executorsByZIndex_[S],f=0,u=o.length;f<u;++f){const p=o[f];g=d[p],g!==void 0&&g.execute(t,e,i,s,n,a)}}this.maxExtent_&&t.restore()}}const Se={};function ys(r){if(Se[r]!==void 0)return Se[r];const t=r*2+1,e=r*r,i=new Array(e+1);for(let n=0;n<=r;++n)for(let o=0;o<=r;++o){const a=n*n+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((r+n)*t+(r+o))*4+3),n>0&&l.push(((r-n)*t+(r+o))*4+3),o>0&&(l.push(((r+n)*t+(r-o))*4+3),n>0&&l.push(((r-n)*t+(r-o))*4+3))}const s=[];for(let n=0,o=i.length;n<o;++n)i[n]&&s.push(...i[n]);return Se[r]=s,s}const vs=ws,Bt=.5;function Ts(r,t,e,i,s,n,o){const a=r[0]*Bt,l=r[1]*Bt,h=Ft(a,l);h.imageSmoothingEnabled=!1;const c=h.canvas,f=new pn(h,Bt,s,null,o),u=e.length,d=Math.floor((256*256*256-1)/u),g={};for(let p=1;p<=u;++p){const m=e[p-1],b=m.getStyleFunction()||i;if(!b)continue;let E=b(m,n);if(!E)continue;Array.isArray(E)||(E=[E]);const k=(p*d).toString(16).padStart(7,"#00000");for(let y=0,I=E.length;y<I;++y){const w=E[y],v=w.getGeometryFunction()(m);if(!v||!Me(s,v.getExtent()))continue;const L=w.clone(),P=L.getFill();P&&P.setColor(k);const W=L.getStroke();W&&(W.setColor(k),W.setLineDash(null)),L.setText(void 0);const F=w.getImage();if(F){const Y=F.getImageSize();if(!Y)continue;const D=Ft(Y[0],Y[1],void 0,{alpha:!1}),X=D.canvas;D.fillStyle=k,D.fillRect(0,0,X.width,X.height),L.setImage(new wi({img:X,anchor:F.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:F.getOrigin(),opacity:1,size:F.getSize(),scale:F.getScale(),rotation:F.getRotation(),rotateWithView:F.getRotateWithView()}))}const j=L.getZIndex()||0;let A=g[j];A||(A={},g[j]=A,A.Polygon=[],A.Circle=[],A.LineString=[],A.Point=[]);const R=v.getType();if(R==="GeometryCollection"){const Y=v.getGeometriesArrayRecursive();for(let D=0,X=Y.length;D<X;++D){const N=Y[D];A[N.getType().replace("Multi","")].push(N,L)}}else A[R.replace("Multi","")].push(v,L)}}const S=Object.keys(g).map(Number).sort(te);for(let p=0,m=S.length;p<m;++p){const b=g[S[p]];for(const E in b){const C=b[E];for(let k=0,y=C.length;k<y;k+=2){f.setStyle(C[k+1]);for(let I=0,w=t.length;I<w;++I)f.setTransform(t[I]),f.drawGeometry(C[k])}}}return h.getImageData(0,0,c.width,c.height)}function Ls(r,t,e){const i=[];if(e){const s=Math.floor(Math.round(r[0])*Bt),n=Math.floor(Math.round(r[1])*Bt),o=(Ke(s,0,e.width-1)+Ke(n,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),f=Math.floor((256*256*256-1)/t.length);c&&c%f===0&&i.push(t[c/f-1])}return i}let Es=!1;function Is(r,t,e,i,s,n,o){const a=new XMLHttpRequest;a.open("GET",typeof r=="function"?r(e,i,s):r,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Es,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();let c;h=="json"||h=="text"?c=a.responseText:h=="xml"?(c=a.responseXML,c||(c=new DOMParser().parseFromString(a.responseText,"application/xml"))):h=="arraybuffer"&&(c=a.response),c?n(t.readFeatures(c,{extent:e,featureProjection:s}),t.readProjection(c)):o()}else o()},a.onerror=o,a.send()}function As(r,t){return function(e,i,s,n,o){const a=this;Is(r,t,e,i,s,function(l,h){a.addFeatures(l),n!==void 0&&n(l)},o||ln)}}export{Ms as B,Os as C,vs as E,Bt as H,wi as I,wn as R,vn as T,mn as a,Ts as c,Ls as h,Is as l,As as x};
