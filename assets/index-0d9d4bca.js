import{I as mr,T as gr,g as Ot,a_ as _r,Y as Mt,v as Rt,Z as yr,E as wr,q as Ie,af as mt,P as un,a as fn,at as Tt,ar as Er,a$ as xr,M as Sr,b0 as vr,V as br}from"./Layer-90378717.js";import{_ as Ar,i as Rr,o as Tr,c as kr,b as He,t as kt,g as It,F as Ir,j as Nr,p as Lr,k as Cr}from"./index-8c2e8abb.js";import{F as bt,V as Fr,a as Or}from"./Vector-7a212638.js";import{F as Pn,L as Pt,t as it,M as jt,a as Dn,b as zn}from"./MultiPolygon-e238d0b6.js";import{a as _t,G as Pr}from"./GeoJSON-b054ce55.js";import{a as Et,F as cn,I as Mn,S as rn,T as Un}from"./featureloader-bc55e554.js";import{J as Dr}from"./JSONFeature-580ea01d.js";import{T as zr}from"./Tile-bb0f4f3f.js";import{O as Mr}from"./OSM-c4ea94c3.js";import"./Layer-1eb66d6b.js";import"./BaseTile-0b407052.js";import"./TileProperty-9237db8f.js";import"./TileLayer-eecd48e9.js";import"./XYZ-b328a775.js";import"./TileImage-a2626a3a.js";import"./UrlTile-f9087527.js";function Nt(s,e,t){const n=t!==void 0?s.toFixed(t):""+s;let i=n.indexOf(".");return i=i===-1?n.length:i,i>e?n:new Array(1+e-i).join("0")+n}const Ur={ADD_FEATURES:"addfeatures"};class Br extends wr{constructor(e,t,n,i){super(e),this.features=n,this.file=t,this.projection=i}}class Gr extends mr{constructor(e){e=e||{},super({handleEvent:gr}),this.on,this.once,this.un,this.readAsBuffer_=!1,this.formats_=[];const t=e.formatConstructors?e.formatConstructors:[];for(let n=0,i=t.length;n<i;++n){let o=t[n];typeof o=="function"&&(o=new o),this.formats_.push(o),this.readAsBuffer_=this.readAsBuffer_||o.getType()==="arraybuffer"}this.projection_=e.projection?Ot(e.projection):null,this.dropListenKeys_=null,this.source_=e.source||null,this.target=e.target?e.target:null}handleResult_(e,t){const n=t.target.result,i=this.getMap();let o=this.projection_;o||(o=_r(),o||(o=i.getView().getProjection()));let d;const u=this.formats_;for(let f=0,m=u.length;f<m;++f){const _=u[f];let l=n;this.readAsBuffer_&&_.getType()!=="arraybuffer"&&(d===void 0&&(d=new TextDecoder().decode(n)),l=d);const h=this.tryReadFeatures_(_,l,{featureProjection:o});if(h&&h.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(h)),this.dispatchEvent(new Br(Ur.ADD_FEATURES,e,h,o));break}}}registerListeners_(){const e=this.getMap();if(e){const t=this.target?this.target:e.getViewport();this.dropListenKeys_=[Mt(t,Rt.DROP,this.handleDrop,this),Mt(t,Rt.DRAGENTER,this.handleStop,this),Mt(t,Rt.DRAGOVER,this.handleStop,this),Mt(t,Rt.DROP,this.handleStop,this)]}}setActive(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),super.setActive(e)}setMap(e){this.unregisterListeners_(),super.setMap(e),this.getActive()&&this.registerListeners_()}tryReadFeatures_(e,t,n){try{return e.readFeatures(t,n)}catch{return null}}unregisterListeners_(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(yr),this.dropListenKeys_=null)}handleDrop(e){const t=e.dataTransfer.files;for(let n=0,i=t.length;n<i;++n){const o=t.item(n),d=new FileReader;d.addEventListener(Rt.LOAD,this.handleResult_.bind(this,o)),this.readAsBuffer_?d.readAsArrayBuffer(o):d.readAsText(o)}}handleStop(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}}const Zr=Gr,Yr="Custom Drag-and-Drop (KMZ)",Kr=`
  <div id="map" class="map"></div>
  <br />
  <div>
    <a id="download" download></a>
    <button id="download-kmz">Download sample</button>
  </div>
  <br />
  <div id="info">&nbsp;</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.6.1/jszip.min.js"><\/script>
`,Xr=`
  .map {
    width: 100%;
    height: 400px;
  }
  #info {
    width: 100%;
    height: 24rem;
    overflow: scroll;
    display: flex;
    align-items: baseline;
    border: 1px solid black;
    justify-content: flex-start;
  }
`,Hr=`
  import Map from 'ol/Map.js';
  import View from 'ol/View.js';
  import {
    DragAndDrop,
    defaults as defaultInteractions,
  } from 'ol/interaction.js';
  import {GPX, GeoJSON, IGC, KML, TopoJSON} from 'ol/format.js';
  import {OSM, Vector as VectorSource} from 'ol/source.js';
  import {Tile as TileLayer, Vector as VectorLayer} from 'ol/layer.js';

  // Create functions to extract KML and icons from KMZ array buffer,
  // which must be done synchronously.

  const zip = new JSZip();

  function getKMLData(buffer) {
    let kmlData;
    zip.load(buffer);
    const kmlFile = zip.file(/.kml$/i)[0];
    if (kmlFile) {
      kmlData = kmlFile.asText();
    }
    return kmlData;
  }

  function getKMLImage(href) {
    const index = window.location.href.lastIndexOf('/');
    if (index !== -1) {
      const kmlFile = zip.file(href.slice(index + 1));
      if (kmlFile) {
        return URL.createObjectURL(new Blob([kmlFile.asArrayBuffer()]));
      }
    }
    return href;
  }

  // Define a KMZ format class by subclassing ol/format/KML

  class KMZ extends KML {
    constructor(opt_options) {
      const options = opt_options || {};
      options.iconUrlFunction = getKMLImage;
      super(options);
    }

    getType() {
      return 'arraybuffer';
    }

    readFeature(source, options) {
      const kmlData = getKMLData(source);
      return super.readFeature(kmlData, options);
    }

    readFeatures(source, options) {
      const kmlData = getKMLData(source);
      return super.readFeatures(kmlData, options);
    }
  }

  // Set up map with Drag and Drop interaction

  const dragAndDropInteraction = new DragAndDrop({
    formatConstructors: [KMZ, GPX, GeoJSON, IGC, KML, TopoJSON],
  });

  const map = new Map({
    interactions: defaultInteractions().extend([dragAndDropInteraction]),
    layers: [
      new TileLayer({
        source: new OSM(),
      }),
    ],
    target: 'map',
    view: new View({
      center: [0, 0],
      zoom: 2,
    }),
  });

  dragAndDropInteraction.on('addfeatures', function (event) {
    const vectorSource = new VectorSource({
      features: event.features,
    });
    map.addLayer(
      new VectorLayer({
        source: vectorSource,
      })
    );
    map.getView().fit(vectorSource.getExtent());
  });

  const displayFeatureInfo = function (pixel) {
    const features = [];
    map.forEachFeatureAtPixel(pixel, function (feature) {
      features.push(feature);
    });
    if (features.length > 0) {
      const info = [];
      let i, ii;
      for (i = 0, ii = features.length; i < ii; ++i) {
        const description =
          features[i].get('description') ||
          features[i].get('name') ||
          features[i].get('_name') ||
          features[i].get('layer');
        if (description) {
          info.push(description);
        }
      }
      document.getElementById('info').innerHTML = info.join('<br/>') || '&nbsp';
    } else {
      document.getElementById('info').innerHTML = '&nbsp;';
    }
  };

  map.on('pointermove', function (evt) {
    if (evt.dragging) {
      return;
    }
    const pixel = map.getEventPixel(evt.originalEvent);
    displayFeatureInfo(pixel);
  });

  map.on('click', function (evt) {
    displayFeatureInfo(evt.pixel);
  });

  // Sample data download

  const link = document.getElementById('download');

  function download(fullpath, filename) {
    fetch(fullpath)
      .then(function (response) {
        return response.blob();
      })
      .then(function (blob) {
        link.href = URL.createObjectURL(blob);
        link.download = filename;
        link.click();
      });
  }

  document.getElementById('download-kmz').addEventListener('click', function () {
    download('data/kmz/iceland.kmz', 'iceland.kmz');
  });
`,Vr=`
  {
    "name": "drag-and-drop-custom-kmz",
    "dependencies": {
      "ol": "8.2.0"
    },
    "devDependencies": {
      "vite": "^3.2.3"
    },
    "scripts": {
      "start": "vite",
      "build": "vite build"
    }
  }
`;/*!

JSZip - A Javascript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2014 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/(function(s){if(typeof exports=="object"&&typeof module<"u")module.exports=s();else if(typeof define=="function"&&define.amd)define([],s);else{var e;e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this,e.JSZip=s()}})(function(){return function s(e,t,n){function i(u,f){if(!t[u]){if(!e[u]){var m=typeof require=="function"&&require;if(!f&&m)return m(u,!0);if(o)return o(u,!0);var _=new Error("Cannot find module '"+u+"'");throw _.code="MODULE_NOT_FOUND",_}var l=t[u]={exports:{}};e[u][0].call(l.exports,function(h){var y=e[u][1][h];return i(y||h)},l,l.exports,s,e,t,n)}return t[u].exports}for(var o=typeof require=="function"&&require,d=0;d<n.length;d++)i(n[d]);return i}({1:[function(s,e,t){function n(o){if(o){this.data=o,this.length=this.data.length,this.index=0,this.zero=0;for(var d=0;d<this.data.length;d++)o[d]=255&o[d]}}var i=s("./dataReader");n.prototype=new i,n.prototype.byteAt=function(o){return this.data[this.zero+o]},n.prototype.lastIndexOfSignature=function(o){for(var d=o.charCodeAt(0),u=o.charCodeAt(1),f=o.charCodeAt(2),m=o.charCodeAt(3),_=this.length-4;_>=0;--_)if(this.data[_]===d&&this.data[_+1]===u&&this.data[_+2]===f&&this.data[_+3]===m)return _-this.zero;return-1},n.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},e.exports=n},{"./dataReader":6}],2:[function(s,e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.encode=function(i,o){for(var d,u,f,m,_,l,h,y="",v=0;v<i.length;)d=i.charCodeAt(v++),u=i.charCodeAt(v++),f=i.charCodeAt(v++),m=d>>2,_=(3&d)<<4|u>>4,l=(15&u)<<2|f>>6,h=63&f,isNaN(u)?l=h=64:isNaN(f)&&(h=64),y=y+n.charAt(m)+n.charAt(_)+n.charAt(l)+n.charAt(h);return y},t.decode=function(i,o){var d,u,f,m,_,l,h,y="",v=0;for(i=i.replace(/[^A-Za-z0-9\+\/\=]/g,"");v<i.length;)m=n.indexOf(i.charAt(v++)),_=n.indexOf(i.charAt(v++)),l=n.indexOf(i.charAt(v++)),h=n.indexOf(i.charAt(v++)),d=m<<2|_>>4,u=(15&_)<<4|l>>2,f=(3&l)<<6|h,y+=String.fromCharCode(d),l!=64&&(y+=String.fromCharCode(u)),h!=64&&(y+=String.fromCharCode(f));return y}},{}],3:[function(s,e,t){function n(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}n.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=n},{}],4:[function(s,e,t){t.STORE={magic:"\0\0",compress:function(n,i){return n},uncompress:function(n){return n},compressInputType:null,uncompressInputType:null},t.DEFLATE=s("./flate")},{"./flate":9}],5:[function(s,e,t){var n=s("./utils"),i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(o,d){if(typeof o>"u"||!o.length)return 0;var u=n.getTypeOf(o)!=="string";typeof d>"u"&&(d=0);var f=0,m=0,_=0;d^=-1;for(var l=0,h=o.length;l<h;l++)_=u?o[l]:o.charCodeAt(l),m=255&(d^_),f=i[m],d=d>>>8^f;return d^-1}},{"./utils":22}],6:[function(s,e,t){function n(o){this.data=null,this.length=0,this.index=0,this.zero=0}var i=s("./utils");n.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(o){},readInt:function(o){var d,u=0;for(this.checkOffset(o),d=this.index+o-1;d>=this.index;d--)u=(u<<8)+this.byteAt(d);return this.index+=o,u},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(o){},lastIndexOfSignature:function(o){},readDate:function(){var o=this.readInt(4);return new Date((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1)}},e.exports=n},{"./utils":22}],7:[function(s,e,t){t.base64=!1,t.binary=!1,t.dir=!1,t.createFolders=!1,t.date=null,t.compression=null,t.compressionOptions=null,t.comment=null,t.unixPermissions=null,t.dosPermissions=null},{}],8:[function(s,e,t){var n=s("./utils");t.string2binary=function(i){return n.string2binary(i)},t.string2Uint8Array=function(i){return n.transformTo("uint8array",i)},t.uint8Array2String=function(i){return n.transformTo("string",i)},t.string2Blob=function(i){var o=n.transformTo("arraybuffer",i);return n.arrayBuffer2Blob(o)},t.arrayBuffer2Blob=function(i){return n.arrayBuffer2Blob(i)},t.transformTo=function(i,o){return n.transformTo(i,o)},t.getTypeOf=function(i){return n.getTypeOf(i)},t.checkSupport=function(i){return n.checkSupport(i)},t.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,t.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,t.pretty=function(i){return n.pretty(i)},t.findCompression=function(i){return n.findCompression(i)},t.isRegExp=function(i){return n.isRegExp(i)}},{"./utils":22}],9:[function(s,e,t){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=s("pako");t.uncompressInputType=n?"uint8array":"array",t.compressInputType=n?"uint8array":"array",t.magic="\b\0",t.compress=function(o,d){return i.deflateRaw(o,{level:d.level||-1})},t.uncompress=function(o){return i.inflateRaw(o)}},{pako:25}],10:[function(s,e,t){function n(o,d){return this instanceof n?(this.files={},this.comment=null,this.root="",o&&this.load(o,d),void(this.clone=function(){var u=new n;for(var f in this)typeof this[f]!="function"&&(u[f]=this[f]);return u})):new n(o,d)}var i=s("./base64");n.prototype=s("./object"),n.prototype.load=s("./load"),n.support=s("./support"),n.defaults=s("./defaults"),n.utils=s("./deprecatedPublicUtils"),n.base64={encode:function(o){return i.encode(o)},decode:function(o){return i.decode(o)}},n.compressions=s("./compressions"),e.exports=n},{"./base64":2,"./compressions":4,"./defaults":7,"./deprecatedPublicUtils":8,"./load":11,"./object":14,"./support":18}],11:[function(s,e,t){var n=s("./base64"),i=s("./utf8"),o=s("./utils"),d=s("./zipEntries");e.exports=function(u,f){var m,_,l,h;for(f=o.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),f.base64&&(u=n.decode(u)),_=new d(u,f),m=_.files,l=0;l<m.length;l++)h=m[l],this.file(h.fileNameStr,h.decompressed,{binary:!0,optimizedBinaryString:!0,date:h.date,dir:h.dir,comment:h.fileCommentStr.length?h.fileCommentStr:null,unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions,createFolders:f.createFolders});return _.zipComment.length&&(this.comment=_.zipComment),this}},{"./base64":2,"./utf8":21,"./utils":22,"./zipEntries":23}],12:[function(s,e,t){(function(n){e.exports=function(i,o){return new n(i,o)},e.exports.test=function(i){return n.isBuffer(i)}}).call(this,typeof Buffer<"u"?Buffer:void 0)},{}],13:[function(s,e,t){function n(o){this.data=o,this.length=this.data.length,this.index=0,this.zero=0}var i=s("./uint8ArrayReader");n.prototype=new i,n.prototype.readData=function(o){this.checkOffset(o);var d=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},e.exports=n},{"./uint8ArrayReader":19}],14:[function(s,e,t){var n=s("./support"),i=s("./utils"),o=s("./crc32"),d=s("./signature"),u=s("./defaults"),f=s("./base64"),m=s("./compressions"),_=s("./compressedObject"),l=s("./nodeBuffer"),h=s("./utf8"),y=s("./stringWriter"),v=s("./uint8ArrayWriter"),T=function(S){if(S._data instanceof _&&(S._data=S._data.getContent(),S.options.binary=!0,S.options.base64=!1,i.getTypeOf(S._data)==="uint8array")){var A=S._data;S._data=new Uint8Array(A.length),A.length!==0&&S._data.set(A,0)}return S._data},R=function(S){var A=T(S),I=i.getTypeOf(A);return I==="string"?!S.options.binary&&n.nodebuffer?l(A,"utf-8"):S.asBinary():A},P=function(S){var A=T(this);return A===null||typeof A>"u"?"":(this.options.base64&&(A=f.decode(A)),A=S&&this.options.binary?re.utf8decode(A):i.transformTo("string",A),S||this.options.binary||(A=i.transformTo("string",re.utf8encode(A))),A)},U=function(S,A,I){this.name=S,this.dir=I.dir,this.date=I.date,this.comment=I.comment,this.unixPermissions=I.unixPermissions,this.dosPermissions=I.dosPermissions,this._data=A,this.options=I,this._initialMetadata={dir:I.dir,date:I.date}};U.prototype={asText:function(){return P.call(this,!0)},asBinary:function(){return P.call(this,!1)},asNodeBuffer:function(){var S=R(this);return i.transformTo("nodebuffer",S)},asUint8Array:function(){var S=R(this);return i.transformTo("uint8array",S)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var O=function(S,A){var I,Z="";for(I=0;I<A;I++)Z+=String.fromCharCode(255&S),S>>>=8;return Z},W=function(S){return S=S||{},S.base64!==!0||S.binary!==null&&S.binary!==void 0||(S.binary=!0),S=i.extend(S,u),S.date=S.date||new Date,S.compression!==null&&(S.compression=S.compression.toUpperCase()),S},J=function(S,A,I){var Z,j=i.getTypeOf(A);if(I=W(I),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(S=V(S)),I.createFolders&&(Z=L(S))&&$.call(this,Z,!0),I.dir||A===null||typeof A>"u")I.base64=!1,I.binary=!1,A=null,j=null;else if(j==="string")I.binary&&!I.base64&&I.optimizedBinaryString!==!0&&(A=i.string2binary(A));else{if(I.base64=!1,I.binary=!0,!(j||A instanceof _))throw new Error("The data of '"+S+"' is in an unsupported format !");j==="arraybuffer"&&(A=i.transformTo("uint8array",A))}var q=new U(S,A,I);return this.files[S]=q,q},L=function(S){S.slice(-1)=="/"&&(S=S.substring(0,S.length-1));var A=S.lastIndexOf("/");return A>0?S.substring(0,A):""},V=function(S){return S.slice(-1)!="/"&&(S+="/"),S},$=function(S,A){return A=typeof A<"u"&&A,S=V(S),this.files[S]||J.call(this,S,null,{dir:!0,createFolders:A}),this.files[S]},D=function(S,A,I){var Z,j=new _;return S._data instanceof _?(j.uncompressedSize=S._data.uncompressedSize,j.crc32=S._data.crc32,j.uncompressedSize===0||S.dir?(A=m.STORE,j.compressedContent="",j.crc32=0):S._data.compressionMethod===A.magic?j.compressedContent=S._data.getCompressedContent():(Z=S._data.getContent(),j.compressedContent=A.compress(i.transformTo(A.compressInputType,Z),I))):(Z=R(S),Z&&Z.length!==0&&!S.dir||(A=m.STORE,Z=""),j.uncompressedSize=Z.length,j.crc32=o(Z),j.compressedContent=A.compress(i.transformTo(A.compressInputType,Z),I)),j.compressedSize=j.compressedContent.length,j.compressionMethod=A.magic,j},ee=function(S,A){var I=S;return S||(I=A?16893:33204),(65535&I)<<16},we=function(S,A){return 63&(S||0)},ne=function(S,A,I,Z,j,q){var pe,_e,oe,me,ge=(I.compressedContent,q!==h.utf8encode),Ee=i.transformTo("string",q(A.name)),ue=i.transformTo("string",h.utf8encode(A.name)),be=A.comment||"",fe=i.transformTo("string",q(be)),xe=i.transformTo("string",h.utf8encode(be)),ve=ue.length!==A.name.length,Ce=xe.length!==be.length,Se=A.options,ze="",qe="",Ye="";oe=A._initialMetadata.dir!==A.dir?A.dir:Se.dir,me=A._initialMetadata.date!==A.date?A.date:Se.date;var Me=0,Ve=0;oe&&(Me|=16),j==="UNIX"?(Ve=798,Me|=ee(A.unixPermissions,oe)):(Ve=20,Me|=we(A.dosPermissions)),pe=me.getHours(),pe<<=6,pe|=me.getMinutes(),pe<<=5,pe|=me.getSeconds()/2,_e=me.getFullYear()-1980,_e<<=4,_e|=me.getMonth()+1,_e<<=5,_e|=me.getDate(),ve&&(qe=O(1,1)+O(o(Ee),4)+ue,ze+="up"+O(qe.length,2)+qe),Ce&&(Ye=O(1,1)+O(this.crc32(fe),4)+xe,ze+="uc"+O(Ye.length,2)+Ye);var Ae="";Ae+=`
\0`,Ae+=ge||!ve&&!Ce?"\0\0":"\0\b",Ae+=I.compressionMethod,Ae+=O(pe,2),Ae+=O(_e,2),Ae+=O(I.crc32,4),Ae+=O(I.compressedSize,4),Ae+=O(I.uncompressedSize,4),Ae+=O(Ee.length,2),Ae+=O(ze.length,2);var et=d.LOCAL_FILE_HEADER+Ae+Ee+ze,Ke=d.CENTRAL_FILE_HEADER+O(Ve,2)+Ae+O(fe.length,2)+"\0\0\0\0"+O(Me,4)+O(Z,4)+Ee+ze+fe;return{fileRecord:et,dirRecord:Ke,compressedObject:I}},re={load:function(S,A){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(S){var A,I,Z,j,q=[];for(A in this.files)this.files.hasOwnProperty(A)&&(Z=this.files[A],j=new U(Z.name,Z._data,i.extend(Z.options)),I=A.slice(this.root.length,A.length),A.slice(0,this.root.length)===this.root&&S(I,j)&&q.push(j));return q},file:function(S,A,I){if(arguments.length===1){if(i.isRegExp(S)){var Z=S;return this.filter(function(j,q){return!q.dir&&Z.test(j)})}return this.filter(function(j,q){return!q.dir&&j===S})[0]||null}return S=this.root+S,J.call(this,S,A,I),this},folder:function(S){if(!S)return this;if(i.isRegExp(S))return this.filter(function(j,q){return q.dir&&S.test(j)});var A=this.root+S,I=$.call(this,A),Z=this.clone();return Z.root=I.name,Z},remove:function(S){S=this.root+S;var A=this.files[S];if(A||(S.slice(-1)!="/"&&(S+="/"),A=this.files[S]),A&&!A.dir)delete this.files[S];else for(var I=this.filter(function(j,q){return q.name.slice(0,S.length)===S}),Z=0;Z<I.length;Z++)delete this.files[I[Z].name];return this},generate:function(S){S=i.extend(S||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode}),i.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var A,I,Z=[],j=0,q=0,pe=i.transformTo("string",S.encodeFileName(S.comment||this.comment||""));for(var _e in this.files)if(this.files.hasOwnProperty(_e)){var oe=this.files[_e],me=oe.options.compression||S.compression.toUpperCase(),ge=m[me];if(!ge)throw new Error(me+" is not a valid compression method !");var Ee=oe.options.compressionOptions||S.compressionOptions||{},ue=D.call(this,oe,ge,Ee),be=ne.call(this,_e,oe,ue,j,S.platform,S.encodeFileName);j+=be.fileRecord.length+ue.compressedSize,q+=be.dirRecord.length,Z.push(be)}var fe="";fe=d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+O(Z.length,2)+O(Z.length,2)+O(q,4)+O(j,4)+O(pe.length,2)+pe;var xe=S.type.toLowerCase();for(A=xe==="uint8array"||xe==="arraybuffer"||xe==="blob"||xe==="nodebuffer"?new v(j+q+fe.length):new y(j+q+fe.length),I=0;I<Z.length;I++)A.append(Z[I].fileRecord),A.append(Z[I].compressedObject.compressedContent);for(I=0;I<Z.length;I++)A.append(Z[I].dirRecord);A.append(fe);var ve=A.finalize();switch(S.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return i.transformTo(S.type.toLowerCase(),ve);case"blob":return i.arrayBuffer2Blob(i.transformTo("arraybuffer",ve),S.mimeType);case"base64":return S.base64?f.encode(ve):ve;default:return ve}},crc32:function(S,A){return o(S,A)},utf8encode:function(S){return i.transformTo("string",h.utf8encode(S))},utf8decode:function(S){return h.utf8decode(S)}};e.exports=re},{"./base64":2,"./compressedObject":3,"./compressions":4,"./crc32":5,"./defaults":7,"./nodeBuffer":12,"./signature":15,"./stringWriter":17,"./support":18,"./uint8ArrayWriter":20,"./utf8":21,"./utils":22}],15:[function(s,e,t){t.LOCAL_FILE_HEADER="PK",t.CENTRAL_FILE_HEADER="PK",t.CENTRAL_DIRECTORY_END="PK",t.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",t.ZIP64_CENTRAL_DIRECTORY_END="PK",t.DATA_DESCRIPTOR="PK\x07\b"},{}],16:[function(s,e,t){function n(d,u){this.data=d,u||(this.data=o.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}var i=s("./dataReader"),o=s("./utils");n.prototype=new i,n.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},n.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},n.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},e.exports=n},{"./dataReader":6,"./utils":22}],17:[function(s,e,t){var n=s("./utils"),i=function(){this.data=[]};i.prototype={append:function(o){o=n.transformTo("string",o),this.data.push(o)},finalize:function(){return this.data.join("")}},e.exports=i},{"./utils":22}],18:[function(s,e,t){(function(n){if(t.base64=!0,t.array=!0,t.string=!0,t.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",t.nodebuffer=typeof n<"u",t.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")t.blob=!1;else{var i=new ArrayBuffer(0);try{t.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,d=new o;d.append(i),t.blob=d.getBlob("application/zip").size===0}catch{t.blob=!1}}}}).call(this,typeof Buffer<"u"?Buffer:void 0)},{}],19:[function(s,e,t){function n(o){o&&(this.data=o,this.length=this.data.length,this.index=0,this.zero=0)}var i=s("./arrayReader");n.prototype=new i,n.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,d},e.exports=n},{"./arrayReader":1}],20:[function(s,e,t){var n=s("./utils"),i=function(o){this.data=new Uint8Array(o),this.index=0};i.prototype={append:function(o){o.length!==0&&(o=n.transformTo("uint8array",o),this.data.set(o,this.index),this.index+=o.length)},finalize:function(){return this.data}},e.exports=i},{"./utils":22}],21:[function(s,e,t){for(var n=s("./utils"),i=s("./support"),o=s("./nodeBuffer"),d=new Array(256),u=0;u<256;u++)d[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;d[254]=d[254]=1;var f=function(l){var h,y,v,T,R,P=l.length,U=0;for(T=0;T<P;T++)y=l.charCodeAt(T),(64512&y)===55296&&T+1<P&&(v=l.charCodeAt(T+1),(64512&v)===56320&&(y=65536+(y-55296<<10)+(v-56320),T++)),U+=y<128?1:y<2048?2:y<65536?3:4;for(h=i.uint8array?new Uint8Array(U):new Array(U),R=0,T=0;R<U;T++)y=l.charCodeAt(T),(64512&y)===55296&&T+1<P&&(v=l.charCodeAt(T+1),(64512&v)===56320&&(y=65536+(y-55296<<10)+(v-56320),T++)),y<128?h[R++]=y:y<2048?(h[R++]=192|y>>>6,h[R++]=128|63&y):y<65536?(h[R++]=224|y>>>12,h[R++]=128|y>>>6&63,h[R++]=128|63&y):(h[R++]=240|y>>>18,h[R++]=128|y>>>12&63,h[R++]=128|y>>>6&63,h[R++]=128|63&y);return h},m=function(l,h){var y;for(h=h||l.length,h>l.length&&(h=l.length),y=h-1;y>=0&&(192&l[y])===128;)y--;return y<0||y===0?h:y+d[l[y]]>h?y:h},_=function(l){var h,y,v,T,R=l.length,P=new Array(2*R);for(y=0,h=0;h<R;)if(v=l[h++],v<128)P[y++]=v;else if(T=d[v],T>4)P[y++]=65533,h+=T-1;else{for(v&=T===2?31:T===3?15:7;T>1&&h<R;)v=v<<6|63&l[h++],T--;T>1?P[y++]=65533:v<65536?P[y++]=v:(v-=65536,P[y++]=55296|v>>10&1023,P[y++]=56320|1023&v)}return P.length!==y&&(P.subarray?P=P.subarray(0,y):P.length=y),n.applyFromCharCode(P)};t.utf8encode=function(l){return i.nodebuffer?o(l,"utf-8"):f(l)},t.utf8decode=function(l){if(i.nodebuffer)return n.transformTo("nodebuffer",l).toString("utf-8");l=n.transformTo(i.uint8array?"uint8array":"array",l);for(var h=[],y=0,v=l.length,T=65536;y<v;){var R=m(l,Math.min(y+T,v));i.uint8array?h.push(_(l.subarray(y,R))):h.push(_(l.slice(y,R))),y=R}return h.join("")}},{"./nodeBuffer":12,"./support":18,"./utils":22}],22:[function(s,e,t){function n(l){return l}function i(l,h){for(var y=0;y<l.length;++y)h[y]=255&l.charCodeAt(y);return h}function o(l){var h=65536,y=[],v=l.length,T=t.getTypeOf(l),R=0,P=!0;try{switch(T){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,m(0))}}catch{P=!1}if(!P){for(var U="",O=0;O<l.length;O++)U+=String.fromCharCode(l[O]);return U}for(;R<v&&h>1;)try{T==="array"||T==="nodebuffer"?y.push(String.fromCharCode.apply(null,l.slice(R,Math.min(R+h,v)))):y.push(String.fromCharCode.apply(null,l.subarray(R,Math.min(R+h,v)))),R+=h}catch{h=Math.floor(h/2)}return y.join("")}function d(l,h){for(var y=0;y<l.length;y++)h[y]=l[y];return h}var u=s("./support"),f=s("./compressions"),m=s("./nodeBuffer");t.string2binary=function(l){for(var h="",y=0;y<l.length;y++)h+=String.fromCharCode(255&l.charCodeAt(y));return h},t.arrayBuffer2Blob=function(l,h){t.checkSupport("blob"),h=h||"application/zip";try{return new Blob([l],{type:h})}catch{try{var y=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,v=new y;return v.append(l),v.getBlob(h)}catch{throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=o;var _={};_.string={string:n,array:function(l){return i(l,new Array(l.length))},arraybuffer:function(l){return _.string.uint8array(l).buffer},uint8array:function(l){return i(l,new Uint8Array(l.length))},nodebuffer:function(l){return i(l,m(l.length))}},_.array={string:o,array:n,arraybuffer:function(l){return new Uint8Array(l).buffer},uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return m(l)}},_.arraybuffer={string:function(l){return o(new Uint8Array(l))},array:function(l){return d(new Uint8Array(l),new Array(l.byteLength))},arraybuffer:n,uint8array:function(l){return new Uint8Array(l)},nodebuffer:function(l){return m(new Uint8Array(l))}},_.uint8array={string:o,array:function(l){return d(l,new Array(l.length))},arraybuffer:function(l){return l.buffer},uint8array:n,nodebuffer:function(l){return m(l)}},_.nodebuffer={string:o,array:function(l){return d(l,new Array(l.length))},arraybuffer:function(l){return _.nodebuffer.uint8array(l).buffer},uint8array:function(l){return d(l,new Uint8Array(l.length))},nodebuffer:n},t.transformTo=function(l,h){if(h||(h=""),!l)return h;t.checkSupport(l);var y=t.getTypeOf(h),v=_[y][l](h);return v},t.getTypeOf=function(l){return typeof l=="string"?"string":Object.prototype.toString.call(l)==="[object Array]"?"array":u.nodebuffer&&m.test(l)?"nodebuffer":u.uint8array&&l instanceof Uint8Array?"uint8array":u.arraybuffer&&l instanceof ArrayBuffer?"arraybuffer":void 0},t.checkSupport=function(l){var h=u[l.toLowerCase()];if(!h)throw new Error(l+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(l){var h,y,v="";for(y=0;y<(l||"").length;y++)h=l.charCodeAt(y),v+="\\x"+(h<16?"0":"")+h.toString(16).toUpperCase();return v},t.findCompression=function(l){for(var h in f)if(f.hasOwnProperty(h)&&f[h].magic===l)return f[h];return null},t.isRegExp=function(l){return Object.prototype.toString.call(l)==="[object RegExp]"},t.extend=function(){var l,h,y={};for(l=0;l<arguments.length;l++)for(h in arguments[l])arguments[l].hasOwnProperty(h)&&typeof y[h]>"u"&&(y[h]=arguments[l][h]);return y}},{"./compressions":4,"./nodeBuffer":12,"./support":18}],23:[function(s,e,t){function n(h,y){this.files=[],this.loadOptions=y,h&&this.load(h)}var i=s("./stringReader"),o=s("./nodeBufferReader"),d=s("./uint8ArrayReader"),u=s("./arrayReader"),f=s("./utils"),m=s("./signature"),_=s("./zipEntry"),l=s("./support");s("./object"),n.prototype={checkSignature:function(h){var y=this.reader.readString(4);if(y!==h)throw new Error("Corrupted zip or bug : unexpected signature ("+f.pretty(y)+", expected "+f.pretty(h)+")")},isSignature:function(h,y){var v=this.reader.index;this.reader.setIndex(h);var T=this.reader.readString(4),R=T===y;return this.reader.setIndex(v),R},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),y=l.uint8array?"uint8array":"array",v=f.transformTo(y,h);this.zipComment=this.loadOptions.decodeFileName(v)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,y,v,T=this.zip64EndOfCentralSize-44,R=0;R<T;)h=this.reader.readInt(2),y=this.reader.readInt(4),v=this.reader.readString(y),this.zip64ExtensibleData[h]={id:h,length:y,value:v}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,y;for(h=0;h<this.files.length;h++)y=this.files[h],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(m.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===m.CENTRAL_FILE_HEADER;)h=new _({zip64:this.zip64},this.loadOptions),h.readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(m.CENTRAL_DIRECTORY_END);if(h<0){var y=!this.isSignature(0,m.LOCAL_FILE_HEADER);throw y?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory")}this.reader.setIndex(h);var v=h;if(this.checkSignature(m.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===f.MAX_VALUE_16BITS||this.diskWithCentralDirStart===f.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===f.MAX_VALUE_16BITS||this.centralDirRecords===f.MAX_VALUE_16BITS||this.centralDirSize===f.MAX_VALUE_32BITS||this.centralDirOffset===f.MAX_VALUE_32BITS){if(this.zip64=!0,h=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),h<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,m.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(m.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var T=this.centralDirOffset+this.centralDirSize;this.zip64&&(T+=20,T+=12+this.zip64EndOfCentralSize);var R=v-T;if(R>0)this.isSignature(v,m.CENTRAL_FILE_HEADER)||(this.reader.zero=R);else if(R<0)throw new Error("Corrupted zip: missing "+Math.abs(R)+" bytes.")},prepareReader:function(h){var y=f.getTypeOf(h);if(f.checkSupport(y),y!=="string"||l.uint8array)if(y==="nodebuffer")this.reader=new o(h);else if(l.uint8array)this.reader=new d(f.transformTo("uint8array",h));else{if(!l.array)throw new Error("Unexpected error: unsupported type '"+y+"'");this.reader=new u(f.transformTo("array",h))}else this.reader=new i(h,this.loadOptions.optimizedBinaryString)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=n},{"./arrayReader":1,"./nodeBufferReader":13,"./object":14,"./signature":15,"./stringReader":16,"./support":18,"./uint8ArrayReader":19,"./utils":22,"./zipEntry":24}],24:[function(s,e,t){function n(l,h){this.options=l,this.loadOptions=h}var i=s("./stringReader"),o=s("./utils"),d=s("./compressedObject"),u=s("./object"),f=s("./support"),m=0,_=3;n.prototype={isEncrypted:function(){return(1&this.bitFlag)===1},useUTF8:function(){return(2048&this.bitFlag)===2048},prepareCompressedContent:function(l,h,y){return function(){var v=l.index;l.setIndex(h);var T=l.readData(y);return l.setIndex(v),T}},prepareContent:function(l,h,y,v,T){return function(){var R=o.transformTo(v.uncompressInputType,this.getCompressedContent()),P=v.uncompress(R);if(P.length!==T)throw new Error("Bug : uncompressed data size mismatch");return P}},readLocalPart:function(l){var h,y;if(l.skip(22),this.fileNameLength=l.readInt(2),y=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(y),this.compressedSize==-1||this.uncompressedSize==-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(h=o.findCompression(this.compressionMethod),h===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");if(this.decompressed=new d,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(l,l.index,this.compressedSize,h),this.decompressed.getContent=this.prepareContent(l,l.index,this.compressedSize,h,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=o.transformTo("string",this.decompressed.getContent()),u.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(l){if(this.versionMadeBy=l.readInt(2),this.versionNeeded=l.readInt(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4),this.fileNameLength=l.readInt(2),this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=l.readData(this.fileNameLength),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l===m&&(this.dosPermissions=63&this.externalFileAttributes),l===_&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(l){if(this.extraFields[1]){var h=new i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(l){var h,y,v,T=l.index;for(this.extraFields=this.extraFields||{};l.index<T+this.extraFieldsLength;)h=l.readInt(2),y=l.readInt(2),v=l.readString(y),this.extraFields[h]={id:h,length:y,value:v}},handleUTF8:function(){var l=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var h=this.findExtraFieldUnicodePath();if(h!==null)this.fileNameStr=h;else{var y=o.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var T=o.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var h=new i(l.value);return h.readInt(1)!==1||u.crc32(this.fileName)!==h.readInt(4)?null:u.utf8decode(h.readString(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var h=new i(l.value);return h.readInt(1)!==1||u.crc32(this.fileComment)!==h.readInt(4)?null:u.utf8decode(h.readString(l.length-5))}return null}},e.exports=n},{"./compressedObject":3,"./object":14,"./stringReader":16,"./support":18,"./utils":22}],25:[function(s,e,t){var n=s("./lib/utils/common").assign,i=s("./lib/deflate"),o=s("./lib/inflate"),d=s("./lib/zlib/constants"),u={};n(u,i,o,d),e.exports=u},{"./lib/deflate":26,"./lib/inflate":27,"./lib/utils/common":28,"./lib/zlib/constants":31}],26:[function(s,e,t){function n(J){if(!(this instanceof n))return new n(J);this.options=f.assign({level:U,method:W,chunkSize:16384,windowBits:15,memLevel:8,strategy:O,to:""},J||{});var L=this.options;L.raw&&L.windowBits>0?L.windowBits=-L.windowBits:L.gzip&&L.windowBits>0&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var V=u.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(V!==T)throw new Error(_[V]);if(L.header&&u.deflateSetHeader(this.strm,L.header),L.dictionary){var $;if($=typeof L.dictionary=="string"?m.string2buf(L.dictionary):h.call(L.dictionary)==="[object ArrayBuffer]"?new Uint8Array(L.dictionary):L.dictionary,V=u.deflateSetDictionary(this.strm,$),V!==T)throw new Error(_[V]);this._dict_set=!0}}function i(J,L){var V=new n(L);if(V.push(J,!0),V.err)throw V.msg;return V.result}function o(J,L){return L=L||{},L.raw=!0,i(J,L)}function d(J,L){return L=L||{},L.gzip=!0,i(J,L)}var u=s("./zlib/deflate"),f=s("./utils/common"),m=s("./utils/strings"),_=s("./zlib/messages"),l=s("./zlib/zstream"),h=Object.prototype.toString,y=0,v=4,T=0,R=1,P=2,U=-1,O=0,W=8;n.prototype.push=function(J,L){var V,$,D=this.strm,ee=this.options.chunkSize;if(this.ended)return!1;$=L===~~L?L:L===!0?v:y,typeof J=="string"?D.input=m.string2buf(J):h.call(J)==="[object ArrayBuffer]"?D.input=new Uint8Array(J):D.input=J,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new f.Buf8(ee),D.next_out=0,D.avail_out=ee),V=u.deflate(D,$),V!==R&&V!==T)return this.onEnd(V),this.ended=!0,!1;D.avail_out!==0&&(D.avail_in!==0||$!==v&&$!==P)||(this.options.to==="string"?this.onData(m.buf2binstring(f.shrinkBuf(D.output,D.next_out))):this.onData(f.shrinkBuf(D.output,D.next_out)))}while((D.avail_in>0||D.avail_out===0)&&V!==R);return $===v?(V=u.deflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===T):$!==P||(this.onEnd(T),D.avail_out=0,!0)},n.prototype.onData=function(J){this.chunks.push(J)},n.prototype.onEnd=function(J){J===T&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=f.flattenChunks(this.chunks)),this.chunks=[],this.err=J,this.msg=this.strm.msg},t.Deflate=n,t.deflate=i,t.deflateRaw=o,t.gzip=d},{"./utils/common":28,"./utils/strings":29,"./zlib/deflate":33,"./zlib/messages":38,"./zlib/zstream":40}],27:[function(s,e,t){function n(v){if(!(this instanceof n))return new n(v);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},v||{});var T=this.options;T.raw&&T.windowBits>=0&&T.windowBits<16&&(T.windowBits=-T.windowBits,T.windowBits===0&&(T.windowBits=-15)),!(T.windowBits>=0&&T.windowBits<16)||v&&v.windowBits||(T.windowBits+=32),T.windowBits>15&&T.windowBits<48&&!(15&T.windowBits)&&(T.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var R=d.inflateInit2(this.strm,T.windowBits);if(R!==m.Z_OK)throw new Error(_[R]);this.header=new h,d.inflateGetHeader(this.strm,this.header)}function i(v,T){var R=new n(T);if(R.push(v,!0),R.err)throw R.msg;return R.result}function o(v,T){return T=T||{},T.raw=!0,i(v,T)}var d=s("./zlib/inflate"),u=s("./utils/common"),f=s("./utils/strings"),m=s("./zlib/constants"),_=s("./zlib/messages"),l=s("./zlib/zstream"),h=s("./zlib/gzheader"),y=Object.prototype.toString;n.prototype.push=function(v,T){var R,P,U,O,W,J,L=this.strm,V=this.options.chunkSize,$=this.options.dictionary,D=!1;if(this.ended)return!1;P=T===~~T?T:T===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof v=="string"?L.input=f.binstring2buf(v):y.call(v)==="[object ArrayBuffer]"?L.input=new Uint8Array(v):L.input=v,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new u.Buf8(V),L.next_out=0,L.avail_out=V),R=d.inflate(L,m.Z_NO_FLUSH),R===m.Z_NEED_DICT&&$&&(J=typeof $=="string"?f.string2buf($):y.call($)==="[object ArrayBuffer]"?new Uint8Array($):$,R=d.inflateSetDictionary(this.strm,J)),R===m.Z_BUF_ERROR&&D===!0&&(R=m.Z_OK,D=!1),R!==m.Z_STREAM_END&&R!==m.Z_OK)return this.onEnd(R),this.ended=!0,!1;L.next_out&&(L.avail_out!==0&&R!==m.Z_STREAM_END&&(L.avail_in!==0||P!==m.Z_FINISH&&P!==m.Z_SYNC_FLUSH)||(this.options.to==="string"?(U=f.utf8border(L.output,L.next_out),O=L.next_out-U,W=f.buf2string(L.output,U),L.next_out=O,L.avail_out=V-O,O&&u.arraySet(L.output,L.output,U,O,0),this.onData(W)):this.onData(u.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(D=!0)}while((L.avail_in>0||L.avail_out===0)&&R!==m.Z_STREAM_END);return R===m.Z_STREAM_END&&(P=m.Z_FINISH),P===m.Z_FINISH?(R=d.inflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===m.Z_OK):P!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),L.avail_out=0,!0)},n.prototype.onData=function(v){this.chunks.push(v)},n.prototype.onEnd=function(v){v===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},t.Inflate=n,t.inflate=i,t.inflateRaw=o,t.ungzip=i},{"./utils/common":28,"./utils/strings":29,"./zlib/constants":31,"./zlib/gzheader":34,"./zlib/inflate":36,"./zlib/messages":38,"./zlib/zstream":40}],28:[function(s,e,t){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";t.assign=function(d){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var f=u.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var m in f)f.hasOwnProperty(m)&&(d[m]=f[m])}}return d},t.shrinkBuf=function(d,u){return d.length===u?d:d.subarray?d.subarray(0,u):(d.length=u,d)};var i={arraySet:function(d,u,f,m,_){if(u.subarray&&d.subarray)return void d.set(u.subarray(f,f+m),_);for(var l=0;l<m;l++)d[_+l]=u[f+l]},flattenChunks:function(d){var u,f,m,_,l,h;for(m=0,u=0,f=d.length;u<f;u++)m+=d[u].length;for(h=new Uint8Array(m),_=0,u=0,f=d.length;u<f;u++)l=d[u],h.set(l,_),_+=l.length;return h}},o={arraySet:function(d,u,f,m,_){for(var l=0;l<m;l++)d[_+l]=u[f+l]},flattenChunks:function(d){return[].concat.apply([],d)}};t.setTyped=function(d){d?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,i)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},{}],29:[function(s,e,t){function n(m,_){if(_<65537&&(m.subarray&&d||!m.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(m,_));for(var l="",h=0;h<_;h++)l+=String.fromCharCode(m[h]);return l}var i=s("./common"),o=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var u=new i.Buf8(256),f=0;f<256;f++)u[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;u[254]=u[254]=1,t.string2buf=function(m){var _,l,h,y,v,T=m.length,R=0;for(y=0;y<T;y++)l=m.charCodeAt(y),(64512&l)===55296&&y+1<T&&(h=m.charCodeAt(y+1),(64512&h)===56320&&(l=65536+(l-55296<<10)+(h-56320),y++)),R+=l<128?1:l<2048?2:l<65536?3:4;for(_=new i.Buf8(R),v=0,y=0;v<R;y++)l=m.charCodeAt(y),(64512&l)===55296&&y+1<T&&(h=m.charCodeAt(y+1),(64512&h)===56320&&(l=65536+(l-55296<<10)+(h-56320),y++)),l<128?_[v++]=l:l<2048?(_[v++]=192|l>>>6,_[v++]=128|63&l):l<65536?(_[v++]=224|l>>>12,_[v++]=128|l>>>6&63,_[v++]=128|63&l):(_[v++]=240|l>>>18,_[v++]=128|l>>>12&63,_[v++]=128|l>>>6&63,_[v++]=128|63&l);return _},t.buf2binstring=function(m){return n(m,m.length)},t.binstring2buf=function(m){for(var _=new i.Buf8(m.length),l=0,h=_.length;l<h;l++)_[l]=m.charCodeAt(l);return _},t.buf2string=function(m,_){var l,h,y,v,T=_||m.length,R=new Array(2*T);for(h=0,l=0;l<T;)if(y=m[l++],y<128)R[h++]=y;else if(v=u[y],v>4)R[h++]=65533,l+=v-1;else{for(y&=v===2?31:v===3?15:7;v>1&&l<T;)y=y<<6|63&m[l++],v--;v>1?R[h++]=65533:y<65536?R[h++]=y:(y-=65536,R[h++]=55296|y>>10&1023,R[h++]=56320|1023&y)}return n(R,h)},t.utf8border=function(m,_){var l;for(_=_||m.length,_>m.length&&(_=m.length),l=_-1;l>=0&&(192&m[l])===128;)l--;return l<0||l===0?_:l+u[m[l]]>_?l:_}},{"./common":28}],30:[function(s,e,t){function n(i,o,d,u){for(var f=65535&i|0,m=i>>>16&65535|0,_=0;d!==0;){_=d>2e3?2e3:d,d-=_;do f=f+o[u++]|0,m=m+f|0;while(--_);f%=65521,m%=65521}return f|m<<16|0}e.exports=n},{}],31:[function(s,e,t){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],32:[function(s,e,t){function n(){for(var d,u=[],f=0;f<256;f++){d=f;for(var m=0;m<8;m++)d=1&d?3988292384^d>>>1:d>>>1;u[f]=d}return u}function i(d,u,f,m){var _=o,l=m+f;d^=-1;for(var h=m;h<l;h++)d=d>>>8^_[255&(d^u[h])];return d^-1}var o=n();e.exports=i},{}],33:[function(s,e,t){function n(r,k){return r.msg=j[k],k}function i(r){return(r<<1)-(r>4?9:0)}function o(r){for(var k=r.length;--k>=0;)r[k]=0}function d(r){var k=r.state,E=k.pending;E>r.avail_out&&(E=r.avail_out),E!==0&&(S.arraySet(r.output,k.pending_buf,k.pending_out,E,r.next_out),r.next_out+=E,k.pending_out+=E,r.total_out+=E,r.avail_out-=E,k.pending-=E,k.pending===0&&(k.pending_out=0))}function u(r,k){A._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,k),r.block_start=r.strstart,d(r.strm)}function f(r,k){r.pending_buf[r.pending++]=k}function m(r,k){r.pending_buf[r.pending++]=k>>>8&255,r.pending_buf[r.pending++]=255&k}function _(r,k,E,p){var w=r.avail_in;return w>p&&(w=p),w===0?0:(r.avail_in-=w,S.arraySet(k,r.input,r.next_in,w,E),r.state.wrap===1?r.adler=I(r.adler,k,w,E):r.state.wrap===2&&(r.adler=Z(r.adler,k,w,E)),r.next_in+=w,r.total_in+=w,w)}function l(r,k){var E,p,w=r.max_chain_length,x=r.strstart,H=r.prev_length,Y=r.nice_match,K=r.strstart>r.w_size-Le?r.strstart-(r.w_size-Le):0,ie=r.window,We=r.w_mask,de=r.prev,Re=r.strstart+Ue,Pe=ie[x+H-1],Fe=ie[x+H];r.prev_length>=r.good_match&&(w>>=2),Y>r.lookahead&&(Y=r.lookahead);do if(E=k,ie[E+H]===Fe&&ie[E+H-1]===Pe&&ie[E]===ie[x]&&ie[++E]===ie[x+1]){x+=2,E++;do;while(ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&ie[++x]===ie[++E]&&x<Re);if(p=Ue-(Re-x),x=Re-Ue,p>H){if(r.match_start=k,H=p,p>=Y)break;Pe=ie[x+H-1],Fe=ie[x+H]}}while((k=de[k&We])>K&&--w!==0);return H<=r.lookahead?H:r.lookahead}function h(r){var k,E,p,w,x,H=r.w_size;do{if(w=r.window_size-r.lookahead-r.strstart,r.strstart>=H+(H-Le)){S.arraySet(r.window,r.window,H,H,0),r.match_start-=H,r.strstart-=H,r.block_start-=H,E=r.hash_size,k=E;do p=r.head[--k],r.head[k]=p>=H?p-H:0;while(--E);E=H,k=E;do p=r.prev[--k],r.prev[k]=p>=H?p-H:0;while(--E);w+=H}if(r.strm.avail_in===0)break;if(E=_(r.strm,r.window,r.strstart+r.lookahead,w),r.lookahead+=E,r.lookahead+r.insert>=te)for(x=r.strstart-r.insert,r.ins_h=r.window[x],r.ins_h=(r.ins_h<<r.hash_shift^r.window[x+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[x+te-1])&r.hash_mask,r.prev[x&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=x,x++,r.insert--,!(r.lookahead+r.insert<te)););}while(r.lookahead<Le&&r.strm.avail_in!==0)}function y(r,k){var E=65535;for(E>r.pending_buf_size-5&&(E=r.pending_buf_size-5);;){if(r.lookahead<=1){if(h(r),r.lookahead===0&&k===q)return g;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var p=r.block_start+E;if((r.strstart===0||r.strstart>=p)&&(r.lookahead=r.strstart-p,r.strstart=p,u(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-Le&&(u(r,!1),r.strm.avail_out===0))return g}return r.insert=0,k===oe?(u(r,!0),r.strm.avail_out===0?a:F):(r.strstart>r.block_start&&(u(r,!1),r.strm.avail_out===0),g)}function v(r,k){for(var E,p;;){if(r.lookahead<Le){if(h(r),r.lookahead<Le&&k===q)return g;if(r.lookahead===0)break}if(E=0,r.lookahead>=te&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+te-1])&r.hash_mask,E=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),E!==0&&r.strstart-E<=r.w_size-Le&&(r.match_length=l(r,E)),r.match_length>=te)if(p=A._tr_tally(r,r.strstart-r.match_start,r.match_length-te),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=te){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+te-1])&r.hash_mask,E=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else p=A._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(p&&(u(r,!1),r.strm.avail_out===0))return g}return r.insert=r.strstart<te-1?r.strstart:te-1,k===oe?(u(r,!0),r.strm.avail_out===0?a:F):r.last_lit&&(u(r,!1),r.strm.avail_out===0)?g:b}function T(r,k){for(var E,p,w;;){if(r.lookahead<Le){if(h(r),r.lookahead<Le&&k===q)return g;if(r.lookahead===0)break}if(E=0,r.lookahead>=te&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+te-1])&r.hash_mask,E=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=te-1,E!==0&&r.prev_length<r.max_lazy_match&&r.strstart-E<=r.w_size-Le&&(r.match_length=l(r,E),r.match_length<=5&&(r.strategy===ve||r.match_length===te&&r.strstart-r.match_start>4096)&&(r.match_length=te-1)),r.prev_length>=te&&r.match_length<=r.prev_length){w=r.strstart+r.lookahead-te,p=A._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-te),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=w&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+te-1])&r.hash_mask,E=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=te-1,r.strstart++,p&&(u(r,!1),r.strm.avail_out===0))return g}else if(r.match_available){if(p=A._tr_tally(r,0,r.window[r.strstart-1]),p&&u(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return g}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(p=A._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<te-1?r.strstart:te-1,k===oe?(u(r,!0),r.strm.avail_out===0?a:F):r.last_lit&&(u(r,!1),r.strm.avail_out===0)?g:b}function R(r,k){for(var E,p,w,x,H=r.window;;){if(r.lookahead<=Ue){if(h(r),r.lookahead<=Ue&&k===q)return g;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=te&&r.strstart>0&&(w=r.strstart-1,p=H[w],p===H[++w]&&p===H[++w]&&p===H[++w])){x=r.strstart+Ue;do;while(p===H[++w]&&p===H[++w]&&p===H[++w]&&p===H[++w]&&p===H[++w]&&p===H[++w]&&p===H[++w]&&p===H[++w]&&w<x);r.match_length=Ue-(x-w),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=te?(E=A._tr_tally(r,1,r.match_length-te),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(E=A._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),E&&(u(r,!1),r.strm.avail_out===0))return g}return r.insert=0,k===oe?(u(r,!0),r.strm.avail_out===0?a:F):r.last_lit&&(u(r,!1),r.strm.avail_out===0)?g:b}function P(r,k){for(var E;;){if(r.lookahead===0&&(h(r),r.lookahead===0)){if(k===q)return g;break}if(r.match_length=0,E=A._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,E&&(u(r,!1),r.strm.avail_out===0))return g}return r.insert=0,k===oe?(u(r,!0),r.strm.avail_out===0?a:F):r.last_lit&&(u(r,!1),r.strm.avail_out===0)?g:b}function U(r,k,E,p,w){this.good_length=r,this.max_lazy=k,this.nice_length=E,this.max_chain=p,this.func=w}function O(r){r.window_size=2*r.w_size,o(r.head),r.max_lazy_match=re[r.level].max_lazy,r.good_match=re[r.level].good_length,r.nice_match=re[r.level].nice_length,r.max_chain_length=re[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=te-1,r.match_available=0,r.ins_h=0}function W(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Me,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new S.Buf16(2*tt),this.dyn_dtree=new S.Buf16(2*(2*wt+1)),this.bl_tree=new S.Buf16(2*(2*Be+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new S.Buf16(nt+1),this.heap=new S.Buf16(2*st+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new S.Buf16(2*st+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function J(r){var k;return r&&r.state?(r.total_in=r.total_out=0,r.data_type=Ye,k=r.state,k.pending=0,k.pending_out=0,k.wrap<0&&(k.wrap=-k.wrap),k.status=k.wrap?je:M,r.adler=k.wrap===2?0:1,k.last_flush=q,A._tr_init(k),ge):n(r,ue)}function L(r){var k=J(r);return k===ge&&O(r.state),k}function V(r,k){return r&&r.state?r.state.wrap!==2?ue:(r.state.gzhead=k,ge):ue}function $(r,k,E,p,w,x){if(!r)return ue;var H=1;if(k===xe&&(k=6),p<0?(H=0,p=-p):p>15&&(H=2,p-=16),w<1||w>Ve||E!==Me||p<8||p>15||k<0||k>9||x<0||x>ze)return n(r,ue);p===8&&(p=9);var Y=new W;return r.state=Y,Y.strm=r,Y.wrap=H,Y.gzhead=null,Y.w_bits=p,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=w+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+te-1)/te),Y.window=new S.Buf8(2*Y.w_size),Y.head=new S.Buf16(Y.hash_size),Y.prev=new S.Buf16(Y.w_size),Y.lit_bufsize=1<<w+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new S.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=k,Y.strategy=x,Y.method=E,L(r)}function D(r,k){return $(r,k,Me,Ae,et,qe)}function ee(r,k){var E,p,w,x;if(!r||!r.state||k>me||k<0)return r?n(r,ue):ue;if(p=r.state,!r.output||!r.input&&r.avail_in!==0||p.status===B&&k!==oe)return n(r,r.avail_out===0?fe:ue);if(p.strm=r,E=p.last_flush,p.last_flush=k,p.status===je)if(p.wrap===2)r.adler=0,f(p,31),f(p,139),f(p,8),p.gzhead?(f(p,(p.gzhead.text?1:0)+(p.gzhead.hcrc?2:0)+(p.gzhead.extra?4:0)+(p.gzhead.name?8:0)+(p.gzhead.comment?16:0)),f(p,255&p.gzhead.time),f(p,p.gzhead.time>>8&255),f(p,p.gzhead.time>>16&255),f(p,p.gzhead.time>>24&255),f(p,p.level===9?2:p.strategy>=Ce||p.level<2?4:0),f(p,255&p.gzhead.os),p.gzhead.extra&&p.gzhead.extra.length&&(f(p,255&p.gzhead.extra.length),f(p,p.gzhead.extra.length>>8&255)),p.gzhead.hcrc&&(r.adler=Z(r.adler,p.pending_buf,p.pending,0)),p.gzindex=0,p.status=ut):(f(p,0),f(p,0),f(p,0),f(p,0),f(p,0),f(p,p.level===9?2:p.strategy>=Ce||p.level<2?4:0),f(p,Q),p.status=M);else{var H=Me+(p.w_bits-8<<4)<<8,Y=-1;Y=p.strategy>=Ce||p.level<2?0:p.level<6?1:p.level===6?2:3,H|=Y<<6,p.strstart!==0&&(H|=he),H+=31-H%31,p.status=M,m(p,H),p.strstart!==0&&(m(p,r.adler>>>16),m(p,65535&r.adler)),r.adler=1}if(p.status===ut)if(p.gzhead.extra){for(w=p.pending;p.gzindex<(65535&p.gzhead.extra.length)&&(p.pending!==p.pending_buf_size||(p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),d(r),w=p.pending,p.pending!==p.pending_buf_size));)f(p,255&p.gzhead.extra[p.gzindex]),p.gzindex++;p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),p.gzindex===p.gzhead.extra.length&&(p.gzindex=0,p.status=ot)}else p.status=ot;if(p.status===ot)if(p.gzhead.name){w=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),d(r),w=p.pending,p.pending===p.pending_buf_size)){x=1;break}x=p.gzindex<p.gzhead.name.length?255&p.gzhead.name.charCodeAt(p.gzindex++):0,f(p,x)}while(x!==0);p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),x===0&&(p.gzindex=0,p.status=c)}else p.status=c;if(p.status===c)if(p.gzhead.comment){w=p.pending;do{if(p.pending===p.pending_buf_size&&(p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),d(r),w=p.pending,p.pending===p.pending_buf_size)){x=1;break}x=p.gzindex<p.gzhead.comment.length?255&p.gzhead.comment.charCodeAt(p.gzindex++):0,f(p,x)}while(x!==0);p.gzhead.hcrc&&p.pending>w&&(r.adler=Z(r.adler,p.pending_buf,p.pending-w,w)),x===0&&(p.status=N)}else p.status=N;if(p.status===N&&(p.gzhead.hcrc?(p.pending+2>p.pending_buf_size&&d(r),p.pending+2<=p.pending_buf_size&&(f(p,255&r.adler),f(p,r.adler>>8&255),r.adler=0,p.status=M)):p.status=M),p.pending!==0){if(d(r),r.avail_out===0)return p.last_flush=-1,ge}else if(r.avail_in===0&&i(k)<=i(E)&&k!==oe)return n(r,fe);if(p.status===B&&r.avail_in!==0)return n(r,fe);if(r.avail_in!==0||p.lookahead!==0||k!==q&&p.status!==B){var K=p.strategy===Ce?P(p,k):p.strategy===Se?R(p,k):re[p.level].func(p,k);if(K!==a&&K!==F||(p.status=B),K===g||K===a)return r.avail_out===0&&(p.last_flush=-1),ge;if(K===b&&(k===pe?A._tr_align(p):k!==me&&(A._tr_stored_block(p,0,0,!1),k===_e&&(o(p.head),p.lookahead===0&&(p.strstart=0,p.block_start=0,p.insert=0))),d(r),r.avail_out===0))return p.last_flush=-1,ge}return k!==oe?ge:p.wrap<=0?Ee:(p.wrap===2?(f(p,255&r.adler),f(p,r.adler>>8&255),f(p,r.adler>>16&255),f(p,r.adler>>24&255),f(p,255&r.total_in),f(p,r.total_in>>8&255),f(p,r.total_in>>16&255),f(p,r.total_in>>24&255)):(m(p,r.adler>>>16),m(p,65535&r.adler)),d(r),p.wrap>0&&(p.wrap=-p.wrap),p.pending!==0?ge:Ee)}function we(r){var k;return r&&r.state?(k=r.state.status,k!==je&&k!==ut&&k!==ot&&k!==c&&k!==N&&k!==M&&k!==B?n(r,ue):(r.state=null,k===M?n(r,be):ge)):ue}function ne(r,k){var E,p,w,x,H,Y,K,ie,We=k.length;if(!r||!r.state||(E=r.state,x=E.wrap,x===2||x===1&&E.status!==je||E.lookahead))return ue;for(x===1&&(r.adler=I(r.adler,k,We,0)),E.wrap=0,We>=E.w_size&&(x===0&&(o(E.head),E.strstart=0,E.block_start=0,E.insert=0),ie=new S.Buf8(E.w_size),S.arraySet(ie,k,We-E.w_size,E.w_size,0),k=ie,We=E.w_size),H=r.avail_in,Y=r.next_in,K=r.input,r.avail_in=We,r.next_in=0,r.input=k,h(E);E.lookahead>=te;){p=E.strstart,w=E.lookahead-(te-1);do E.ins_h=(E.ins_h<<E.hash_shift^E.window[p+te-1])&E.hash_mask,E.prev[p&E.w_mask]=E.head[E.ins_h],E.head[E.ins_h]=p,p++;while(--w);E.strstart=p,E.lookahead=te-1,h(E)}return E.strstart+=E.lookahead,E.block_start=E.strstart,E.insert=E.lookahead,E.lookahead=0,E.match_length=E.prev_length=te-1,E.match_available=0,r.next_in=Y,r.input=K,r.avail_in=H,E.wrap=x,ge}var re,S=s("../utils/common"),A=s("./trees"),I=s("./adler32"),Z=s("./crc32"),j=s("./messages"),q=0,pe=1,_e=3,oe=4,me=5,ge=0,Ee=1,ue=-2,be=-3,fe=-5,xe=-1,ve=1,Ce=2,Se=3,ze=4,qe=0,Ye=2,Me=8,Ve=9,Ae=15,et=8,Ke=29,dt=256,st=dt+1+Ke,wt=30,Be=19,tt=2*st+1,nt=15,te=3,Ue=258,Le=Ue+te+1,he=32,je=42,ut=69,ot=73,c=91,N=103,M=113,B=666,g=1,b=2,a=3,F=4,Q=3;re=[new U(0,0,0,0,y),new U(4,4,8,4,v),new U(4,5,16,8,v),new U(4,6,32,32,v),new U(4,4,16,16,T),new U(8,16,32,32,T),new U(8,16,128,128,T),new U(8,32,128,256,T),new U(32,128,258,1024,T),new U(32,258,258,4096,T)],t.deflateInit=D,t.deflateInit2=$,t.deflateReset=L,t.deflateResetKeep=J,t.deflateSetHeader=V,t.deflate=ee,t.deflateEnd=we,t.deflateSetDictionary=ne,t.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./messages":38,"./trees":39}],34:[function(s,e,t){function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=n},{}],35:[function(s,e,t){var n=30,i=12;e.exports=function(o,d){var u,f,m,_,l,h,y,v,T,R,P,U,O,W,J,L,V,$,D,ee,we,ne,re,S,A;u=o.state,f=o.next_in,S=o.input,m=f+(o.avail_in-5),_=o.next_out,A=o.output,l=_-(d-o.avail_out),h=_+(o.avail_out-257),y=u.dmax,v=u.wsize,T=u.whave,R=u.wnext,P=u.window,U=u.hold,O=u.bits,W=u.lencode,J=u.distcode,L=(1<<u.lenbits)-1,V=(1<<u.distbits)-1;e:do{O<15&&(U+=S[f++]<<O,O+=8,U+=S[f++]<<O,O+=8),$=W[U&L];t:for(;;){if(D=$>>>24,U>>>=D,O-=D,D=$>>>16&255,D===0)A[_++]=65535&$;else{if(!(16&D)){if(!(64&D)){$=W[(65535&$)+(U&(1<<D)-1)];continue t}if(32&D){u.mode=i;break e}o.msg="invalid literal/length code",u.mode=n;break e}ee=65535&$,D&=15,D&&(O<D&&(U+=S[f++]<<O,O+=8),ee+=U&(1<<D)-1,U>>>=D,O-=D),O<15&&(U+=S[f++]<<O,O+=8,U+=S[f++]<<O,O+=8),$=J[U&V];n:for(;;){if(D=$>>>24,U>>>=D,O-=D,D=$>>>16&255,!(16&D)){if(!(64&D)){$=J[(65535&$)+(U&(1<<D)-1)];continue n}o.msg="invalid distance code",u.mode=n;break e}if(we=65535&$,D&=15,O<D&&(U+=S[f++]<<O,O+=8,O<D&&(U+=S[f++]<<O,O+=8)),we+=U&(1<<D)-1,we>y){o.msg="invalid distance too far back",u.mode=n;break e}if(U>>>=D,O-=D,D=_-l,we>D){if(D=we-D,D>T&&u.sane){o.msg="invalid distance too far back",u.mode=n;break e}if(ne=0,re=P,R===0){if(ne+=v-D,D<ee){ee-=D;do A[_++]=P[ne++];while(--D);ne=_-we,re=A}}else if(R<D){if(ne+=v+R-D,D-=R,D<ee){ee-=D;do A[_++]=P[ne++];while(--D);if(ne=0,R<ee){D=R,ee-=D;do A[_++]=P[ne++];while(--D);ne=_-we,re=A}}}else if(ne+=R-D,D<ee){ee-=D;do A[_++]=P[ne++];while(--D);ne=_-we,re=A}for(;ee>2;)A[_++]=re[ne++],A[_++]=re[ne++],A[_++]=re[ne++],ee-=3;ee&&(A[_++]=re[ne++],ee>1&&(A[_++]=re[ne++]))}else{ne=_-we;do A[_++]=A[ne++],A[_++]=A[ne++],A[_++]=A[ne++],ee-=3;while(ee>2);ee&&(A[_++]=A[ne++],ee>1&&(A[_++]=A[ne++]))}break}}break}}while(f<m&&_<h);ee=O>>3,f-=ee,O-=ee<<3,U&=(1<<O)-1,o.next_in=f,o.next_out=_,o.avail_in=f<m?5+(m-f):5-(f-m),o.avail_out=_<h?257+(h-_):257-(_-h),u.hold=U,u.bits=O}},{}],36:[function(s,e,t){function n(g){return(g>>>24&255)+(g>>>8&65280)+((65280&g)<<8)+((255&g)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new U.Buf16(320),this.work=new U.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(g){var b;return g&&g.state?(b=g.state,g.total_in=g.total_out=b.total=0,g.msg="",b.wrap&&(g.adler=1&b.wrap),b.mode=_e,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new U.Buf32(ot),b.distcode=b.distdyn=new U.Buf32(c),b.sane=1,b.back=-1,re):I}function d(g){var b;return g&&g.state?(b=g.state,b.wsize=0,b.whave=0,b.wnext=0,o(g)):I}function u(g,b){var a,F;return g&&g.state?(F=g.state,b<0?(a=0,b=-b):(a=(b>>4)+1,b<48&&(b&=15)),b&&(b<8||b>15)?I:(F.window!==null&&F.wbits!==b&&(F.window=null),F.wrap=a,F.wbits=b,d(g))):I}function f(g,b){var a,F;return g?(F=new i,g.state=F,F.window=null,a=u(g,b),a!==re&&(g.state=null),a):I}function m(g){return f(g,M)}function _(g){if(B){var b;for(R=new U.Buf32(512),P=new U.Buf32(32),b=0;b<144;)g.lens[b++]=8;for(;b<256;)g.lens[b++]=9;for(;b<280;)g.lens[b++]=7;for(;b<288;)g.lens[b++]=8;for(L($,g.lens,0,288,R,0,g.work,{bits:9}),b=0;b<32;)g.lens[b++]=5;L(D,g.lens,0,32,P,0,g.work,{bits:5}),B=!1}g.lencode=R,g.lenbits=9,g.distcode=P,g.distbits=5}function l(g,b,a,F){var Q,r=g.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new U.Buf8(r.wsize)),F>=r.wsize?(U.arraySet(r.window,b,a-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(Q=r.wsize-r.wnext,Q>F&&(Q=F),U.arraySet(r.window,b,a-F,Q,r.wnext),F-=Q,F?(U.arraySet(r.window,b,a-F,F,0),r.wnext=F,r.whave=r.wsize):(r.wnext+=Q,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=Q))),0}function h(g,b){var a,F,Q,r,k,E,p,w,x,H,Y,K,ie,We,de,Re,Pe,Fe,Dt,zt,Te,Xe,at,rt,ke=0,Oe=new U.Buf8(4),Rn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!g||!g.state||!g.output||!g.input&&g.avail_in!==0)return I;a=g.state,a.mode===Se&&(a.mode=ze),k=g.next_out,Q=g.output,p=g.avail_out,r=g.next_in,F=g.input,E=g.avail_in,w=a.hold,x=a.bits,H=E,Y=p,Xe=re;e:for(;;)switch(a.mode){case _e:if(a.wrap===0){a.mode=ze;break}for(;x<16;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(2&a.wrap&&w===35615){a.check=0,Oe[0]=255&w,Oe[1]=w>>>8&255,a.check=W(a.check,Oe,2,0),w=0,x=0,a.mode=oe;break}if(a.flags=0,a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&w)<<8)+(w>>8))%31){g.msg="incorrect header check",a.mode=he;break}if((15&w)!==pe){g.msg="unknown compression method",a.mode=he;break}if(w>>>=4,x-=4,Te=(15&w)+8,a.wbits===0)a.wbits=Te;else if(Te>a.wbits){g.msg="invalid window size",a.mode=he;break}a.dmax=1<<Te,g.adler=a.check=1,a.mode=512&w?ve:Se,w=0,x=0;break;case oe:for(;x<16;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(a.flags=w,(255&a.flags)!==pe){g.msg="unknown compression method",a.mode=he;break}if(57344&a.flags){g.msg="unknown header flags set",a.mode=he;break}a.head&&(a.head.text=w>>8&1),512&a.flags&&(Oe[0]=255&w,Oe[1]=w>>>8&255,a.check=W(a.check,Oe,2,0)),w=0,x=0,a.mode=me;case me:for(;x<32;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.head&&(a.head.time=w),512&a.flags&&(Oe[0]=255&w,Oe[1]=w>>>8&255,Oe[2]=w>>>16&255,Oe[3]=w>>>24&255,a.check=W(a.check,Oe,4,0)),w=0,x=0,a.mode=ge;case ge:for(;x<16;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.head&&(a.head.xflags=255&w,a.head.os=w>>8),512&a.flags&&(Oe[0]=255&w,Oe[1]=w>>>8&255,a.check=W(a.check,Oe,2,0)),w=0,x=0,a.mode=Ee;case Ee:if(1024&a.flags){for(;x<16;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.length=w,a.head&&(a.head.extra_len=w),512&a.flags&&(Oe[0]=255&w,Oe[1]=w>>>8&255,a.check=W(a.check,Oe,2,0)),w=0,x=0}else a.head&&(a.head.extra=null);a.mode=ue;case ue:if(1024&a.flags&&(K=a.length,K>E&&(K=E),K&&(a.head&&(Te=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Array(a.head.extra_len)),U.arraySet(a.head.extra,F,r,K,Te)),512&a.flags&&(a.check=W(a.check,F,K,r)),E-=K,r+=K,a.length-=K),a.length))break e;a.length=0,a.mode=be;case be:if(2048&a.flags){if(E===0)break e;K=0;do Te=F[r+K++],a.head&&Te&&a.length<65536&&(a.head.name+=String.fromCharCode(Te));while(Te&&K<E);if(512&a.flags&&(a.check=W(a.check,F,K,r)),E-=K,r+=K,Te)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=fe;case fe:if(4096&a.flags){if(E===0)break e;K=0;do Te=F[r+K++],a.head&&Te&&a.length<65536&&(a.head.comment+=String.fromCharCode(Te));while(Te&&K<E);if(512&a.flags&&(a.check=W(a.check,F,K,r)),E-=K,r+=K,Te)break e}else a.head&&(a.head.comment=null);a.mode=xe;case xe:if(512&a.flags){for(;x<16;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(w!==(65535&a.check)){g.msg="header crc mismatch",a.mode=he;break}w=0,x=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),g.adler=a.check=0,a.mode=Se;break;case ve:for(;x<32;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}g.adler=a.check=n(w),w=0,x=0,a.mode=Ce;case Ce:if(a.havedict===0)return g.next_out=k,g.avail_out=p,g.next_in=r,g.avail_in=E,a.hold=w,a.bits=x,A;g.adler=a.check=1,a.mode=Se;case Se:if(b===we||b===ne)break e;case ze:if(a.last){w>>>=7&x,x-=7&x,a.mode=te;break}for(;x<3;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}switch(a.last=1&w,w>>>=1,x-=1,3&w){case 0:a.mode=qe;break;case 1:if(_(a),a.mode=Ke,b===ne){w>>>=2,x-=2;break e}break;case 2:a.mode=Ve;break;case 3:g.msg="invalid block type",a.mode=he}w>>>=2,x-=2;break;case qe:for(w>>>=7&x,x-=7&x;x<32;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if((65535&w)!==(w>>>16^65535)){g.msg="invalid stored block lengths",a.mode=he;break}if(a.length=65535&w,w=0,x=0,a.mode=Ye,b===ne)break e;case Ye:a.mode=Me;case Me:if(K=a.length){if(K>E&&(K=E),K>p&&(K=p),K===0)break e;U.arraySet(Q,F,r,K,k),E-=K,r+=K,p-=K,k+=K,a.length-=K;break}a.mode=Se;break;case Ve:for(;x<14;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(a.nlen=(31&w)+257,w>>>=5,x-=5,a.ndist=(31&w)+1,w>>>=5,x-=5,a.ncode=(15&w)+4,w>>>=4,x-=4,a.nlen>286||a.ndist>30){g.msg="too many length or distance symbols",a.mode=he;break}a.have=0,a.mode=Ae;case Ae:for(;a.have<a.ncode;){for(;x<3;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.lens[Rn[a.have++]]=7&w,w>>>=3,x-=3}for(;a.have<19;)a.lens[Rn[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,at={bits:a.lenbits},Xe=L(V,a.lens,0,19,a.lencode,0,a.work,at),a.lenbits=at.bits,Xe){g.msg="invalid code lengths set",a.mode=he;break}a.have=0,a.mode=et;case et:for(;a.have<a.nlen+a.ndist;){for(;ke=a.lencode[w&(1<<a.lenbits)-1],de=ke>>>24,Re=ke>>>16&255,Pe=65535&ke,!(de<=x);){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(Pe<16)w>>>=de,x-=de,a.lens[a.have++]=Pe;else{if(Pe===16){for(rt=de+2;x<rt;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(w>>>=de,x-=de,a.have===0){g.msg="invalid bit length repeat",a.mode=he;break}Te=a.lens[a.have-1],K=3+(3&w),w>>>=2,x-=2}else if(Pe===17){for(rt=de+3;x<rt;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}w>>>=de,x-=de,Te=0,K=3+(7&w),w>>>=3,x-=3}else{for(rt=de+7;x<rt;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}w>>>=de,x-=de,Te=0,K=11+(127&w),w>>>=7,x-=7}if(a.have+K>a.nlen+a.ndist){g.msg="invalid bit length repeat",a.mode=he;break}for(;K--;)a.lens[a.have++]=Te}}if(a.mode===he)break;if(a.lens[256]===0){g.msg="invalid code -- missing end-of-block",a.mode=he;break}if(a.lenbits=9,at={bits:a.lenbits},Xe=L($,a.lens,0,a.nlen,a.lencode,0,a.work,at),a.lenbits=at.bits,Xe){g.msg="invalid literal/lengths set",a.mode=he;break}if(a.distbits=6,a.distcode=a.distdyn,at={bits:a.distbits},Xe=L(D,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,at),a.distbits=at.bits,Xe){g.msg="invalid distances set",a.mode=he;break}if(a.mode=Ke,b===ne)break e;case Ke:a.mode=dt;case dt:if(E>=6&&p>=258){g.next_out=k,g.avail_out=p,g.next_in=r,g.avail_in=E,a.hold=w,a.bits=x,J(g,Y),k=g.next_out,Q=g.output,p=g.avail_out,r=g.next_in,F=g.input,E=g.avail_in,w=a.hold,x=a.bits,a.mode===Se&&(a.back=-1);break}for(a.back=0;ke=a.lencode[w&(1<<a.lenbits)-1],de=ke>>>24,Re=ke>>>16&255,Pe=65535&ke,!(de<=x);){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(Re&&!(240&Re)){for(Fe=de,Dt=Re,zt=Pe;ke=a.lencode[zt+((w&(1<<Fe+Dt)-1)>>Fe)],de=ke>>>24,Re=ke>>>16&255,Pe=65535&ke,!(Fe+de<=x);){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}w>>>=Fe,x-=Fe,a.back+=Fe}if(w>>>=de,x-=de,a.back+=de,a.length=Pe,Re===0){a.mode=nt;break}if(32&Re){a.back=-1,a.mode=Se;break}if(64&Re){g.msg="invalid literal/length code",a.mode=he;break}a.extra=15&Re,a.mode=st;case st:if(a.extra){for(rt=a.extra;x<rt;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.length+=w&(1<<a.extra)-1,w>>>=a.extra,x-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=wt;case wt:for(;ke=a.distcode[w&(1<<a.distbits)-1],de=ke>>>24,Re=ke>>>16&255,Pe=65535&ke,!(de<=x);){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(!(240&Re)){for(Fe=de,Dt=Re,zt=Pe;ke=a.distcode[zt+((w&(1<<Fe+Dt)-1)>>Fe)],de=ke>>>24,Re=ke>>>16&255,Pe=65535&ke,!(Fe+de<=x);){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}w>>>=Fe,x-=Fe,a.back+=Fe}if(w>>>=de,x-=de,a.back+=de,64&Re){g.msg="invalid distance code",a.mode=he;break}a.offset=Pe,a.extra=15&Re,a.mode=Be;case Be:if(a.extra){for(rt=a.extra;x<rt;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}a.offset+=w&(1<<a.extra)-1,w>>>=a.extra,x-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){g.msg="invalid distance too far back",a.mode=he;break}a.mode=tt;case tt:if(p===0)break e;if(K=Y-p,a.offset>K){if(K=a.offset-K,K>a.whave&&a.sane){g.msg="invalid distance too far back",a.mode=he;break}K>a.wnext?(K-=a.wnext,ie=a.wsize-K):ie=a.wnext-K,K>a.length&&(K=a.length),We=a.window}else We=Q,ie=k-a.offset,K=a.length;K>p&&(K=p),p-=K,a.length-=K;do Q[k++]=We[ie++];while(--K);a.length===0&&(a.mode=dt);break;case nt:if(p===0)break e;Q[k++]=a.length,p--,a.mode=dt;break;case te:if(a.wrap){for(;x<32;){if(E===0)break e;E--,w|=F[r++]<<x,x+=8}if(Y-=p,g.total_out+=Y,a.total+=Y,Y&&(g.adler=a.check=a.flags?W(a.check,Q,Y,k-Y):O(a.check,Q,Y,k-Y)),Y=p,(a.flags?w:n(w))!==a.check){g.msg="incorrect data check",a.mode=he;break}w=0,x=0}a.mode=Ue;case Ue:if(a.wrap&&a.flags){for(;x<32;){if(E===0)break e;E--,w+=F[r++]<<x,x+=8}if(w!==(4294967295&a.total)){g.msg="incorrect length check",a.mode=he;break}w=0,x=0}a.mode=Le;case Le:Xe=S;break e;case he:Xe=Z;break e;case je:return j;case ut:default:return I}return g.next_out=k,g.avail_out=p,g.next_in=r,g.avail_in=E,a.hold=w,a.bits=x,(a.wsize||Y!==g.avail_out&&a.mode<he&&(a.mode<te||b!==ee))&&l(g,g.output,g.next_out,Y-g.avail_out)?(a.mode=je,j):(H-=g.avail_in,Y-=g.avail_out,g.total_in+=H,g.total_out+=Y,a.total+=Y,a.wrap&&Y&&(g.adler=a.check=a.flags?W(a.check,Q,Y,g.next_out-Y):O(a.check,Q,Y,g.next_out-Y)),g.data_type=a.bits+(a.last?64:0)+(a.mode===Se?128:0)+(a.mode===Ke||a.mode===Ye?256:0),(H===0&&Y===0||b===ee)&&Xe===re&&(Xe=q),Xe)}function y(g){if(!g||!g.state)return I;var b=g.state;return b.window&&(b.window=null),g.state=null,re}function v(g,b){var a;return g&&g.state?(a=g.state,2&a.wrap?(a.head=b,b.done=!1,re):I):I}function T(g,b){var a,F,Q=b.length;return g&&g.state?(a=g.state,a.wrap!==0&&a.mode!==Ce?I:a.mode===Ce&&(F=1,F=O(F,b,Q,0),F!==a.check)?Z:l(g,b,Q,Q)?(a.mode=je,j):(a.havedict=1,re)):I}var R,P,U=s("../utils/common"),O=s("./adler32"),W=s("./crc32"),J=s("./inffast"),L=s("./inftrees"),V=0,$=1,D=2,ee=4,we=5,ne=6,re=0,S=1,A=2,I=-2,Z=-3,j=-4,q=-5,pe=8,_e=1,oe=2,me=3,ge=4,Ee=5,ue=6,be=7,fe=8,xe=9,ve=10,Ce=11,Se=12,ze=13,qe=14,Ye=15,Me=16,Ve=17,Ae=18,et=19,Ke=20,dt=21,st=22,wt=23,Be=24,tt=25,nt=26,te=27,Ue=28,Le=29,he=30,je=31,ut=32,ot=852,c=592,N=15,M=N,B=!0;t.inflateReset=d,t.inflateReset2=u,t.inflateResetKeep=o,t.inflateInit=m,t.inflateInit2=f,t.inflate=h,t.inflateEnd=y,t.inflateGetHeader=v,t.inflateSetDictionary=T,t.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./inffast":35,"./inftrees":37}],37:[function(s,e,t){var n=s("../utils/common"),i=15,o=852,d=592,u=0,f=1,m=2,_=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],y=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(v,T,R,P,U,O,W,J){var L,V,$,D,ee,we,ne,re,S,A=J.bits,I=0,Z=0,j=0,q=0,pe=0,_e=0,oe=0,me=0,ge=0,Ee=0,ue=null,be=0,fe=new n.Buf16(i+1),xe=new n.Buf16(i+1),ve=null,Ce=0;for(I=0;I<=i;I++)fe[I]=0;for(Z=0;Z<P;Z++)fe[T[R+Z]]++;for(pe=A,q=i;q>=1&&fe[q]===0;q--);if(pe>q&&(pe=q),q===0)return U[O++]=20971520,U[O++]=20971520,J.bits=1,0;for(j=1;j<q&&fe[j]===0;j++);for(pe<j&&(pe=j),me=1,I=1;I<=i;I++)if(me<<=1,me-=fe[I],me<0)return-1;if(me>0&&(v===u||q!==1))return-1;for(xe[1]=0,I=1;I<i;I++)xe[I+1]=xe[I]+fe[I];for(Z=0;Z<P;Z++)T[R+Z]!==0&&(W[xe[T[R+Z]]++]=Z);if(v===u?(ue=ve=W,we=19):v===f?(ue=_,be-=257,ve=l,Ce-=257,we=256):(ue=h,ve=y,we=-1),Ee=0,Z=0,I=j,ee=O,_e=pe,oe=0,$=-1,ge=1<<pe,D=ge-1,v===f&&ge>o||v===m&&ge>d)return 1;for(var Se=0;;){Se++,ne=I-oe,W[Z]<we?(re=0,S=W[Z]):W[Z]>we?(re=ve[Ce+W[Z]],S=ue[be+W[Z]]):(re=96,S=0),L=1<<I-oe,V=1<<_e,j=V;do V-=L,U[ee+(Ee>>oe)+V]=ne<<24|re<<16|S|0;while(V!==0);for(L=1<<I-1;Ee&L;)L>>=1;if(L!==0?(Ee&=L-1,Ee+=L):Ee=0,Z++,--fe[I]===0){if(I===q)break;I=T[R+W[Z]]}if(I>pe&&(Ee&D)!==$){for(oe===0&&(oe=pe),ee+=j,_e=I-oe,me=1<<_e;_e+oe<q&&(me-=fe[_e+oe],!(me<=0));)_e++,me<<=1;if(ge+=1<<_e,v===f&&ge>o||v===m&&ge>d)return 1;$=Ee&D,U[$]=pe<<24|_e<<16|ee-O|0}}return Ee!==0&&(U[ee+Ee]=I-oe<<24|64<<16|0),J.bits=pe,0}},{"../utils/common":28}],38:[function(s,e,t){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],39:[function(s,e,t){function n(c){for(var N=c.length;--N>=0;)c[N]=0}function i(c,N,M,B,g){this.static_tree=c,this.extra_bits=N,this.extra_base=M,this.elems=B,this.max_length=g,this.has_stree=c&&c.length}function o(c,N){this.dyn_tree=c,this.max_code=0,this.stat_desc=N}function d(c){return c<256?nt[c]:nt[256+(c>>>7)]}function u(c,N){c.pending_buf[c.pending++]=255&N,c.pending_buf[c.pending++]=N>>>8&255}function f(c,N,M){c.bi_valid>ze-M?(c.bi_buf|=N<<c.bi_valid&65535,u(c,c.bi_buf),c.bi_buf=N>>ze-c.bi_valid,c.bi_valid+=M-ze):(c.bi_buf|=N<<c.bi_valid&65535,c.bi_valid+=M)}function m(c,N,M){f(c,M[2*N],M[2*N+1])}function _(c,N){var M=0;do M|=1&c,c>>>=1,M<<=1;while(--N>0);return M>>>1}function l(c){c.bi_valid===16?(u(c,c.bi_buf),c.bi_buf=0,c.bi_valid=0):c.bi_valid>=8&&(c.pending_buf[c.pending++]=255&c.bi_buf,c.bi_buf>>=8,c.bi_valid-=8)}function h(c,N){var M,B,g,b,a,F,Q=N.dyn_tree,r=N.max_code,k=N.stat_desc.static_tree,E=N.stat_desc.has_stree,p=N.stat_desc.extra_bits,w=N.stat_desc.extra_base,x=N.stat_desc.max_length,H=0;for(b=0;b<=Se;b++)c.bl_count[b]=0;for(Q[2*c.heap[c.heap_max]+1]=0,M=c.heap_max+1;M<Ce;M++)B=c.heap[M],b=Q[2*Q[2*B+1]+1]+1,b>x&&(b=x,H++),Q[2*B+1]=b,B>r||(c.bl_count[b]++,a=0,B>=w&&(a=p[B-w]),F=Q[2*B],c.opt_len+=F*(b+a),E&&(c.static_len+=F*(k[2*B+1]+a)));if(H!==0){do{for(b=x-1;c.bl_count[b]===0;)b--;c.bl_count[b]--,c.bl_count[b+1]+=2,c.bl_count[x]--,H-=2}while(H>0);for(b=x;b!==0;b--)for(B=c.bl_count[b];B!==0;)g=c.heap[--M],g>r||(Q[2*g+1]!==b&&(c.opt_len+=(b-Q[2*g+1])*Q[2*g],Q[2*g+1]=b),B--)}}function y(c,N,M){var B,g,b=new Array(Se+1),a=0;for(B=1;B<=Se;B++)b[B]=a=a+M[B-1]<<1;for(g=0;g<=N;g++){var F=c[2*g+1];F!==0&&(c[2*g]=_(b[F]++,F))}}function v(){var c,N,M,B,g,b=new Array(Se+1);for(M=0,B=0;B<ue-1;B++)for(Ue[B]=M,c=0;c<1<<et[B];c++)te[M++]=B;for(te[M-1]=B,g=0,B=0;B<16;B++)for(Le[B]=g,c=0;c<1<<Ke[B];c++)nt[g++]=B;for(g>>=7;B<xe;B++)for(Le[B]=g<<7,c=0;c<1<<Ke[B]-7;c++)nt[256+g++]=B;for(N=0;N<=Se;N++)b[N]=0;for(c=0;c<=143;)Be[2*c+1]=8,c++,b[8]++;for(;c<=255;)Be[2*c+1]=9,c++,b[9]++;for(;c<=279;)Be[2*c+1]=7,c++,b[7]++;for(;c<=287;)Be[2*c+1]=8,c++,b[8]++;for(y(Be,fe+1,b),c=0;c<xe;c++)tt[2*c+1]=5,tt[2*c]=_(c,5);he=new i(Be,et,be+1,fe,Se),je=new i(tt,Ke,0,xe,Se),ut=new i(new Array(0),dt,0,ve,qe)}function T(c){var N;for(N=0;N<fe;N++)c.dyn_ltree[2*N]=0;for(N=0;N<xe;N++)c.dyn_dtree[2*N]=0;for(N=0;N<ve;N++)c.bl_tree[2*N]=0;c.dyn_ltree[2*Ye]=1,c.opt_len=c.static_len=0,c.last_lit=c.matches=0}function R(c){c.bi_valid>8?u(c,c.bi_buf):c.bi_valid>0&&(c.pending_buf[c.pending++]=c.bi_buf),c.bi_buf=0,c.bi_valid=0}function P(c,N,M,B){R(c),B&&(u(c,M),u(c,~M)),I.arraySet(c.pending_buf,c.window,N,M,c.pending),c.pending+=M}function U(c,N,M,B){var g=2*N,b=2*M;return c[g]<c[b]||c[g]===c[b]&&B[N]<=B[M]}function O(c,N,M){for(var B=c.heap[M],g=M<<1;g<=c.heap_len&&(g<c.heap_len&&U(N,c.heap[g+1],c.heap[g],c.depth)&&g++,!U(N,B,c.heap[g],c.depth));)c.heap[M]=c.heap[g],M=g,g<<=1;c.heap[M]=B}function W(c,N,M){var B,g,b,a,F=0;if(c.last_lit!==0)do B=c.pending_buf[c.d_buf+2*F]<<8|c.pending_buf[c.d_buf+2*F+1],g=c.pending_buf[c.l_buf+F],F++,B===0?m(c,g,N):(b=te[g],m(c,b+be+1,N),a=et[b],a!==0&&(g-=Ue[b],f(c,g,a)),B--,b=d(B),m(c,b,M),a=Ke[b],a!==0&&(B-=Le[b],f(c,B,a)));while(F<c.last_lit);m(c,Ye,N)}function J(c,N){var M,B,g,b=N.dyn_tree,a=N.stat_desc.static_tree,F=N.stat_desc.has_stree,Q=N.stat_desc.elems,r=-1;for(c.heap_len=0,c.heap_max=Ce,M=0;M<Q;M++)b[2*M]!==0?(c.heap[++c.heap_len]=r=M,c.depth[M]=0):b[2*M+1]=0;for(;c.heap_len<2;)g=c.heap[++c.heap_len]=r<2?++r:0,b[2*g]=1,c.depth[g]=0,c.opt_len--,F&&(c.static_len-=a[2*g+1]);for(N.max_code=r,M=c.heap_len>>1;M>=1;M--)O(c,b,M);g=Q;do M=c.heap[1],c.heap[1]=c.heap[c.heap_len--],O(c,b,1),B=c.heap[1],c.heap[--c.heap_max]=M,c.heap[--c.heap_max]=B,b[2*g]=b[2*M]+b[2*B],c.depth[g]=(c.depth[M]>=c.depth[B]?c.depth[M]:c.depth[B])+1,b[2*M+1]=b[2*B+1]=g,c.heap[1]=g++,O(c,b,1);while(c.heap_len>=2);c.heap[--c.heap_max]=c.heap[1],h(c,N),y(b,r,c.bl_count)}function L(c,N,M){var B,g,b=-1,a=N[1],F=0,Q=7,r=4;for(a===0&&(Q=138,r=3),N[2*(M+1)+1]=65535,B=0;B<=M;B++)g=a,a=N[2*(B+1)+1],++F<Q&&g===a||(F<r?c.bl_tree[2*g]+=F:g!==0?(g!==b&&c.bl_tree[2*g]++,c.bl_tree[2*Me]++):F<=10?c.bl_tree[2*Ve]++:c.bl_tree[2*Ae]++,F=0,b=g,a===0?(Q=138,r=3):g===a?(Q=6,r=3):(Q=7,r=4))}function V(c,N,M){var B,g,b=-1,a=N[1],F=0,Q=7,r=4;for(a===0&&(Q=138,r=3),B=0;B<=M;B++)if(g=a,a=N[2*(B+1)+1],!(++F<Q&&g===a)){if(F<r)do m(c,g,c.bl_tree);while(--F!==0);else g!==0?(g!==b&&(m(c,g,c.bl_tree),F--),m(c,Me,c.bl_tree),f(c,F-3,2)):F<=10?(m(c,Ve,c.bl_tree),f(c,F-3,3)):(m(c,Ae,c.bl_tree),f(c,F-11,7));F=0,b=g,a===0?(Q=138,r=3):g===a?(Q=6,r=3):(Q=7,r=4)}}function $(c){var N;for(L(c,c.dyn_ltree,c.l_desc.max_code),L(c,c.dyn_dtree,c.d_desc.max_code),J(c,c.bl_desc),N=ve-1;N>=3&&c.bl_tree[2*st[N]+1]===0;N--);return c.opt_len+=3*(N+1)+5+5+4,N}function D(c,N,M,B){var g;for(f(c,N-257,5),f(c,M-1,5),f(c,B-4,4),g=0;g<B;g++)f(c,c.bl_tree[2*st[g]+1],3);V(c,c.dyn_ltree,N-1),V(c,c.dyn_dtree,M-1)}function ee(c){var N,M=4093624447;for(N=0;N<=31;N++,M>>>=1)if(1&M&&c.dyn_ltree[2*N]!==0)return j;if(c.dyn_ltree[18]!==0||c.dyn_ltree[20]!==0||c.dyn_ltree[26]!==0)return q;for(N=32;N<be;N++)if(c.dyn_ltree[2*N]!==0)return q;return j}function we(c){ot||(v(),ot=!0),c.l_desc=new o(c.dyn_ltree,he),c.d_desc=new o(c.dyn_dtree,je),c.bl_desc=new o(c.bl_tree,ut),c.bi_buf=0,c.bi_valid=0,T(c)}function ne(c,N,M,B){f(c,(_e<<1)+(B?1:0),3),P(c,N,M,!0)}function re(c){f(c,oe<<1,3),m(c,Ye,Be),l(c)}function S(c,N,M,B){var g,b,a=0;c.level>0?(c.strm.data_type===pe&&(c.strm.data_type=ee(c)),J(c,c.l_desc),J(c,c.d_desc),a=$(c),g=c.opt_len+3+7>>>3,b=c.static_len+3+7>>>3,b<=g&&(g=b)):g=b=M+5,M+4<=g&&N!==-1?ne(c,N,M,B):c.strategy===Z||b===g?(f(c,(oe<<1)+(B?1:0),3),W(c,Be,tt)):(f(c,(me<<1)+(B?1:0),3),D(c,c.l_desc.max_code+1,c.d_desc.max_code+1,a+1),W(c,c.dyn_ltree,c.dyn_dtree)),T(c),B&&R(c)}function A(c,N,M){return c.pending_buf[c.d_buf+2*c.last_lit]=N>>>8&255,c.pending_buf[c.d_buf+2*c.last_lit+1]=255&N,c.pending_buf[c.l_buf+c.last_lit]=255&M,c.last_lit++,N===0?c.dyn_ltree[2*M]++:(c.matches++,N--,c.dyn_ltree[2*(te[M]+be+1)]++,c.dyn_dtree[2*d(N)]++),c.last_lit===c.lit_bufsize-1}var I=s("../utils/common"),Z=4,j=0,q=1,pe=2,_e=0,oe=1,me=2,ge=3,Ee=258,ue=29,be=256,fe=be+1+ue,xe=30,ve=19,Ce=2*fe+1,Se=15,ze=16,qe=7,Ye=256,Me=16,Ve=17,Ae=18,et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ke=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],st=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],wt=512,Be=new Array(2*(fe+2));n(Be);var tt=new Array(2*xe);n(tt);var nt=new Array(wt);n(nt);var te=new Array(Ee-ge+1);n(te);var Ue=new Array(ue);n(Ue);var Le=new Array(xe);n(Le);var he,je,ut,ot=!1;t._tr_init=we,t._tr_stored_block=ne,t._tr_flush_block=S,t._tr_tally=A,t._tr_align=re},{"../utils/common":28}],40:[function(s,e,t){function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},{}]},{},[10])(10)});const Yt="http://www.w3.org/2001/XMLSchema-instance";function yt(s,e){return At().createElementNS(s,e)}function Je(s,e){return Bn(s,e,[]).join("")}function Bn(s,e,t){if(s.nodeType==Node.CDATA_SECTION_NODE||s.nodeType==Node.TEXT_NODE)e?t.push(String(s.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(s.nodeValue);else{let n;for(n=s.firstChild;n;n=n.nextSibling)Bn(n,e,t)}return t}function ft(s){return"documentElement"in s}function ct(s){return new DOMParser().parseFromString(s,"application/xml")}function Tn(s,e){return function(t,n){const i=s.call(e!==void 0?e:this,t,n);if(i!==void 0){const o=n[n.length-1];Ie(o,i)}}}function $e(s,e){return function(t,n){const i=s.call(e!==void 0?e:this,t,n);i!==void 0&&n[n.length-1].push(i)}}function hn(s,e){return function(t,n){const i=s.call(e!==void 0?e:this,t,n);i!==void 0&&(n[n.length-1]=i)}}function C(s,e,t){return function(n,i){const o=s.call(t!==void 0?t:this,n,i);if(o!==void 0){const d=i[i.length-1],u=e!==void 0?e:n.localName;d[u]=o}}}function z(s,e){return function(t,n,i){s.call(e!==void 0?e:this,t,n,i),i[i.length-1].node.appendChild(t)}}function Gn(s,e){let t,n;return function(i,o,d){if(t===void 0){t={};const u={};u[i.localName]=s,t[i.namespaceURI]=u,n=Qe(i.localName)}Zn(t,n,o,d)}}function Qe(s,e){return function(t,n,i){const d=n[n.length-1].node;let u=s;u===void 0&&(u=i);const f=e!==void 0?e:d.namespaceURI;return yt(f,u)}}const De=Qe();function Ze(s,e){const t=e.length,n=new Array(t);for(let i=0;i<t;++i)n[i]=s[e[i]];return n}function G(s,e,t){t=t!==void 0?t:{};let n,i;for(n=0,i=s.length;n<i;++n)t[s[n]]=e;return t}function pt(s,e,t,n){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const o=s[i.namespaceURI];if(o!==void 0){const d=o[i.localName];d!==void 0&&d.call(n,i,t)}}}function ae(s,e,t,n,i){return n.push(s),pt(e,t,n,i),n.pop()}function Zn(s,e,t,n,i,o){const d=(i!==void 0?i:t).length;let u,f;for(let m=0;m<d;++m)u=t[m],u!==void 0&&(f=e.call(o!==void 0?o:this,u,n,i!==void 0?i[m]:void 0),f!==void 0&&s[f.namespaceURI][f.localName].call(o,f,u,n))}function ye(s,e,t,n,i,o,d){return i.push(s),Zn(e,t,n,i,o,d),i.pop()}let qt;function jr(){return qt===void 0&&typeof XMLSerializer<"u"&&(qt=new XMLSerializer),qt}let en;function At(){return en===void 0&&typeof document<"u"&&(en=document.implementation.createDocument("","",null)),en}class Wr extends Pn{constructor(){super(),this.xmlSerializer_=jr()}getType(){return"xml"}readFeature(e,t){if(!e)return null;if(typeof e=="string"){const n=ct(e);return this.readFeatureFromDocument(n,t)}return ft(e)?this.readFeatureFromDocument(e,t):this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const n=this.readFeaturesFromDocument(e,t);return n.length>0?n[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(!e)return[];if(typeof e=="string"){const n=ct(e);return this.readFeaturesFromDocument(n,t)}return ft(e)?this.readFeaturesFromDocument(e,t):this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const n=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&Ie(n,this.readFeaturesFromNode(i,t));return n}readFeaturesFromNode(e,t){return mt()}readGeometry(e,t){if(!e)return null;if(typeof e=="string"){const n=ct(e);return this.readGeometryFromDocument(n,t)}return ft(e)?this.readGeometryFromDocument(e,t):this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const t=ct(e);return this.readProjectionFromDocument(t)}return ft(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const n=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(n)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const n=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(n)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const n=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(n)}writeGeometryNode(e,t){return null}}const Yn=Wr;function ht(s){const e=Je(s,!1);return $r(e)}function $r(s){const e=/^\s*(true|1)|(false|0)\s*$/.exec(s);if(e)return e[1]!==void 0||!1}function pn(s){const e=Je(s,!1),t=Date.parse(e);return isNaN(t)?void 0:t/1e3}function le(s){const e=Je(s,!1);return Jr(e)}function Jr(s){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(s);if(e)return parseFloat(e[1])}function Kt(s){const e=Je(s,!1);return Qr(e)}function Qr(s){const e=/^\s*(\d+)\s*$/.exec(s);if(e)return parseInt(e[1],10)}function se(s){return Je(s,!1).trim()}function vt(s,e){ce(s,e?"1":"0")}function qr(s,e){s.appendChild(At().createCDATASection(e))}function ei(s,e){const t=new Date(e*1e3),n=t.getUTCFullYear()+"-"+Nt(t.getUTCMonth()+1,2)+"-"+Nt(t.getUTCDate(),2)+"T"+Nt(t.getUTCHours(),2)+":"+Nt(t.getUTCMinutes(),2)+":"+Nt(t.getUTCSeconds(),2)+"Z";s.appendChild(At().createTextNode(n))}function Ge(s,e){const t=e.toPrecision();s.appendChild(At().createTextNode(t))}function Xt(s,e){const t=e.toString();s.appendChild(At().createTextNode(t))}function ce(s,e){s.appendChild(At().createTextNode(e))}const Ne=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],ti="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",ni={rte:Kn,trk:Xn,wpt:Hn},ri=G(Ne,{rte:$e(Kn),trk:$e(Xn),wpt:$e(Hn)}),ii=G(Ne,{text:C(se,"linkText"),type:C(se,"linkType")}),si=G(Ne,{rte:z(Ii),trk:z(Ni),wpt:z(Ci)});class oi extends Yn{constructor(e){super(),e=e||{},this.dataProjection=Ot("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let t=0,n=e.length;t<n;++t){const i=e[t];if(this.readExtensions_){const o=i.get("extensionsNode_")||null;this.readExtensions_(i,o)}i.set("extensionsNode_",void 0)}}readFeatureFromNode(e,t){if(!Ne.includes(e.namespaceURI))return null;const n=ni[e.localName];if(!n)return null;const i=n(e,[this.getReadOptions(e,t)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,t){if(!Ne.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const n=ae([],ri,e,[this.getReadOptions(e,t)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}writeFeaturesNode(e,t){t=this.adaptOptions(t);const n=yt("http://www.topografix.com/GPX/1/1","gpx"),i="http://www.w3.org/2000/xmlns/";return n.setAttributeNS(i,"xmlns:xsi",Yt),n.setAttributeNS(Yt,"xsi:schemaLocation",ti),n.setAttribute("version","1.1"),n.setAttribute("creator","OpenLayers"),ye({node:n},si,Ai,e,[t]),n}}const ai=G(Ne,{name:C(se),cmt:C(se),desc:C(se),src:C(se),link:_n,number:C(Kt),extensions:yn,type:C(se),rtept:Ri}),li=G(Ne,{ele:C(le),time:C(pn)}),di=G(Ne,{name:C(se),cmt:C(se),desc:C(se),src:C(se),link:_n,number:C(Kt),type:C(se),extensions:yn,trkseg:ki}),ui=G(Ne,{trkpt:Ti}),fi=G(Ne,{ele:C(le),time:C(pn)}),ci=G(Ne,{ele:C(le),time:C(pn),magvar:C(le),geoidheight:C(le),name:C(se),cmt:C(se),desc:C(se),src:C(se),link:_n,sym:C(se),type:C(se),fix:C(se),sat:C(Kt),hdop:C(le),vdop:C(le),pdop:C(le),ageofdgpsdata:C(le),dgpsid:C(Kt),extensions:yn}),hi=["text","type"],pi=G(Ne,{text:z(ce),type:z(ce)}),mi=G(Ne,["name","cmt","desc","src","link","number","type","rtept"]),gi=G(Ne,{name:z(ce),cmt:z(ce),desc:z(ce),src:z(ce),link:z(wn),number:z(Xt),type:z(ce),rtept:Gn(z(En))}),_i=G(Ne,["ele","time"]),yi=G(Ne,["name","cmt","desc","src","link","number","type","trkseg"]),wi=G(Ne,{name:z(ce),cmt:z(ce),desc:z(ce),src:z(ce),link:z(wn),number:z(Xt),type:z(ce),trkseg:Gn(z(Li))}),Ei=Qe("trkpt"),xi=G(Ne,{trkpt:z(En)}),Si=G(Ne,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),vi=G(Ne,{ele:z(Ge),time:z(ei),magvar:z(Ge),geoidheight:z(Ge),name:z(ce),cmt:z(ce),desc:z(ce),src:z(ce),link:z(wn),sym:z(ce),type:z(ce),fix:z(ce),sat:z(Xt),hdop:z(Ge),vdop:z(Ge),pdop:z(Ge),ageofdgpsdata:z(Ge),dgpsid:z(Xt)}),bi={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Ai(s,e,t){const n=s.getGeometry();if(n){const i=bi[n.getType()];if(i){const o=e[e.length-1].node;return yt(o.namespaceURI,i)}}}function mn(s,e,t,n){return s.push(parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))),"ele"in n?(s.push(n.ele),delete n.ele,e.hasZ=!0):s.push(0),"time"in n?(s.push(n.time),delete n.time,e.hasM=!0):s.push(0),s}function gn(s,e,t){let n="XY",i=2;if(s.hasZ&&s.hasM?(n="XYZM",i=4):s.hasZ?(n="XYZ",i=3):s.hasM&&(n="XYM",i=3),i!==4){for(let o=0,d=e.length/4;o<d;o++)e[o*i]=e[o*4],e[o*i+1]=e[o*4+1],s.hasZ&&(e[o*i+2]=e[o*4+2]),s.hasM&&(e[o*i+2]=e[o*4+3]);if(e.length=e.length/4*i,t)for(let o=0,d=t.length;o<d;o++)t[o]=t[o]/4*i}return n}function _n(s,e){const t=e[e.length-1],n=s.getAttribute("href");n!==null&&(t.link=n),pt(ii,s,e)}function yn(s,e){const t=e[e.length-1];t.extensionsNode_=s}function Ri(s,e){const t=ae({},li,s,e);if(t){const n=e[e.length-1],i=n.flatCoordinates,o=n.layoutOptions;mn(i,o,s,t)}}function Ti(s,e){const t=ae({},fi,s,e);if(t){const n=e[e.length-1],i=n.flatCoordinates,o=n.layoutOptions;mn(i,o,s,t)}}function ki(s,e){const t=e[e.length-1];pt(ui,s,e);const n=t.flatCoordinates;t.ends.push(n.length)}function Kn(s,e){const t=e[0],n=ae({flatCoordinates:[],layoutOptions:{}},ai,s,e);if(!n)return;const i=n.flatCoordinates;delete n.flatCoordinates;const o=n.layoutOptions;delete n.layoutOptions;const d=gn(o,i),u=new Pt(i,d);it(u,!1,t);const f=new bt(u);return f.setProperties(n,!0),f}function Xn(s,e){const t=e[0],n=ae({flatCoordinates:[],ends:[],layoutOptions:{}},di,s,e);if(!n)return;const i=n.flatCoordinates;delete n.flatCoordinates;const o=n.ends;delete n.ends;const d=n.layoutOptions;delete n.layoutOptions;const u=gn(d,i,o),f=new jt(i,u,o);it(f,!1,t);const m=new bt(f);return m.setProperties(n,!0),m}function Hn(s,e){const t=e[0],n=ae({},ci,s,e);if(!n)return;const i={},o=mn([],i,s,n),d=gn(i,o),u=new un(o,d);it(u,!1,t);const f=new bt(u);return f.setProperties(n,!0),f}function wn(s,e,t){s.setAttribute("href",e);const i=t[t.length-1].properties,o=[i.linkText,i.linkType];ye({node:s},pi,De,o,t,hi)}function En(s,e,t){const n=t[t.length-1],o=n.node.namespaceURI,d=n.properties;switch(s.setAttributeNS(null,"lat",String(e[1])),s.setAttributeNS(null,"lon",String(e[0])),n.geometryLayout){case"XYZM":e[3]!==0&&(d.time=e[3]);case"XYZ":e[2]!==0&&(d.ele=e[2]);break;case"XYM":e[2]!==0&&(d.time=e[2]);break}const f=s.nodeName=="rtept"?_i[o]:Si[o],m=Ze(d,f);ye({node:s,properties:d},vi,De,m,t,f)}function Ii(s,e,t){const n=t[0],i=e.getProperties(),o={node:s};o.properties=i;const d=e.getGeometry();if(d.getType()=="LineString"){const _=it(d,!0,n);o.geometryLayout=_.getLayout(),i.rtept=_.getCoordinates()}const u=t[t.length-1].node,f=mi[u.namespaceURI],m=Ze(i,f);ye(o,gi,De,m,t,f)}function Ni(s,e,t){const n=t[0],i=e.getProperties(),o={node:s};o.properties=i;const d=e.getGeometry();if(d.getType()=="MultiLineString"){const _=it(d,!0,n);i.trkseg=_.getLineStrings()}const u=t[t.length-1].node,f=yi[u.namespaceURI],m=Ze(i,f);ye(o,wi,De,m,t,f)}function Li(s,e,t){const n={node:s};n.geometryLayout=e.getLayout(),n.properties={},ye(n,xi,Ei,e.getCoordinates(),t)}function Ci(s,e,t){const n=t[0],i=t[t.length-1];i.properties=e.getProperties();const o=e.getGeometry();if(o.getType()=="Point"){const d=it(o,!0,n);i.geometryLayout=d.getLayout(),En(s,d.getCoordinates(),t)}}const Fi=oi;class Oi extends Pn{constructor(){super()}getType(){return"text"}readFeature(e,t){return this.readFeatureFromText(Ut(e),this.adaptOptions(t))}readFeatureFromText(e,t){return mt()}readFeatures(e,t){return this.readFeaturesFromText(Ut(e),this.adaptOptions(t))}readFeaturesFromText(e,t){return mt()}readGeometry(e,t){return this.readGeometryFromText(Ut(e),this.adaptOptions(t))}readGeometryFromText(e,t){return mt()}readProjection(e){return this.readProjectionFromText(Ut(e))}readProjectionFromText(e){return this.dataProjection}writeFeature(e,t){return this.writeFeatureText(e,this.adaptOptions(t))}writeFeatureText(e,t){return mt()}writeFeatures(e,t){return this.writeFeaturesText(e,this.adaptOptions(t))}writeFeaturesText(e,t){return mt()}writeGeometry(e,t){return this.writeGeometryText(e,this.adaptOptions(t))}writeGeometryText(e,t){return mt()}}function Ut(s){return typeof s=="string"?s:""}const Pi=Oi,Di=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,zi=/^H.([A-Z]{3}).*?:(.*)/,Mi=/^HFDTE(\d{2})(\d{2})(\d{2})/,Ui=/\r\n|\r|\n/;class Bi extends Pi{constructor(e){super(),e=e||{},this.dataProjection=Ot("EPSG:4326"),this.altitudeMode_=e.altitudeMode?e.altitudeMode:"none"}readFeatureFromText(e,t){const n=this.altitudeMode_,i=e.split(Ui),o={},d=[];let u=2e3,f=0,m=1,_=-1,l,h;for(l=0,h=i.length;l<h;++l){const R=i[l];let P;if(R.charAt(0)=="B"){if(P=Di.exec(R),P){const U=parseInt(P[1],10),O=parseInt(P[2],10),W=parseInt(P[3],10);let J=parseInt(P[4],10)+parseInt(P[5],10)/6e4;P[6]=="S"&&(J=-J);let L=parseInt(P[7],10)+parseInt(P[8],10)/6e4;if(P[9]=="W"&&(L=-L),d.push(L,J),n!="none"){let $;n=="gps"?$=parseInt(P[11],10):n=="barometric"?$=parseInt(P[12],10):$=0,d.push($)}let V=Date.UTC(u,f,m,U,O,W);V<_&&(V=Date.UTC(u,f,m+1,U,O,W)),d.push(V/1e3),_=V}}else R.charAt(0)=="H"&&(P=Mi.exec(R),P?(m=parseInt(P[1],10),f=parseInt(P[2],10)-1,u=2e3+parseInt(P[3],10)):(P=zi.exec(R),P&&(o[P[1]]=P[2].trim())))}if(d.length===0)return null;const y=n=="none"?"XYM":"XYZM",v=new Pt(d,y),T=new bt(it(v,!1,t));return T.setProperties(o,!0),T}readFeaturesFromText(e,t){const n=this.readFeatureFromText(e,t);return n?[n]:[]}}const Gi=Bi,lt=["http://www.google.com/kml/ext/2.2"],X=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Zi="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",kn={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},Yi=G(X,{ExtendedData:ar,Region:lr,MultiGeometry:C(ir,"geometry"),LineString:C(nr,"geometry"),LinearRing:C(rr,"geometry"),Point:C(sr,"geometry"),Polygon:C(or,"geometry"),Style:C(vn),StyleMap:Rs,address:C(se),description:C(se),name:C(se),open:C(ht),phoneNumber:C(se),styleUrl:C(Jn),visibility:C(ht)},G(lt,{MultiTrack:C(hs,"geometry"),Track:C(tr,"geometry")})),Ki=G(X,{ExtendedData:ar,Region:lr,Link:Ms,address:C(se),description:C(se),name:C(se),open:C(ht),phoneNumber:C(se),visibility:C(ht)}),Xi=G(X,{href:C($n)}),Hi=G(X,{Altitude:C(le),Longitude:C(le),Latitude:C(le),Tilt:C(le),AltitudeMode:C(se),Heading:C(le),Roll:C(le)}),Vn=G(X,{LatLonAltBox:Ls,Lod:Fs}),Vi=G(X,["Document","Placemark"]),ji=G(X,{Document:z(Hs),Placemark:z(fr)});let xt,Gt=null,sn,Lt,Ct,Ft,Ht,on=null,xn,an=null,ln,gt=null,In=null,dn=null;function Vt(s){return 32/Math.min(s[0],s[1])}function Wi(){xt=[255,255,255,1],Gt=new cn({color:xt}),sn=[20,2],Lt="pixels",Ct="pixels",Ft=[64,64],Ht="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",on=new Mn({anchor:sn,anchorOrigin:"bottom-left",anchorXUnits:Lt,anchorYUnits:Ct,crossOrigin:"anonymous",rotation:0,scale:Vt(Ft),size:Ft,src:Ht}),xn="NO_IMAGE",an=new rn({color:xt,width:1}),ln=new rn({color:[51,51,51,1],width:2}),gt=new Un({font:"bold 16px Helvetica",fill:Gt,stroke:ln,scale:.8}),In=new Et({fill:Gt,image:on,text:gt,stroke:an,zIndex:0}),dn=[In]}let Bt;function $i(s){return s}class Ji extends Yn{constructor(e){super(),e=e||{},dn||Wi(),this.dataProjection=Ot("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:dn,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:$i,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,t){const n=G(X,{Document:Tn(this.readDocumentOrFolder_,this),Folder:Tn(this.readDocumentOrFolder_,this),Placemark:$e(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=ae([],n,e,t,this);if(i)return i}readPlacemark_(e,t){const n=ae({geometry:null},Yi,e,t,this);if(!n)return;const i=new bt,o=e.getAttribute("id");o!==null&&i.setId(o);const d=t[0],u=n.geometry;if(u&&it(u,!1,d),i.setGeometry(u),delete n.geometry,this.extractStyles_){const f=n.Style,m=n.styleUrl,_=qi(f,m,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(_)}return delete n.Style,i.setProperties(n,!0),i}readSharedStyle_(e,t){const n=e.getAttribute("id");if(n!==null){const i=vn.call(this,e,t);if(i){let o,d=e.baseURI;(!d||d=="about:blank")&&(d=window.location.href),d?o=new URL("#"+n,d).href:o="#"+n,this.sharedStyles_[o]=i}}}readSharedStyleMap_(e,t){const n=e.getAttribute("id");if(n===null)return;const i=qn.call(this,e,t);if(!i)return;let o,d=e.baseURI;(!d||d=="about:blank")&&(d=window.location.href),d?o=new URL("#"+n,d).href:o="#"+n,this.sharedStyles_[o]=i}readFeatureFromNode(e,t){if(!X.includes(e.namespaceURI))return null;const n=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return n||null}readFeaturesFromNode(e,t){if(!X.includes(e.namespaceURI))return[];let n;const i=e.localName;if(i=="Document"||i=="Folder")return n=this.readDocumentOrFolder_(e,[this.getReadOptions(e,t)]),n||[];if(i=="Placemark"){const o=this.readPlacemark_(e,[this.getReadOptions(e,t)]);return o?[o]:[]}if(i=="kml"){n=[];for(let o=e.firstElementChild;o;o=o.nextElementSibling){const d=this.readFeaturesFromNode(o,t);d&&Ie(n,d)}return n}return[]}readName(e){if(e){if(typeof e=="string"){const t=ct(e);return this.readNameFromDocument(t)}return ft(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE){const n=this.readNameFromNode(t);if(n)return n}}readNameFromNode(e){for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(X.includes(t.namespaceURI)&&t.localName=="name")return se(t);for(let t=e.firstElementChild;t;t=t.nextElementSibling){const n=t.localName;if(X.includes(t.namespaceURI)&&(n=="Document"||n=="Folder"||n=="Placemark"||n=="kml")){const i=this.readNameFromNode(t);if(i)return i}}}readNetworkLinks(e){const t=[];if(typeof e=="string"){const n=ct(e);Ie(t,this.readNetworkLinksFromDocument(n))}else ft(e)?Ie(t,this.readNetworkLinksFromDocument(e)):Ie(t,this.readNetworkLinksFromNode(e));return t}readNetworkLinksFromDocument(e){const t=[];for(let n=e.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&Ie(t,this.readNetworkLinksFromNode(n));return t}readNetworkLinksFromNode(e){const t=[];for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(X.includes(n.namespaceURI)&&n.localName=="NetworkLink"){const i=ae({},Ki,n,[]);t.push(i)}for(let n=e.firstElementChild;n;n=n.nextElementSibling){const i=n.localName;X.includes(n.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Ie(t,this.readNetworkLinksFromNode(n))}return t}readRegion(e){const t=[];if(typeof e=="string"){const n=ct(e);Ie(t,this.readRegionFromDocument(n))}else ft(e)?Ie(t,this.readRegionFromDocument(e)):Ie(t,this.readRegionFromNode(e));return t}readRegionFromDocument(e){const t=[];for(let n=e.firstChild;n;n=n.nextSibling)n.nodeType==Node.ELEMENT_NODE&&Ie(t,this.readRegionFromNode(n));return t}readRegionFromNode(e){const t=[];for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(X.includes(n.namespaceURI)&&n.localName=="Region"){const i=ae({},Vn,n,[]);t.push(i)}for(let n=e.firstElementChild;n;n=n.nextElementSibling){const i=n.localName;X.includes(n.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&Ie(t,this.readRegionFromNode(n))}return t}readCamera(e){const t=[];if(typeof e=="string"){const n=ct(e);Ie(t,this.readCameraFromDocument(n))}else ft(e)?Ie(t,this.readCameraFromDocument(e)):Ie(t,this.readCameraFromNode(e));return t}readCameraFromDocument(e){const t=[];for(let n=e.firstChild;n;n=n.nextSibling)n.nodeType===Node.ELEMENT_NODE&&Ie(t,this.readCameraFromNode(n));return t}readCameraFromNode(e){const t=[];for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(X.includes(n.namespaceURI)&&n.localName==="Camera"){const i=ae({},Hi,n,[]);t.push(i)}for(let n=e.firstElementChild;n;n=n.nextElementSibling){const i=n.localName;X.includes(n.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&Ie(t,this.readCameraFromNode(n))}return t}writeFeaturesNode(e,t){t=this.adaptOptions(t);const n=yt(X[4],"kml"),i="http://www.w3.org/2000/xmlns/";n.setAttributeNS(i,"xmlns:gx",lt[0]),n.setAttributeNS(i,"xmlns:xsi",Yt),n.setAttributeNS(Yt,"xsi:schemaLocation",Zi);const o={node:n},d={};e.length>1?d.Document=e:e.length==1&&(d.Placemark=e[0]);const u=Vi[n.namespaceURI],f=Ze(d,u);return ye(o,ji,De,f,[t],u,this),n}}function Qi(s,e){const t=[0,0];let n="start";const i=s.getImage();if(i){const u=i.getSize();if(u&&u.length==2){const f=i.getScaleArray(),m=i.getAnchor();t[0]=f[0]*(u[0]-m[0]),t[1]=f[1]*(u[1]/2-m[1]),n="left"}}let o=s.getText();return o?(o=o.clone(),o.setFont(o.getFont()||gt.getFont()),o.setScale(o.getScale()||gt.getScale()),o.setFill(o.getFill()||gt.getFill()),o.setStroke(o.getStroke()||ln)):o=gt.clone(),o.setText(e),o.setOffsetX(t[0]),o.setOffsetY(t[1]),o.setTextAlign(n),new Et({image:i,text:o})}function qi(s,e,t,n,i){return function(o,d){let u=i,f="",m=[];if(u){const l=o.getGeometry();if(l)if(l instanceof _t)m=l.getGeometriesArrayRecursive().filter(function(h){const y=h.getType();return y==="Point"||y==="MultiPoint"}),u=m.length>0;else{const h=l.getType();u=h==="Point"||h==="MultiPoint"}}u&&(f=o.get("name"),u=u&&!!f,u&&/&[^&]+;/.test(f)&&(Bt||(Bt=document.createElement("textarea")),Bt.innerHTML=f,f=Bt.value));let _=t;if(s?_=s:e&&(_=jn(e,t,n)),u){const l=Qi(_[0],f);if(m.length>0){l.setGeometry(new _t(m));const h=new Et({geometry:_[0].getGeometry(),image:null,fill:_[0].getFill(),stroke:_[0].getStroke(),text:null});return[l,h].concat(_.slice(1))}return l}return _}}function jn(s,e,t){return Array.isArray(s)?s:typeof s=="string"?jn(t[s],e,t):e}function Wt(s){const e=Je(s,!1),t=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(t){const n=t[1];return[parseInt(n.substr(6,2),16),parseInt(n.substr(4,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(0,2),16)/255]}}function Wn(s){let e=Je(s,!1);const t=[];e=e.replace(/\s*,\s*/g,",");const n=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=n.exec(e);){const o=parseFloat(i[1]),d=parseFloat(i[2]),u=i[3]?parseFloat(i[3]):0;t.push(o,d,u),e=e.substr(i[0].length)}if(e==="")return t}function $n(s){const e=Je(s,!1).trim();let t=s.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function Jn(s){const e=Je(s,!1).trim().replace(/^(?!.*#)/,"#");let t=s.baseURI;return(!t||t=="about:blank")&&(t=window.location.href),t?new URL(e,t).href:e}function es(s){const e=s.getAttribute("xunits"),t=s.getAttribute("yunits");let n;return e!=="insetPixels"?t!=="insetPixels"?n="bottom-left":n="top-left":t!=="insetPixels"?n="bottom-right":n="top-right",{x:parseFloat(s.getAttribute("x")),xunits:kn[e],y:parseFloat(s.getAttribute("y")),yunits:kn[t],origin:n}}function Qn(s){return le(s)}const ts=G(X,{Pair:As});function qn(s,e){return ae(void 0,ts,s,e,this)}const ns=G(X,{Icon:C(gs),color:C(Wt),heading:C(le),hotSpot:C(es),scale:C(Qn)});function rs(s,e){const t=ae({},ns,s,e);if(!t)return;const n=e[e.length-1],i="Icon"in t?t.Icon:{},o=!("Icon"in t)||Object.keys(i).length>0;let d;const u=i.href;u?d=u:o&&(d=Ht);let f,m,_,l="bottom-left";const h=t.hotSpot;h?(f=[h.x,h.y],m=h.xunits,_=h.yunits,l=h.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(d)&&(d.includes("pushpin")?(f=sn,m=Lt,_=Ct):d.includes("arrow-reverse")?(f=[54,42],m=Lt,_=Ct):d.includes("paddle")&&(f=[32,1],m=Lt,_=Ct));let y;const v=i.x,T=i.y;v!==void 0&&T!==void 0&&(y=[v,T]);let R;const P=i.w,U=i.h;P!==void 0&&U!==void 0&&(R=[P,U]);let O;const W=t.heading;W!==void 0&&(O=xr(W));const J=t.scale,L=t.color;if(o){d==Ht&&(R=Ft);const V=new Mn({anchor:f,anchorOrigin:l,anchorXUnits:m,anchorYUnits:_,crossOrigin:this.crossOrigin_,offset:y,offsetOrigin:"bottom-left",rotation:O,scale:J,size:R,src:this.iconUrlFunction_(d),color:L}),$=V.getScaleArray()[0],D=V.getSize();if(D===null){const ee=V.getImageState();if(ee===Tt.IDLE||ee===Tt.LOADING){const we=function(){const ne=V.getImageState();if(!(ne===Tt.IDLE||ne===Tt.LOADING)){const re=V.getSize();if(re&&re.length==2){const S=Vt(re);V.setScale($*S)}V.unlistenImageChange(we)}};V.listenImageChange(we),ee===Tt.IDLE&&V.load()}}else if(D.length==2){const ee=Vt(D);V.setScale($*ee)}n.imageStyle=V}else n.imageStyle=xn}const is=G(X,{color:C(Wt),scale:C(Qn)});function ss(s,e){const t=ae({},is,s,e);if(!t)return;const n=e[e.length-1],i=new Un({fill:new cn({color:"color"in t?t.color:xt}),scale:t.scale});n.textStyle=i}const os=G(X,{color:C(Wt),width:C(le)});function as(s,e){const t=ae({},os,s,e);if(!t)return;const n=e[e.length-1],i=new rn({color:"color"in t?t.color:xt,width:"width"in t?t.width:1});n.strokeStyle=i}const ls=G(X,{color:C(Wt),fill:C(ht),outline:C(ht)});function ds(s,e){const t=ae({},ls,s,e);if(!t)return;const n=e[e.length-1],i=new cn({color:"color"in t?t.color:xt});n.fillStyle=i;const o=t.fill;o!==void 0&&(n.fill=o);const d=t.outline;d!==void 0&&(n.outline=d)}const us=G(X,{coordinates:hn(Wn)});function er(s,e){return ae(null,us,s,e)}function fs(s,e){const n=e[e.length-1].coordinates,i=Je(s,!1),d=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(d){const u=parseFloat(d[1]),f=parseFloat(d[2]),m=parseFloat(d[3]);n.push([u,f,m])}else n.push([])}const cs=G(lt,{Track:$e(tr)});function hs(s,e){const t=ae([],cs,s,e);if(t)return new jt(t)}const ps=G(X,{when:Us},G(lt,{coord:fs}));function tr(s,e){const t=ae({coordinates:[],whens:[]},ps,s,e);if(!t)return;const n=[],i=t.coordinates,o=t.whens;for(let d=0,u=Math.min(i.length,o.length);d<u;++d)i[d].length==3&&n.push(i[d][0],i[d][1],i[d][2],o[d]);return new Pt(n,"XYZM")}const ms=G(X,{href:C($n)},G(lt,{x:C(le),y:C(le),w:C(le),h:C(le)}));function gs(s,e){const t=ae({},ms,s,e);return t||null}const _s=G(X,{coordinates:hn(Wn)});function Sn(s,e){return ae(null,_s,s,e)}const $t=G(X,{extrude:C(ht),tessellate:C(ht),altitudeMode:C(se)});function nr(s,e){const t=ae({},$t,s,e),n=Sn(s,e);if(n){const i=new Pt(n,"XYZ");return i.setProperties(t,!0),i}}function rr(s,e){const t=ae({},$t,s,e),n=Sn(s,e);if(n){const i=new fn(n,"XYZ",[n.length]);return i.setProperties(t,!0),i}}const ys=G(X,{LineString:$e(nr),LinearRing:$e(rr),MultiGeometry:$e(ir),Point:$e(sr),Polygon:$e(or)});function ir(s,e){const t=ae([],ys,s,e);if(!t)return null;if(t.length===0)return new _t(t);let n,i=!0;const o=t[0].getType();let d;for(let u=1,f=t.length;u<f;++u)if(d=t[u],d.getType()!=o){i=!1;break}if(i){let u,f;if(o=="Point"){const m=t[0];u=m.getLayout(),f=m.getFlatCoordinates();for(let _=1,l=t.length;_<l;++_)d=t[_],Ie(f,d.getFlatCoordinates());n=new Dn(f,u),tn(n,t)}else if(o=="LineString")n=new jt(t),tn(n,t);else if(o=="Polygon")n=new zn(t),tn(n,t);else if(o=="GeometryCollection")n=new _t(t);else throw new Error("Unknown geometry type found")}else n=new _t(t);return n}function sr(s,e){const t=ae({},$t,s,e),n=Sn(s,e);if(n){const i=new un(n,"XYZ");return i.setProperties(t,!0),i}}const ws=G(X,{innerBoundaryIs:Ps,outerBoundaryIs:zs});function or(s,e){const t=ae({},$t,s,e),n=ae([null],ws,s,e);if(n&&n[0]){const i=n[0],o=[i.length];for(let u=1,f=n.length;u<f;++u)Ie(i,n[u]),o.push(i.length);const d=new fn(i,"XYZ",o);return d.setProperties(t,!0),d}}const Es=G(X,{IconStyle:rs,LabelStyle:ss,LineStyle:as,PolyStyle:ds});function vn(s,e){const t=ae({},Es,s,e,this);if(!t)return null;let n="fillStyle"in t?t.fillStyle:Gt;const i=t.fill;i!==void 0&&!i&&(n=null);let o;"imageStyle"in t?t.imageStyle!=xn&&(o=t.imageStyle):o=on;const d="textStyle"in t?t.textStyle:gt,u="strokeStyle"in t?t.strokeStyle:an,f=t.outline;return f!==void 0&&!f?[new Et({geometry:function(m){const _=m.getGeometry(),l=_.getType();if(l==="GeometryCollection"){const h=_;return new _t(h.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v!=="Polygon"&&v!=="MultiPolygon"}))}if(l!=="Polygon"&&l!=="MultiPolygon")return _},fill:n,image:o,stroke:u,text:d,zIndex:void 0}),new Et({geometry:function(m){const _=m.getGeometry(),l=_.getType();if(l==="GeometryCollection"){const h=_;return new _t(h.getGeometriesArrayRecursive().filter(function(y){const v=y.getType();return v==="Polygon"||v==="MultiPolygon"}))}if(l==="Polygon"||l==="MultiPolygon")return _},fill:n,stroke:null,zIndex:void 0})]:[new Et({fill:n,image:o,stroke:u,text:d,zIndex:void 0})]}function tn(s,e){const t=e.length,n=new Array(e.length),i=new Array(e.length),o=new Array(e.length);let d,u,f;d=!1,u=!1,f=!1;for(let m=0;m<t;++m){const _=e[m];n[m]=_.get("extrude"),i[m]=_.get("tessellate"),o[m]=_.get("altitudeMode"),d=d||n[m]!==void 0,u=u||i[m]!==void 0,f=f||o[m]}d&&s.set("extrude",n),u&&s.set("tessellate",i),f&&s.set("altitudeMode",o)}const xs=G(X,{displayName:C(se),value:C(se)});function Ss(s,e){const t=s.getAttribute("name");pt(xs,s,e);const n=e[e.length-1];t&&n.displayName?n[t]={value:n.value,displayName:n.displayName,toString:function(){return n.value}}:t!==null?n[t]=n.value:n.displayName!==null&&(n[n.displayName]=n.value),delete n.value}const vs=G(X,{Data:Ss,SchemaData:ks});function ar(s,e){pt(vs,s,e)}function lr(s,e){pt(Vn,s,e)}const bs=G(X,{Style:C(vn),key:C(se),styleUrl:C(Jn)});function As(s,e){const t=ae({},bs,s,e,this);if(!t)return;const n=t.key;if(n&&n=="normal"){const i=t.styleUrl;i&&(e[e.length-1]=i);const o=t.Style;o&&(e[e.length-1]=o)}}function Rs(s,e){const t=qn.call(this,s,e);if(!t)return;const n=e[e.length-1];if(Array.isArray(t))n.Style=t;else if(typeof t=="string")n.styleUrl=t;else throw new Error("`styleMapValue` has an unknown type")}const Ts=G(X,{SimpleData:Is});function ks(s,e){pt(Ts,s,e)}function Is(s,e){const t=s.getAttribute("name");if(t!==null){const n=se(s),i=e[e.length-1];i[t]=n}}const Ns=G(X,{altitudeMode:C(se),minAltitude:C(le),maxAltitude:C(le),north:C(le),south:C(le),east:C(le),west:C(le)});function Ls(s,e){const t=ae({},Ns,s,e);if(!t)return;const n=e[e.length-1],i=[parseFloat(t.west),parseFloat(t.south),parseFloat(t.east),parseFloat(t.north)];n.extent=i,n.altitudeMode=t.altitudeMode,n.minAltitude=parseFloat(t.minAltitude),n.maxAltitude=parseFloat(t.maxAltitude)}const Cs=G(X,{minLodPixels:C(le),maxLodPixels:C(le),minFadeExtent:C(le),maxFadeExtent:C(le)});function Fs(s,e){const t=ae({},Cs,s,e);if(!t)return;const n=e[e.length-1];n.minLodPixels=parseFloat(t.minLodPixels),n.maxLodPixels=parseFloat(t.maxLodPixels),n.minFadeExtent=parseFloat(t.minFadeExtent),n.maxFadeExtent=parseFloat(t.maxFadeExtent)}const Os=G(X,{LinearRing:$e(er)});function Ps(s,e){const t=ae([],Os,s,e);t.length>0&&e[e.length-1].push(...t)}const Ds=G(X,{LinearRing:hn(er)});function zs(s,e){const t=ae(void 0,Ds,s,e);if(t){const n=e[e.length-1];n[0]=t}}function Ms(s,e){pt(Xi,s,e)}function Us(s,e){const n=e[e.length-1].whens,i=Je(s,!1),o=Date.parse(i);n.push(isNaN(o)?0:o)}function Jt(s,e){const t=Er(e),i=[(t.length==4?t[3]:1)*255,t[2],t[1],t[0]];for(let o=0;o<4;++o){const d=Math.floor(i[o]).toString(16);i[o]=d.length==1?"0"+d:d}ce(s,i.join(""))}function Bs(s,e,t){const n=t[t.length-1],i=n.layout,o=n.stride;let d;if(i=="XY"||i=="XYM")d=2;else if(i=="XYZ"||i=="XYZM")d=3;else throw new Error("Invalid geometry layout");const u=e.length;let f="";if(u>0){f+=e[0];for(let m=1;m<d;++m)f+=","+e[m];for(let m=o;m<u;m+=o){f+=" "+e[m];for(let _=1;_<d;++_)f+=","+e[m+_]}}ce(s,f)}const Zt=G(X,{Data:z(Gs),value:z(Ys),displayName:z(Zs)});function Gs(s,e,t){s.setAttribute("name",e.name);const n={node:s},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&ye(n,Zt,De,[i.displayName],t,["displayName"]),i!==null&&i.value&&ye(n,Zt,De,[i.value],t,["value"])):ye(n,Zt,De,[i],t,["value"])}function Zs(s,e){qr(s,e)}function Ys(s,e){ce(s,e)}const Ks=G(X,{Placemark:z(fr)}),Xs=function(s,e,t){const n=e[e.length-1].node;return yt(n.namespaceURI,"Placemark")};function Hs(s,e,t){ye({node:s},Ks,Xs,e,t,void 0,this)}const Vs=Qe("Data");function js(s,e,t){const n={node:s},i=e.names,o=e.values,d=i.length;for(let u=0;u<d;u++)ye(n,Zt,Vs,[{name:i[u],value:o[u]}],t)}const Nn=G(X,["href"],G(lt,["x","y","w","h"])),Ln=G(X,{href:z(ce)},G(lt,{x:z(Ge),y:z(Ge),w:z(Ge),h:z(Ge)})),Ws=function(s,e,t){return yt(lt[0],"gx:"+t)};function $s(s,e,t){const n={node:s},i=t[t.length-1].node;let o=Nn[i.namespaceURI],d=Ze(e,o);ye(n,Ln,De,d,t,o),o=Nn[lt[0]],d=Ze(e,o),ye(n,Ln,Ws,d,t,o)}const Js=G(X,["scale","heading","Icon","color","hotSpot"]),Qs=G(X,{Icon:z($s),color:z(Jt),heading:z(Ge),hotSpot:z(Ro),scale:z(hr)});function qs(s,e,t){const n={node:s},i={},o=e.getSrc(),d=e.getSize(),u=e.getImageSize(),f={href:o};if(d){f.w=d[0],f.h=d[1];const R=e.getAnchor(),P=e.getOrigin();if(P&&u&&P[0]!==0&&P[1]!==d[1]&&(f.x=P[0],f.y=u[1]-(P[1]+d[1])),R&&(R[0]!==d[0]/2||R[1]!==d[1]/2)){const U={x:R[0],xunits:"pixels",y:d[1]-R[1],yunits:"pixels"};i.hotSpot=U}}i.Icon=f;let m=e.getScaleArray()[0],_=d;if(_===null&&(_=Ft),_.length==2){const R=Vt(_);m=m/R}m!==1&&(i.scale=m);const l=e.getRotation();l!==0&&(i.heading=l);const h=e.getColor();h&&(i.color=h);const y=t[t.length-1].node,v=Js[y.namespaceURI],T=Ze(i,v);ye(n,Qs,De,T,t,v)}const eo=G(X,["color","scale"]),to=G(X,{color:z(Jt),scale:z(hr)});function no(s,e,t){const n={node:s},i={},o=e.getFill();o&&(i.color=o.getColor());const d=e.getScale();d&&d!==1&&(i.scale=d);const u=t[t.length-1].node,f=eo[u.namespaceURI],m=Ze(i,f);ye(n,to,De,m,t,f)}const ro=G(X,["color","width"]),io=G(X,{color:z(Jt),width:z(Ge)});function so(s,e,t){const n={node:s},i={color:e.getColor(),width:Number(e.getWidth())||1},o=t[t.length-1].node,d=ro[o.namespaceURI],u=Ze(i,d);ye(n,io,De,u,t,d)}const oo={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},dr=function(s,e,t){if(s){const n=e[e.length-1].node;return yt(n.namespaceURI,oo[s.getType()])}},ao=Qe("Point"),lo=Qe("LineString"),uo=Qe("LinearRing"),fo=Qe("Polygon"),co=G(X,{LineString:z(St),Point:z(St),Polygon:z(cr),GeometryCollection:z(ur)});function ur(s,e,t){const n={node:s},i=e.getType();let o=[],d;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(u){const f=u.getType();if(f==="MultiPoint")o=o.concat(u.getPoints());else if(f==="MultiLineString")o=o.concat(u.getLineStrings());else if(f==="MultiPolygon")o=o.concat(u.getPolygons());else if(f==="Point"||f==="LineString"||f==="Polygon")o.push(u);else throw new Error("Unknown geometry type")}),d=dr;else if(i==="MultiPoint")o=e.getPoints(),d=ao;else if(i==="MultiLineString")o=e.getLineStrings(),d=lo;else if(i==="MultiPolygon")o=e.getPolygons(),d=fo;else throw new Error("Unknown geometry type");ye(n,co,d,o,t)}const ho=G(X,{LinearRing:z(St)});function Cn(s,e,t){ye({node:s},ho,uo,[e],t)}const nn=G(X,{ExtendedData:z(js),MultiGeometry:z(ur),LineString:z(St),LinearRing:z(St),Point:z(St),Polygon:z(cr),Style:z(Ao),address:z(ce),description:z(ce),name:z(ce),open:z(vt),phoneNumber:z(ce),styleUrl:z(ce),visibility:z(vt)}),po=G(X,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),mo=Qe("ExtendedData");function fr(s,e,t){const n={node:s};e.getId()&&s.setAttribute("id",e.getId());const i=e.getProperties(),o={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};o[e.getGeometryName()]=1;const d=Object.keys(i||{}).sort().filter(function(y){return!o[y]}),u=e.getStyleFunction();if(u){const y=u(e,0);if(y){const v=Array.isArray(y)?y:[y];let T=v;if(e.getGeometry()&&(T=v.filter(function(R){const P=R.getGeometryFunction()(e);if(P){const U=P.getType();return U==="GeometryCollection"?P.getGeometriesArrayRecursive().filter(function(O){const W=O.getType();return W==="Point"||W==="MultiPoint"}).length:U==="Point"||U==="MultiPoint"}})),this.writeStyles_){let R=v,P=v;e.getGeometry()&&(R=v.filter(function(U){const O=U.getGeometryFunction()(e);if(O){const W=O.getType();return W==="GeometryCollection"?O.getGeometriesArrayRecursive().filter(function(J){const L=J.getType();return L==="LineString"||L==="MultiLineString"}).length:W==="LineString"||W==="MultiLineString"}}),P=v.filter(function(U){const O=U.getGeometryFunction()(e);if(O){const W=O.getType();return W==="GeometryCollection"?O.getGeometriesArrayRecursive().filter(function(J){const L=J.getType();return L==="Polygon"||L==="MultiPolygon"}).length:W==="Polygon"||W==="MultiPolygon"}})),i.Style={pointStyles:T,lineStyles:R,polyStyles:P}}if(T.length&&i.name===void 0){const R=T[0].getText();R&&(i.name=R.getText())}}}const f=t[t.length-1].node,m=po[f.namespaceURI],_=Ze(i,m);if(ye(n,nn,De,_,t,m),d.length>0){const y=Ze(i,d);ye(n,nn,mo,[{names:d,values:y}],t)}const l=t[0];let h=e.getGeometry();h&&(h=it(h,!0,l)),ye(n,nn,dr,[h],t)}const go=G(X,["extrude","tessellate","altitudeMode","coordinates"]),_o=G(X,{extrude:z(vt),tessellate:z(vt),altitudeMode:z(ce),coordinates:z(Bs)});function St(s,e,t){const n=e.getFlatCoordinates(),i={node:s};i.layout=e.getLayout(),i.stride=e.getStride();const o=e.getProperties();o.coordinates=n;const d=t[t.length-1].node,u=go[d.namespaceURI],f=Ze(o,u);ye(i,_o,De,f,t,u)}const yo=G(X,["color","fill","outline"]),Fn=G(X,{outerBoundaryIs:z(Cn),innerBoundaryIs:z(Cn)}),wo=Qe("innerBoundaryIs"),Eo=Qe("outerBoundaryIs");function cr(s,e,t){const n=e.getLinearRings(),i=n.shift(),o={node:s};ye(o,Fn,wo,n,t),ye(o,Fn,Eo,[i],t)}const xo=G(X,{color:z(Jt),fill:z(vt),outline:z(vt)});function So(s,e,t){const n={node:s},i=e.getFill(),o=e.getStroke(),d={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:o?void 0:!1},u=t[t.length-1].node,f=yo[u.namespaceURI],m=Ze(d,f);ye(n,xo,De,m,t,f)}function hr(s,e){Ge(s,Math.round(e*1e6)/1e6)}const vo=G(X,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),bo=G(X,{IconStyle:z(qs),LabelStyle:z(no),LineStyle:z(so),PolyStyle:z(So)});function Ao(s,e,t){const n={node:s},i={};if(e.pointStyles.length){const f=e.pointStyles[0].getText();f&&(i.LabelStyle=f);const m=e.pointStyles[0].getImage();m&&typeof m.getSrc=="function"&&(i.IconStyle=m)}if(e.lineStyles.length){const f=e.lineStyles[0].getStroke();f&&(i.LineStyle=f)}if(e.polyStyles.length){const f=e.polyStyles[0].getStroke();f&&!i.LineStyle&&(i.LineStyle=f),i.PolyStyle=e.polyStyles[0]}const o=t[t.length-1].node,d=vo[o.namespaceURI],u=Ze(i,d);ye(n,bo,De,u,t,d)}function Ro(s,e){s.setAttribute("x",String(e.x)),s.setAttribute("y",String(e.y)),s.setAttribute("xunits",e.xunits),s.setAttribute("yunits",e.yunits)}const On=Ji;class To extends Dr{constructor(e){super(),e=e||{},this.layerName_=e.layerName,this.layers_=e.layers?e.layers:null,this.dataProjection=Ot(e.dataProjection?e.dataProjection:"EPSG:4326")}readFeaturesFromObject(e,t){if(e.type=="Topology"){const n=e;let i,o=null,d=null;n.transform&&(i=n.transform,o=i.scale,d=i.translate);const u=n.arcs;i&&Do(u,o,d);const f=[],m=n.objects,_=this.layerName_;let l;for(const h in m)this.layers_&&!this.layers_.includes(h)||(m[h].type==="GeometryCollection"?(l=m[h],f.push.apply(f,Po(l,u,o,d,_,h,t))):(l=m[h],f.push(pr(l,u,o,d,_,h,t))));return f}return[]}readProjectionFromObject(e){return this.dataProjection}}const ko={Point:Io,LineString:Lo,Polygon:Fo,MultiPoint:No,MultiLineString:Co,MultiPolygon:Oo};function Qt(s,e){const t=[];let n;for(let i=0,o=s.length;i<o;++i)if(n=s[i],i>0&&t.pop(),n>=0){const d=e[n];for(let u=0,f=d.length;u<f;++u)t.push(d[u].slice(0))}else{const d=e[~n];for(let u=d.length-1;u>=0;--u)t.push(d[u].slice(0))}return t}function Io(s,e,t){const n=s.coordinates;return e&&t&&bn(n,e,t),new un(n)}function No(s,e,t){const n=s.coordinates;if(e&&t)for(let i=0,o=n.length;i<o;++i)bn(n[i],e,t);return new Dn(n)}function Lo(s,e){const t=Qt(s.arcs,e);return new Pt(t)}function Co(s,e){const t=[];for(let n=0,i=s.arcs.length;n<i;++n)t[n]=Qt(s.arcs[n],e);return new jt(t)}function Fo(s,e){const t=[];for(let n=0,i=s.arcs.length;n<i;++n)t[n]=Qt(s.arcs[n],e);return new fn(t)}function Oo(s,e){const t=[];for(let n=0,i=s.arcs.length;n<i;++n){const o=s.arcs[n],d=[];for(let u=0,f=o.length;u<f;++u)d[u]=Qt(o[u],e);t[n]=d}return new zn(t)}function Po(s,e,t,n,i,o,d){const u=s.geometries,f=[];for(let m=0,_=u.length;m<_;++m)f[m]=pr(u[m],e,t,n,i,o,d);return f}function pr(s,e,t,n,i,o,d){let u=null;const f=s.type;if(f){const l=ko[f];f==="Point"||f==="MultiPoint"?u=l(s,t,n):u=l(s,e),u=it(u,!1,d)}const m=new bt({geometry:u});s.id!==void 0&&m.setId(s.id);let _=s.properties;return i&&(_||(_={}),_[i]=o),_&&m.setProperties(_,!0),m}function Do(s,e,t){for(let n=0,i=s.length;n<i;++n)zo(s[n],e,t)}function zo(s,e,t){let n=0,i=0;for(let o=0,d=s.length;o<d;++o){const u=s[o];n+=u[0],i+=u[1],u[0]=n,u[1]=i,bn(u,e,t)}}function bn(s,e,t){s[0]=s[0]*e[0]+t[0],s[1]=s[1]*e[1]+t[1]}const Mo=To;const An=s=>(Lr("data-v-21644589"),s=s(),Cr(),s),Uo={id:"title"},Bo=Nr('<div id="map" class="map" data-v-21644589></div><br data-v-21644589><div data-v-21644589><a id="download" download data-v-21644589></a><button id="download-kmz" data-v-21644589>Download sample</button></div><br data-v-21644589><div id="info" data-v-21644589></div><p data-v-21644589>Example of using the drag-and-drop interaction with a custom format to handle KMZ files. In addition to the formats used in the <code data-v-21644589>drag-and-drop</code> example a custom format (subclassing KML) is used to handle KMZ files. KML and icons must be extracted from the KMZ array buffer synchronously. <code data-v-21644589>JSZip 2.x</code> is used as it has better browser compatibility and is simpler to code than the more recent <code data-v-21644589>JSZip-sync</code>. There is no projection transform support, so this will only work with data in EPSG:4326 and EPSG:3857.</p><h5 class="source-heading" data-v-21644589>html</h5>',7),Go={class:"language-html"},Zo=An(()=>He("h5",{class:"source-heading"},"css",-1)),Yo={class:"language-css"},Ko=An(()=>He("h5",{class:"source-heading"},"js",-1)),Xo={class:"language-js"},Ho=An(()=>He("h5",{class:"source-heading"},"package.json",-1)),Vo={class:"language-json"},jo={__name:"index",setup(s){return Rr(()=>{const e=new JSZip;function t(_){let l;e.load(_);const h=e.file(/\.kml$/i)[0];return h&&(l=h.asText()),l}function n(_){const l=window.location.href.lastIndexOf("/");if(l!==-1){const h=e.file(_.slice(l+1));if(h)return URL.createObjectURL(new Blob([h.asArrayBuffer()]))}return _}class i extends On{constructor(l){const h=l||{};h.iconUrlFunction=n,super(h)}getType(){return"arraybuffer"}readFeature(l,h){const y=t(l);return super.readFeature(y,h)}readFeatures(l,h){const y=t(l);return super.readFeatures(y,h)}}const o=new Zr({formatConstructors:[i,Fi,Pr,Gi,On,Mo]}),d=new Sr({interactions:vr().extend([o]),layers:[new zr({source:new Mr})],target:"map",view:new br({center:[0,0],zoom:2})});o.on("addfeatures",function(_){window.event=_;const l=new Fr({features:_.features});d.addLayer(new Or({source:l})),d.getView().fit(l.getExtent())});const u=function(_){const l=[];if(d.forEachFeatureAtPixel(_,function(h){l.push(h)}),l.length>0){const h=[];let y,v;for(y=0,v=l.length;y<v;++y){const T=l[y].get("description")||l[y].get("name")||l[y].get("_name")||l[y].get("layer");T&&h.push(T)}document.getElementById("info").innerHTML=h.join("<br/>")||"&nbsp"}else document.getElementById("info").innerHTML="&nbsp;"};d.on("pointermove",function(_){if(_.dragging)return;const l=d.getEventPixel(_.originalEvent);u(l)}),d.on("click",function(_){u(_.pixel)});const f=document.getElementById("download");function m(_,l){fetch(_).then(function(h){return h.blob()}).then(function(h){f.href=URL.createObjectURL(h),f.download=l,f.click()})}document.getElementById("download-kmz").addEventListener("click",function(){m("https://openlayers.org/en/latest/examples/data/kmz/iceland.kmz","iceland.kmz")}),Prism.highlightAll()}),(e,t)=>(Tr(),kr(Ir,null,[He("h4",Uo,kt(It(Yr)),1),Bo,He("pre",null,[He("code",Go,kt("  "+It(Kr).trim()),1)]),Zo,He("pre",null,[He("code",Yo,kt("  "+It(Xr).trim()),1)]),Ko,He("pre",null,[He("code",Xo,kt("  "+It(Hr).trim()),1)]),Ho,He("pre",null,[He("code",Vo,kt("  "+It(Vr).trim()),1)])],64))}},fa=Ar(jo,[["__scopeId","data-v-21644589"]]);export{fa as default};
