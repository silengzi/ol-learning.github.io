import{b as u}from"./Style-f78957a3.js";import{bR as G,aF as b,aP as T,a2 as E,j as S,bS as Y,aG as q,bI as R,b3 as L,bE as k,b4 as I,b6 as O,b7 as F,bD as D,bK as J,bJ as Z,b2 as P,b5 as M,aZ as m,a1 as A}from"./Layer-227d2e40.js";class X{drawCustom(t,e,i,a){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const v=X;class V extends v{constructor(t,e,i,a,o,n,s){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=a,this.transformRotation_=a?G(Math.atan2(a[1],a[0]),10):0,this.viewRotation_=o,this.squaredTolerance_=n,this.userTransform_=s,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=b()}drawImages_(t,e,i,a){if(!this.image_)return;const o=T(t,e,i,a,this.transform_,this.pixelCoordinates_),n=this.context_,s=this.tmpLocalTransform_,l=n.globalAlpha;this.imageOpacity_!=1&&(n.globalAlpha=l*this.imageOpacity_);let r=this.imageRotation_;this.transformRotation_===0&&(r-=this.viewRotation_),this.imageRotateWithView_&&(r+=this.viewRotation_);for(let f=0,g=o.length;f<g;f+=2){const d=o[f]-this.imageAnchorX_,c=o[f+1]-this.imageAnchorY_;if(r!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const x=d+this.imageAnchorX_,_=c+this.imageAnchorY_;E(s,x,_,1,1,r,-x,-_),n.save(),n.transform.apply(n,s),n.translate(x,_),n.scale(this.imageScale_[0],this.imageScale_[1]),n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),n.restore()}else n.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,c,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(n.globalAlpha=l)}drawText_(t,e,i,a){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const o=T(t,e,i,a,this.transform_,this.pixelCoordinates_),n=this.context_;let s=this.textRotation_;for(this.transformRotation_===0&&(s-=this.viewRotation_),this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=a){const l=o[e]+this.textOffsetX_,r=o[e+1]+this.textOffsetY_;s!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(n.save(),n.translate(l-this.textOffsetX_,r-this.textOffsetY_),n.rotate(s),n.translate(this.textOffsetX_,this.textOffsetY_),n.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&n.strokeText(this.text_,0,0),this.textFillState_&&n.fillText(this.text_,0,0),n.restore()):(this.textStrokeState_&&n.strokeText(this.text_,l,r),this.textFillState_&&n.fillText(this.text_,l,r))}}moveToLineTo_(t,e,i,a,o){const n=this.context_,s=T(t,e,i,a,this.transform_,this.pixelCoordinates_);n.moveTo(s[0],s[1]);let l=s.length;o&&(l-=2);for(let r=2;r<l;r+=2)n.lineTo(s[r],s[r+1]);return o&&n.closePath(),i}drawRings_(t,e,i,a){for(let o=0,n=i.length;o<n;++o)e=this.moveToLineTo_(t,e,i[o],a,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!S(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=Y(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],a=e[3]-e[1],o=Math.sqrt(i*i+a*a),n=this.context_;n.beginPath(),n.arc(e[0],e[1],o,0,2*Math.PI),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,a=e.length;i<a;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!S(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(S(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,a=t.getFlatCoordinates();let o=0;const n=t.getEnds(),s=t.getStride();i.beginPath();for(let l=0,r=n.length;l<r;++l)o=this.moveToLineTo_(a,o,n[l],s,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!S(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!S(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let a=0;const o=t.getEndss(),n=t.getStride();e.beginPath();for(let s=0,l=o.length;s<l;++s){const r=o[s];a=this.drawRings_(i,a,r,n)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),q(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,a=t.textAlign?t.textAlign:R;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=a&&(i.textAlign=a,e.textAlign=a),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=a,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:a,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:u(i||P)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),a=e.getLineCap(),o=e.getLineDash(),n=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),r=e.getMiterLimit(),f=o||D;this.strokeState_={lineCap:a!==void 0?a:L,lineDash:this.pixelRatio_===1?f:f.map(g=>g*this.pixelRatio_),lineDashOffset:(n||k)*this.pixelRatio_,lineJoin:s!==void 0?s:I,lineWidth:(l!==void 0?l:O)*this.pixelRatio_,miterLimit:r!==void 0?r:F,strokeStyle:u(i||M)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),a=t.getAnchor(),o=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=a[0]*i,this.imageAnchorY_=a[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const n=t.getScaleArray();this.imageScale_=[n[0]*this.pixelRatio_/i,n[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const c=e.getColor();this.textFillState_={fillStyle:u(c||P)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const c=i.getColor(),x=i.getLineCap(),_=i.getLineDash(),p=i.getLineDashOffset(),C=i.getLineJoin(),y=i.getWidth(),w=i.getMiterLimit();this.textStrokeState_={lineCap:x!==void 0?x:L,lineDash:_||D,lineDashOffset:p||k,lineJoin:C!==void 0?C:I,lineWidth:y!==void 0?y:O,miterLimit:w!==void 0?w:F,strokeStyle:u(c||M)}}const a=t.getFont(),o=t.getOffsetX(),n=t.getOffsetY(),s=t.getRotateWithView(),l=t.getRotation(),r=t.getScaleArray(),f=t.getText(),g=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:a!==void 0?a:J,textAlign:g!==void 0?g:R,textBaseline:d!==void 0?d:Z},this.text_=f!==void 0?Array.isArray(f)?f.reduce((c,x,_)=>c+=_%2?" ":x,""):f:"",this.textOffsetX_=o!==void 0?this.pixelRatio_*o:0,this.textOffsetY_=n!==void 0?this.pixelRatio_*n:0,this.textRotateWithView_=s!==void 0?s:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*r[0],this.pixelRatio_*r[1]]}}}const ot=V,H=.5,W={Point:tt,LineString:K,Polygon:it,MultiPoint:et,MultiLineString:U,MultiPolygon:Q,GeometryCollection:j,Circle:N};function at(h,t){return parseInt(A(h),10)-parseInt(A(t),10)}function lt(h,t){const e=z(h,t);return e*e}function z(h,t){return H*h/t}function N(h,t,e,i,a){const o=e.getFill(),n=e.getStroke();if(o||n){const l=h.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(o,n),l.drawCircle(t,i)}const s=e.getText();if(s&&s.getText()){const l=(a||h).getBuilder(e.getZIndex(),"Text");l.setTextStyle(s),l.drawText(t,i)}}function rt(h,t,e,i,a,o,n){let s=!1;const l=e.getImage();if(l){const r=l.getImageState();r==m.LOADED||r==m.ERROR?l.unlistenImageChange(a):(r==m.IDLE&&l.load(),l.listenImageChange(a),s=!0)}return $(h,t,e,i,o,n),s}function $(h,t,e,i,a,o){const n=e.getGeometryFunction()(t);if(!n)return;const s=n.simplifyTransformed(i,a);if(e.getRenderer())B(h,s,e,t);else{const r=W[s.getType()];r(h,s,e,t,o)}}function B(h,t,e,i){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let n=0,s=o.length;n<s;++n)B(h,o[n],e,i);return}h.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer())}function j(h,t,e,i,a){const o=t.getGeometriesArray();let n,s;for(n=0,s=o.length;n<s;++n){const l=W[o[n].getType()];l(h,o[n],e,i,a)}}function K(h,t,e,i,a){const o=e.getStroke();if(o){const s=h.getBuilder(e.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawLineString(t,i)}const n=e.getText();if(n&&n.getText()){const s=(a||h).getBuilder(e.getZIndex(),"Text");s.setTextStyle(n),s.drawText(t,i)}}function U(h,t,e,i,a){const o=e.getStroke();if(o){const s=h.getBuilder(e.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawMultiLineString(t,i)}const n=e.getText();if(n&&n.getText()){const s=(a||h).getBuilder(e.getZIndex(),"Text");s.setTextStyle(n),s.drawText(t,i)}}function Q(h,t,e,i,a){const o=e.getFill(),n=e.getStroke();if(n||o){const l=h.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(o,n),l.drawMultiPolygon(t,i)}const s=e.getText();if(s&&s.getText()){const l=(a||h).getBuilder(e.getZIndex(),"Text");l.setTextStyle(s),l.drawText(t,i)}}function tt(h,t,e,i,a){const o=e.getImage(),n=e.getText();let s;if(o){if(o.getImageState()!=m.LOADED)return;let l=h;if(a){const f=o.getDeclutterMode();if(f!=="none")if(l=a,f==="obstacle"){const g=h.getBuilder(e.getZIndex(),"Image");g.setImageStyle(o,s),g.drawPoint(t,i)}else n&&n.getText()&&(s={})}const r=l.getBuilder(e.getZIndex(),"Image");r.setImageStyle(o,s),r.drawPoint(t,i)}if(n&&n.getText()){let l=h;a&&(l=a);const r=l.getBuilder(e.getZIndex(),"Text");r.setTextStyle(n,s),r.drawText(t,i)}}function et(h,t,e,i,a){const o=e.getImage(),n=e.getText();let s;if(o){if(o.getImageState()!=m.LOADED)return;let l=h;if(a){const f=o.getDeclutterMode();if(f!=="none")if(l=a,f==="obstacle"){const g=h.getBuilder(e.getZIndex(),"Image");g.setImageStyle(o,s),g.drawMultiPoint(t,i)}else n&&n.getText()&&(s={})}const r=l.getBuilder(e.getZIndex(),"Image");r.setImageStyle(o,s),r.drawMultiPoint(t,i)}if(n&&n.getText()){let l=h;a&&(l=a);const r=l.getBuilder(e.getZIndex(),"Text");r.setTextStyle(n,s),r.drawText(t,i)}}function it(h,t,e,i,a){const o=e.getFill(),n=e.getStroke();if(o||n){const l=h.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(o,n),l.drawPolygon(t,i)}const s=e.getText();if(s&&s.getText()){const l=(a||h).getBuilder(e.getZIndex(),"Text");l.setTextStyle(s),l.drawText(t,i)}}export{ot as C,v as V,z as a,at as d,lt as g,rt as r};
